<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="20060" />

<meta name="date" content="2020-12-20" />

<title>Homework Vignette</title>

<script>// Hide empty <a> tag within highlighted CodeBlock for screen reader accessibility (see https://github.com/jgm/pandoc/issues/6352#issuecomment-626106786) -->
// v0.0.1
// Written by JooYoung Seo (jooyoung@psu.edu) and Atsushi Yasumoto on June 1st, 2020.

document.addEventListener('DOMContentLoaded', function() {
  const codeList = document.getElementsByClassName("sourceCode");
  for (var i = 0; i < codeList.length; i++) {
    var linkList = codeList[i].getElementsByTagName('a');
    for (var j = 0; j < linkList.length; j++) {
      if (linkList[j].innerHTML === "") {
        linkList[j].setAttribute('aria-hidden', 'true');
      }
    }
  }
});
</script>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Homework Vignette</h1>
<h4 class="author">20060</h4>
<h4 class="date">2020-12-20</h4>



<div id="hw1" class="section level2">
<h2>HW1</h2>
<div id="question1" class="section level3">
<h3>Question1：</h3>
<p>1.Go through “R for Beginners” if you are not familiar with R programming</p>
<p>2.Use knitr to produce 3 examples in the book. The 1st example should contain texts and at least one figure. The 2nd example should contains texts and at least one table. The 3rd example should contain at least a couple of LaTeX formulas.</p>
</div>
<div id="answer1" class="section level3">
<h3>Answer1:</h3>
<div id="figure" class="section level4">
<h4>Figure</h4>
<ul>
<li><strong>Exercise</strong></li>
</ul>
<p>Making use of the plotting functions of R, there are three figures shown below.The data set is from package datasets ,providing measurements of the diameter, height and volume of timber in 31 trees.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="kw">library</span>(<span class="st">&quot;datasets&quot;</span>)</span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="kw">data</span>(<span class="st">&quot;trees&quot;</span>)</span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="kw">hist</span>(trees<span class="op">$</span>Height, <span class="dt">main =</span> <span class="st">&quot;Histogram of Height&quot;</span>,<span class="dt">xlab =</span> <span class="st">&quot;Height&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a><span class="kw">plot</span>(<span class="kw">density</span>(trees<span class="op">$</span>Height),<span class="dt">main =</span><span class="st">&quot;Density of Height&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a><span class="kw">plot</span>(Volume<span class="op">~</span>Girth,<span class="dt">data=</span>trees,<span class="dt">pch=</span><span class="dv">20</span>,<span class="dt">col=</span><span class="st">&#39;blue&#39;</span>)</span>
<span id="cb3-2"><a href="#cb3-2"></a>model=<span class="kw">lm</span>(Volume<span class="op">~</span>Girth,<span class="dt">data=</span>trees)</span>
<span id="cb3-3"><a href="#cb3-3"></a><span class="kw">abline</span>(model,<span class="dt">lty=</span><span class="dv">3</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<ul>
<li><strong>Example in the book</strong></li>
</ul>
<p>In this example, measurements of leaves taken at N. Queensland, Australia for two types of leaf architecture are represented by Andrews curves. The data set is leafshape17 in the DAAG package.Three measurements (leaf length, petiole, and leaf width) correspond to points in <span class="math inline">\(R^3\)</span>.It is easiest to interpret the plots if leaf architectures are identified by different colors, but here we use different line types.To plot the curves, define a function to compute <span class="math inline">\(f_i(t)\)</span> for arbitrary points <span class="math inline">\(x_i\)</span> in <span class="math inline">\(R^3\)</span> and <span class="math inline">\(-\pi\le{t}\le\pi\)</span>.Evaluate the function along the interval <span class="math inline">\([-\pi,\pi]\)</span> for each sample point <span class="math inline">\(x_i\)</span>.</p>
<p>The plot of Andrews curves for this example is shown in Figure 1. The plot reveals similarities within plagiotropic and orthotropic leaf architecture groups, and differences between these groups. In general, this type of plot may reveal possible clustering of data.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a><span class="kw">library</span>(DAAG)</span>
<span id="cb4-2"><a href="#cb4-2"></a><span class="co">#&gt; 载入需要的程辑包：lattice</span></span>
<span id="cb4-3"><a href="#cb4-3"></a><span class="kw">attach</span>(leafshape17)</span>
<span id="cb4-4"><a href="#cb4-4"></a>f &lt;-<span class="st"> </span><span class="cf">function</span>(a, v) {</span>
<span id="cb4-5"><a href="#cb4-5"></a>  <span class="co">#Andrews curve f(a) for a data vector v in R^3</span></span>
<span id="cb4-6"><a href="#cb4-6"></a>  v[<span class="dv">1</span>]<span class="op">/</span><span class="kw">sqrt</span>(<span class="dv">2</span>) <span class="op">+</span><span class="st"> </span>v[<span class="dv">2</span>]<span class="op">*</span><span class="kw">sin</span>(a) <span class="op">+</span><span class="st"> </span>v[<span class="dv">3</span>]<span class="op">*</span><span class="kw">cos</span>(a)</span>
<span id="cb4-7"><a href="#cb4-7"></a>}</span>
<span id="cb4-8"><a href="#cb4-8"></a><span class="co">#scale data to range [-1, 1]</span></span>
<span id="cb4-9"><a href="#cb4-9"></a>x &lt;-<span class="st"> </span><span class="kw">cbind</span>(bladelen, petiole, bladewid)</span>
<span id="cb4-10"><a href="#cb4-10"></a>n &lt;-<span class="st"> </span><span class="kw">nrow</span>(x)</span>
<span id="cb4-11"><a href="#cb4-11"></a>mins &lt;-<span class="st"> </span><span class="kw">apply</span>(x, <span class="dv">2</span>, min) <span class="co">#column minimums</span></span>
<span id="cb4-12"><a href="#cb4-12"></a>maxs &lt;-<span class="st"> </span><span class="kw">apply</span>(x, <span class="dv">2</span>, max) <span class="co">#column maximums</span></span>
<span id="cb4-13"><a href="#cb4-13"></a>r &lt;-<span class="st"> </span>maxs <span class="op">-</span><span class="st"> </span>mins <span class="co">#column ranges</span></span>
<span id="cb4-14"><a href="#cb4-14"></a>y &lt;-<span class="st"> </span><span class="kw">sweep</span>(x, <span class="dv">2</span>, mins) <span class="co">#subtract column mins</span></span>
<span id="cb4-15"><a href="#cb4-15"></a>y &lt;-<span class="st"> </span><span class="kw">sweep</span>(y, <span class="dv">2</span>, r, <span class="st">&quot;/&quot;</span>) <span class="co">#divide by range</span></span>
<span id="cb4-16"><a href="#cb4-16"></a>x &lt;-<span class="st"> </span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span>y <span class="op">-</span><span class="st"> </span><span class="dv">1</span> <span class="co">#now has range [-1, 1]</span></span>
<span id="cb4-17"><a href="#cb4-17"></a><span class="co">#set up plot window, but plot nothing yet</span></span>
<span id="cb4-18"><a href="#cb4-18"></a><span class="kw">plot</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="op">-</span>pi, pi), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">3</span>,<span class="dv">3</span>),</span>
<span id="cb4-19"><a href="#cb4-19"></a>     <span class="dt">xlab =</span> <span class="st">&quot;t&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;Andrews Curves&quot;</span>,</span>
<span id="cb4-20"><a href="#cb4-20"></a>     <span class="dt">main =</span> <span class="st">&quot;&quot;</span>, <span class="dt">type =</span> <span class="st">&quot;n&quot;</span>)</span>
<span id="cb4-21"><a href="#cb4-21"></a><span class="co">#now add the Andrews curves for each observation</span></span>
<span id="cb4-22"><a href="#cb4-22"></a><span class="co">#line type corresponds to leaf architecture</span></span>
<span id="cb4-23"><a href="#cb4-23"></a><span class="co">#0=orthotropic, 1=plagiotropic</span></span>
<span id="cb4-24"><a href="#cb4-24"></a>a &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="op">-</span>pi, pi, <span class="dt">len=</span><span class="dv">101</span>)</span>
<span id="cb4-25"><a href="#cb4-25"></a><span class="kw">dim</span>(a) &lt;-<span class="st"> </span><span class="kw">length</span>(a)</span>
<span id="cb4-26"><a href="#cb4-26"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n) {</span>
<span id="cb4-27"><a href="#cb4-27"></a>  g &lt;-<span class="st"> </span>arch[i] <span class="op">+</span><span class="st"> </span><span class="dv">1</span></span>
<span id="cb4-28"><a href="#cb4-28"></a>  y &lt;-<span class="st"> </span><span class="kw">apply</span>(a, <span class="dt">MARGIN =</span> <span class="dv">1</span>, <span class="dt">FUN =</span> f, <span class="dt">v =</span> x[i,])</span>
<span id="cb4-29"><a href="#cb4-29"></a>  <span class="kw">lines</span>(a, y, <span class="dt">lty =</span> g)</span>
<span id="cb4-30"><a href="#cb4-30"></a>}</span>
<span id="cb4-31"><a href="#cb4-31"></a><span class="kw">legend</span>(<span class="dv">3</span>, <span class="kw">c</span>(<span class="st">&quot;Orthotropic&quot;</span>, <span class="st">&quot;Plagiotropic&quot;</span>), <span class="dt">lty =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p><strong>FIGURE 1:</strong> Andrews curves for leafshape17 (DAAG) data at latitude 17.1: leaf length, width, and petiole measurements . Curves are identified by leaf architecture.</p>
</div>
<div id="table" class="section level4">
<h4>Table</h4>
<ul>
<li><strong>Exercise</strong></li>
</ul>
<p>The data set is from package datasets,providing standardized fertility measure and five socio-economic indicators for each of 47 French-speaking provinces of Switzerland at about 1888.Based on the data set, multiple linear regression is established between standardized fertility measure and other components. And the results are presented in the table below.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a><span class="kw">data</span>(swiss)</span>
<span id="cb5-2"><a href="#cb5-2"></a>model=<span class="kw">lm</span>(Fertility <span class="op">~</span>.,<span class="dt">data=</span>swiss)</span>
<span id="cb5-3"><a href="#cb5-3"></a><span class="kw">library</span>(knitr)</span>
<span id="cb5-4"><a href="#cb5-4"></a><span class="kw">kable</span>(<span class="kw">summary</span>(model)<span class="op">$</span>coef,<span class="dt">digits=</span><span class="dv">3</span>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">Estimate</th>
<th align="right">Std. Error</th>
<th align="right">t value</th>
<th align="right">Pr(&gt;|t|)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">(Intercept)</td>
<td align="right">66.915</td>
<td align="right">10.706</td>
<td align="right">6.250</td>
<td align="right">0.000</td>
</tr>
<tr class="even">
<td align="left">Agriculture</td>
<td align="right">-0.172</td>
<td align="right">0.070</td>
<td align="right">-2.448</td>
<td align="right">0.019</td>
</tr>
<tr class="odd">
<td align="left">Examination</td>
<td align="right">-0.258</td>
<td align="right">0.254</td>
<td align="right">-1.016</td>
<td align="right">0.315</td>
</tr>
<tr class="even">
<td align="left">Education</td>
<td align="right">-0.871</td>
<td align="right">0.183</td>
<td align="right">-4.758</td>
<td align="right">0.000</td>
</tr>
<tr class="odd">
<td align="left">Catholic</td>
<td align="right">0.104</td>
<td align="right">0.035</td>
<td align="right">2.953</td>
<td align="right">0.005</td>
</tr>
<tr class="even">
<td align="left">Infant.Mortality</td>
<td align="right">1.077</td>
<td align="right">0.382</td>
<td align="right">2.822</td>
<td align="right">0.007</td>
</tr>
</tbody>
</table>
<ul>
<li><strong>Example in the book</strong></li>
</ul>
<p>In this example, the data set is given in Case Study of Larsen and Marx. The factor (type of antibiotic) has five levels. The response variable measures the binding of the drug to serum proteins. The layout of the data frame must be stacked for the ANOVA.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a>P &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">29.6</span>, <span class="fl">24.3</span>, <span class="fl">28.5</span>, <span class="dv">32</span>)</span>
<span id="cb6-2"><a href="#cb6-2"></a>T &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">27.3</span>, <span class="fl">32.6</span>, <span class="fl">30.8</span>, <span class="fl">34.8</span>)</span>
<span id="cb6-3"><a href="#cb6-3"></a>S &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">5.8</span>, <span class="fl">6.2</span>, <span class="dv">11</span>, <span class="fl">8.3</span>)</span>
<span id="cb6-4"><a href="#cb6-4"></a>E &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">21.6</span>, <span class="fl">17.4</span>, <span class="fl">18.3</span>, <span class="dv">19</span>)</span>
<span id="cb6-5"><a href="#cb6-5"></a>C &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">29.2</span>, <span class="fl">32.8</span>, <span class="dv">25</span>, <span class="fl">24.2</span>)</span>
<span id="cb6-6"><a href="#cb6-6"></a><span class="co">#glue the columns together in a data frame</span></span>
<span id="cb6-7"><a href="#cb6-7"></a>x &lt;-<span class="st"> </span><span class="kw">data.frame</span>(P, T, S, E, C)</span>
<span id="cb6-8"><a href="#cb6-8"></a><span class="co">#now stack the data for ANOVA</span></span>
<span id="cb6-9"><a href="#cb6-9"></a>y &lt;-<span class="st"> </span><span class="kw">stack</span>(x)</span>
<span id="cb6-10"><a href="#cb6-10"></a><span class="kw">names</span>(y) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Binding&quot;</span>, <span class="st">&quot;Antibiotic&quot;</span>)</span></code></pre></div>
<p>This data is in the one-way layout for ANOVA. Now y is a data frame, so there is a default formula associated with it.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a><span class="co">#check the default formula</span></span>
<span id="cb7-2"><a href="#cb7-2"></a><span class="kw">print</span>(<span class="kw">formula</span>(y)) <span class="co">#default formula is right one</span></span>
<span id="cb7-3"><a href="#cb7-3"></a><span class="co">#&gt; Binding ~ Antibiotic</span></span></code></pre></div>
<p>As the default formula is the same model that we want to fit, lm can be applied without specifying the formula.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a><span class="kw">lm</span>(y)</span>
<span id="cb8-2"><a href="#cb8-2"></a><span class="co">#&gt; </span></span>
<span id="cb8-3"><a href="#cb8-3"></a><span class="co">#&gt; Call:</span></span>
<span id="cb8-4"><a href="#cb8-4"></a><span class="co">#&gt; lm(formula = y)</span></span>
<span id="cb8-5"><a href="#cb8-5"></a><span class="co">#&gt; </span></span>
<span id="cb8-6"><a href="#cb8-6"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb8-7"><a href="#cb8-7"></a><span class="co">#&gt; (Intercept)  AntibioticT  AntibioticS  AntibioticE  AntibioticC  </span></span>
<span id="cb8-8"><a href="#cb8-8"></a><span class="co">#&gt;      28.600        2.775      -20.775       -9.525       -0.800</span></span>
<span id="cb8-9"><a href="#cb8-9"></a><span class="kw">anova</span>(<span class="kw">lm</span>(y))</span>
<span id="cb8-10"><a href="#cb8-10"></a><span class="co">#&gt; Analysis of Variance Table</span></span>
<span id="cb8-11"><a href="#cb8-11"></a><span class="co">#&gt; </span></span>
<span id="cb8-12"><a href="#cb8-12"></a><span class="co">#&gt; Response: Binding</span></span>
<span id="cb8-13"><a href="#cb8-13"></a><span class="co">#&gt;            Df  Sum Sq Mean Sq F value   Pr(&gt;F)    </span></span>
<span id="cb8-14"><a href="#cb8-14"></a><span class="co">#&gt; Antibiotic  4 1480.82  370.21  40.885 6.74e-08 ***</span></span>
<span id="cb8-15"><a href="#cb8-15"></a><span class="co">#&gt; Residuals  15  135.82    9.05                     </span></span>
<span id="cb8-16"><a href="#cb8-16"></a><span class="co">#&gt; ---</span></span>
<span id="cb8-17"><a href="#cb8-17"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb8-18"><a href="#cb8-18"></a><span class="kw">kable</span>(<span class="kw">anova</span>(<span class="kw">lm</span>(y)),<span class="dt">digits=</span><span class="dv">3</span>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">Df</th>
<th align="right">Sum Sq</th>
<th align="right">Mean Sq</th>
<th align="right">F value</th>
<th align="right">Pr(&gt;F)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Antibiotic</td>
<td align="right">4</td>
<td align="right">1480.823</td>
<td align="right">370.206</td>
<td align="right">40.885</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">Residuals</td>
<td align="right">15</td>
<td align="right">135.822</td>
<td align="right">9.055</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
</tbody>
</table>
</div>
<div id="formula" class="section level4">
<h4>Formula</h4>
<ul>
<li><strong>Exercise</strong></li>
</ul>
<p>In statistics,the central limit theorem(CLT)establishes that,in some situations, when independent random variables are added,their properly normalized sum tends toward a normal distribution even if the original variables themselves are not normally distributed.</p>
<p><strong>Lindeberg–Lévy CLT</strong></p>
<p>Suppose <span class="math inline">\(\{X_1,\dots,X_n\}\)</span> is a sequence of iid random variables with <span class="math inline">\(E[X_i]=\mu\)</span> and <span class="math inline">\(Var[X_i]={\alpha}^2&lt;\infty\)</span>.Then as <span class="math inline">\(n\)</span> approaches infinity, the random variables <span class="math inline">\(\sqrt{n}(\bar{X}_n-\mu)\)</span> converge in distribution to a normal <span class="math inline">\(N(0,\alpha^2)\)</span>: <span class="math display">\[\sqrt{n}(\bar{X}_n-\mu)\stackrel{d}{\longrightarrow}N(0,\sigma^2)\]</span></p>
<p>In the case <span class="math inline">\(\sigma&gt;0\)</span>,convergence in distribution means that the cumulative distribution functions of <span class="math inline">\(\sqrt{n}(\bar{X}_n-\mu)\)</span> converge pointwise to the cdf of the <span class="math inline">\(N(0,\sigma^2)\)</span> distribution: for every real number <span class="math inline">\(z\)</span>,</p>
<p><span class="math display">\[\begin{aligned}
\mathop{lim}\limits_{n\to\infty}P[\sqrt{n}(\bar{X}_n-\mu)\le{z}]
&amp;=\mathop{lim}\limits_{n\to\infty}P[\frac{\sqrt{n}(\bar{X}_n-\mu)}{\sigma}\le{\frac{z}{\sigma}}]\\
&amp;=\Phi(\frac{z}{\sigma})
\end{aligned}
\]</span></p>
<p>where <span class="math inline">\(\Phi(x)\)</span> is the standard normal cdf evaluated at <span class="math inline">\(x\)</span>.The convergence is uniform in <span class="math inline">\(z\)</span> in the sense that <span class="math display">\[\mathop{lim}\limits_{n\to\infty}\mathop{sup}\limits_{z\in{R}}|P[\sqrt{n}(\bar{X}_n-\mu)-\Phi(\frac{z}{\sigma})]|=0\]</span></p>
<ul>
<li><strong>Example in the book</strong></li>
</ul>
<p><strong>Basic Monte Carlo estimation</strong></p>
<p>Suppose that <span class="math inline">\(X_1,X_2\)</span> are iid from a standard normal distribution. Estimate the mean difference <span class="math inline">\(E|X_1-X_2|\)</span>.</p>
<p>To obtain a Monte Carlo estimate of <span class="math inline">\(\theta=E[g(X_1,X_2)]=E|X_1-X_2|\)</span> based on <span class="math inline">\(m\)</span> replicates, generate random samples <span class="math inline">\(x^{(j)}=(x_1^{(j)},x_2^{(j)})\)</span> of size 2 from the standard normal distribution, <span class="math inline">\(j=1,\cdots,m\)</span>. Then compute the replicates <span class="math inline">\(\hat\theta^{(j)}=g_j(x_1,x_2)=|x_1^{(j)}-x_2^{(j)}|,j=1,\cdots,m\)</span>, and the mean of the replicates <span class="math display">\[\hat\theta=\frac{1}{m}\sum_{i=1}^{m}\hat\theta^{(j)}=\overline{g(X_1,X_2)}=\frac{1}{m}\sum_{i=1}^{m}|x_1^{(j)}-x_2^{(j)}|\]</span></p>
</div>
</div>
</div>
<div id="hw2" class="section level2">
<h2>HW2</h2>
<div id="question2" class="section level3">
<h3>Question2：</h3>
<ul>
<li><p><strong>Exercise3.3</strong></p>
<p>The Pareto<span class="math inline">\((a,b)\)</span> distribution has cdf <span class="math display">\[F(x)=1-\bigg(\frac{b}{x}\bigg)^a,\qquad x\ge b&gt;0,a&gt;0.\]</span></p>
<p>Derive the probability inverse transformation <span class="math inline">\(F^{-1}(U)\)</span> and use the inverse transform method to simulate a random sample from the Pareto<span class="math inline">\((2,2)\)</span> distribution. Graph the density histogram of the sample with the Pareto<span class="math inline">\((2,2)\)</span> density superimposed for comparison.</p></li>
<li><p><strong>Exercise3.9</strong></p>
<p>The rescaled Epanechnikov kernel [85] is a symmetric density function <span class="math display">\[f_e(x)=\frac{3}{4}(1-x^2),\qquad |x|\le1.\qquad (3.10)\]</span> Devroye and Gyorfi give the following algorithm for simulation from this distribution. Generate iid <span class="math inline">\(U_1,U_2,U_3\sim Uniform(-1,1)\)</span>. If <span class="math inline">\(|U_3|\ge|U_2|\)</span> and <span class="math inline">\(|U_3|\ge|U_1|\)</span>, deliver <span class="math inline">\(U_2\)</span>; otherwise deliver <span class="math inline">\(U_3\)</span>. Write a function to generate random variates from <span class="math inline">\(f_e\)</span>, and construct the histogram density estimate of a large simulated random sample.</p></li>
<li><p><strong>Exercise3.10</strong></p>
<p>Prove that the algorithm given in Exercise 3.9 generates variates from the density <span class="math inline">\(f_e\)</span>(3.10).</p></li>
<li><p><strong>Exercise3.13</strong></p>
<p>It can be shown that the mixture in Exercise 3.12 has a Pareto distribution with cdf <span class="math display">\[F(y)=1-\bigg(\frac{\beta}{\beta+y}\bigg)^r,\quad y\ge 0\]</span> (This is an alternative parameterization of the Pareto cdf given in Exercise 3.3.) Generate 1000 random observations from the mixture with <span class="math inline">\(r=4\)</span> and <span class="math inline">\(\beta=2\)</span>.Compare the empirical and theoretical (Pareto) distributions by graphing the density histogram of the sample and superimposing the Pareto density curve.</p></li>
</ul>
</div>
<div id="answer2" class="section level3">
<h3>Answer2：</h3>
<ul>
<li><p><strong>3.3</strong></p>
<p><strong>Algorithm for generating random numbers from Pareto<span class="math inline">\((a,b)\)</span>:</strong></p>
<p>(1)Let <span class="math inline">\(U\sim U(0,1)\)</span>, then the inverse transformation is <span class="math display">\[F^{-1}(u)=\frac{b}{ \sqrt[a]{1-u}}\]</span> Note that <span class="math inline">\(U\)</span> and <span class="math inline">\(1-U\)</span> have the same distribution.</p>
<p>(2)Return <span class="math inline">\(\frac{b}{ \sqrt[a]u}\)</span>.</p>
<p><strong>Rcode and results:</strong></p></li>
</ul>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a><span class="co">#the function to generate a random sample from Pareto(a,b)</span></span>
<span id="cb9-2"><a href="#cb9-2"></a>rPareto&lt;-<span class="cf">function</span>(n,a,b){</span>
<span id="cb9-3"><a href="#cb9-3"></a>  u&lt;-<span class="kw">runif</span>(n)</span>
<span id="cb9-4"><a href="#cb9-4"></a>  x&lt;-b<span class="op">/</span>u<span class="op">^</span>(<span class="dv">1</span><span class="op">/</span>a)</span>
<span id="cb9-5"><a href="#cb9-5"></a>  <span class="kw">return</span>(x)</span>
<span id="cb9-6"><a href="#cb9-6"></a>}</span>
<span id="cb9-7"><a href="#cb9-7"></a><span class="co">#</span></span>
<span id="cb9-8"><a href="#cb9-8"></a><span class="kw">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb9-9"><a href="#cb9-9"></a>n&lt;-<span class="dv">100</span></span>
<span id="cb9-10"><a href="#cb9-10"></a>a&lt;-<span class="dv">2</span></span>
<span id="cb9-11"><a href="#cb9-11"></a>b&lt;-<span class="dv">2</span></span>
<span id="cb9-12"><a href="#cb9-12"></a>x&lt;-<span class="kw">rPareto</span>(<span class="dv">100</span>,<span class="dv">2</span>,<span class="dv">2</span>)</span>
<span id="cb9-13"><a href="#cb9-13"></a><span class="co">#the density histogram of the sample from Pareto(2,2) with the theoretical density superimposed</span></span>
<span id="cb9-14"><a href="#cb9-14"></a><span class="kw">hist</span>(x,<span class="dt">prob=</span><span class="ot">TRUE</span>,<span class="dt">xlab=</span><span class="st">&quot;x&quot;</span>,<span class="dt">breaks =</span> <span class="dv">100</span>,<span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">100</span>),<span class="dt">main=</span><span class="st">&quot;Pareto(2,2)&quot;</span>)</span>
<span id="cb9-15"><a href="#cb9-15"></a>y &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">2</span>,<span class="dv">100</span>,<span class="fl">0.01</span>)</span>
<span id="cb9-16"><a href="#cb9-16"></a><span class="kw">lines</span>(y,b<span class="op">^</span>a<span class="op">*</span>a<span class="op">*</span>y<span class="op">^</span>(<span class="op">-</span>(a<span class="op">+</span><span class="dv">1</span>)))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>  FIGURE 1 Probability density histogram of a random sample with the theoretical density <span class="math inline">\(f(x)=b^aax^{-(a+1)}=8x^{-3}\)</span> superimposed.</p>
<p>  The histogram and density plot in Figure 1 suggests that the empirical and theoretical (Pareto) distribution approximately agree when <span class="math inline">\(a=2\)</span>, <span class="math inline">\(b=2\)</span>.</p>
<ul>
<li><p><strong>3.9</strong></p>
<p><strong>Algorithm for generating random numbers from the rescaled Epanechnikov kernel:</strong></p>
<p>(1)Let <span class="math inline">\(U_1,U_2,U_3\sim U(-1,1)\)</span></p>
<p>(2)If <span class="math inline">\(|U_3|\ge|U_2|\)</span> and <span class="math inline">\(|U_3|\ge|U_1|\)</span>, return <span class="math inline">\(U_2\)</span>; otherwise return <span class="math inline">\(U_3\)</span>.</p>
<p><strong>Rcode and results:</strong></p></li>
</ul>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a><span class="co">#the function to generate random variates from f_e</span></span>
<span id="cb10-2"><a href="#cb10-2"></a>rEk&lt;-<span class="cf">function</span>(n){</span>
<span id="cb10-3"><a href="#cb10-3"></a>  u1&lt;-<span class="kw">runif</span>(n,<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>)</span>
<span id="cb10-4"><a href="#cb10-4"></a>  u2&lt;-<span class="kw">runif</span>(n,<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>)</span>
<span id="cb10-5"><a href="#cb10-5"></a>  u3&lt;-<span class="kw">runif</span>(n,<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>)</span>
<span id="cb10-6"><a href="#cb10-6"></a>  x&lt;-<span class="kw">rep</span>(<span class="ot">NA</span>, n)</span>
<span id="cb10-7"><a href="#cb10-7"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n) {</span>
<span id="cb10-8"><a href="#cb10-8"></a>    <span class="cf">if</span>(<span class="kw">abs</span>(u3[i])<span class="op">&gt;</span><span class="kw">abs</span>(u1[i])<span class="op">&amp;</span><span class="kw">abs</span>(u3[i])<span class="op">&gt;</span><span class="kw">abs</span>(u2[i])){</span>
<span id="cb10-9"><a href="#cb10-9"></a>      x[i]&lt;-u2[i]</span>
<span id="cb10-10"><a href="#cb10-10"></a>    }<span class="cf">else</span>{</span>
<span id="cb10-11"><a href="#cb10-11"></a>      x[i]&lt;-u3[i]</span>
<span id="cb10-12"><a href="#cb10-12"></a>    }</span>
<span id="cb10-13"><a href="#cb10-13"></a>  }</span>
<span id="cb10-14"><a href="#cb10-14"></a>  <span class="kw">return</span>(x)</span>
<span id="cb10-15"><a href="#cb10-15"></a>}</span>
<span id="cb10-16"><a href="#cb10-16"></a><span class="co">#generate 10000 random observations</span></span>
<span id="cb10-17"><a href="#cb10-17"></a><span class="kw">set.seed</span>(<span class="dv">246</span>)</span>
<span id="cb10-18"><a href="#cb10-18"></a>n&lt;-<span class="dv">100</span></span>
<span id="cb10-19"><a href="#cb10-19"></a>x&lt;-<span class="kw">rEk</span>(<span class="dv">100</span>)</span>
<span id="cb10-20"><a href="#cb10-20"></a><span class="co">#the histogram density estimate</span></span>
<span id="cb10-21"><a href="#cb10-21"></a><span class="kw">hist</span>(x,<span class="dt">prob =</span> <span class="ot">TRUE</span>,<span class="dt">xlab =</span><span class="st">&quot;x&quot;</span>,<span class="dt">breaks =</span> <span class="dv">40</span>,<span class="dt">xlim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="fl">1.2</span>, <span class="fl">1.2</span>),<span class="dt">main =</span> <span class="kw">expression</span>(<span class="kw">f</span>(x)<span class="op">==</span><span class="dv">3</span><span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>x<span class="op">^</span><span class="dv">2</span>)<span class="op">/</span><span class="dv">4</span>))</span>
<span id="cb10-22"><a href="#cb10-22"></a><span class="kw">lines</span>(<span class="kw">density</span>(x))</span>
<span id="cb10-23"><a href="#cb10-23"></a>y &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>,<span class="fl">0.01</span>)</span>
<span id="cb10-24"><a href="#cb10-24"></a><span class="kw">lines</span>(y,<span class="dv">3</span><span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>y<span class="op">^</span><span class="dv">2</span>)<span class="op">/</span><span class="dv">4</span>, <span class="dt">col=</span><span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>  FIGURE 2 Probability density histogram of a random sample with the theoretical density <span class="math inline">\(f_e(x)=\frac{3}{4}(1-x^2),|x|\le1\)</span> superimposed.</p>
<p>  Note that the black line represents the kernel density estimation of the sample and the red line represents the theoretical density.The histogram density estimate and theoretical density approximately agree in the Figure 2.</p>
<ul>
<li><p><strong>3.10</strong></p>
<p>Let <span class="math inline">\(A=\{|U_3|\ge|U_2|\} \bigcap \{|U_3|\ge|U_1|\}\)</span> be the event that both of them come up.Then,when <span class="math inline">\(|x|\le1\)</span>,according to total probability theorem, <span class="math display">\[\begin{aligned}
P(X\le x)&amp;=P(X\le x,A)+P(X\le x,A^C)\\
&amp;=P(U_2\le x,A)+P(U_1\le x,A^C)\\
&amp;=\int_{-1}^{x}P(A|U_2=u_2)f_{U_2}(u_2)du_2+\int_{-1}^{x}P(A^C|U_3=u_3)f_{U_3}(u_3)du_2\\
&amp;=\frac{1}{2}\int_{-1}^{x}P(A|U_2=u_2)du_2+\frac{1}{2}\int_{-1}^{x}P(A^C|U_3=u_3)du_2\\
\end{aligned}\]</span> Obviously, <span class="math inline">\(|U_1|,|U_2|,|U_3|\sim U(0,1)\)</span>. Calculate <span class="math inline">\(P(A|U_2=u_2)\)</span> and <span class="math inline">\(P(A^C|U_3=u_3)\)</span> respectively, <span class="math display">\[\begin{aligned}
P(A|U_2=u_2)&amp;=P(A||U_2|=|u_2|)\\
&amp;=\int_{|u_2|}^1d|u_3|\int^{|u_3|}_0d|u_1| \\
&amp;=\frac{1}{2}(1-u_2^2)\\
P(A^C|U_3=u_3)&amp;=P(A^C||U_3|=|u_3|)\\
&amp;=\int_{|u_3|}^1d|u_2|+\int_{|u_3|}^1d|u_1|-\int_{|u_3|}^1d|u_1|\int_{|u_3|}^1d|u_2|\\
&amp;=1-|u_3|+1-|u_3|-(1-|u_3|)(1-|u_3|)\\
&amp;=1-u_3^2\\
\end{aligned}\]</span> Rearrange the equations, <span class="math display">\[\begin{aligned}
P(X\le x)&amp;=\frac{1}{2}\int_{-1}^{x}\frac{1}{2}(1-u_2^2)du_2+\frac{1}{2}\int_{-1}^{x}(1-u_3^2）du_3\\
&amp;=\frac{3}{4}\int_{-1}^{x}(1-u_2^2)du_2\\
&amp;=\frac{3}{4}x-\frac{1}{4}x^3+\frac{1}{2}
\end{aligned}\]</span> Consequently, <span class="math display">\[P(X\le x)=F_e(x)=\frac{3}{4}x-\frac{1}{4}x^3+\frac{1}{2},\qquad |x|\le1\]</span> the algorithm given in Exercise 3.9 generates variates from the density <span class="math inline">\(f_e\)</span>.</p></li>
<li><p><strong>3.13</strong></p>
<p>Suppose <span class="math inline">\(X|\Lambda\sim Exp(\lambda)\)</span>, and <span class="math inline">\(\Lambda\sim Gamma(r,\beta)\)</span>.Then the marginal distribution of <span class="math inline">\(Y\)</span> is Pareto distribution with cdf</p>
<p><span class="math display">\[F(x)=1-\bigg(\frac{\beta}{\beta+x}\bigg)^r,\quad x\ge 0\]</span> <strong>Rcode and results:</strong></p></li>
</ul>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a><span class="co">#generate 1000 random observations from the mixture </span></span>
<span id="cb11-2"><a href="#cb11-2"></a><span class="kw">set.seed</span>(<span class="dv">137</span>)</span>
<span id="cb11-3"><a href="#cb11-3"></a>n&lt;-<span class="dv">100</span></span>
<span id="cb11-4"><a href="#cb11-4"></a>r&lt;-<span class="dv">4</span></span>
<span id="cb11-5"><a href="#cb11-5"></a>beta&lt;-<span class="dv">2</span></span>
<span id="cb11-6"><a href="#cb11-6"></a>lambda&lt;-<span class="kw">rgamma</span>(n, r, beta)</span>
<span id="cb11-7"><a href="#cb11-7"></a>x&lt;-<span class="kw">rexp</span>(n, lambda)</span>
<span id="cb11-8"><a href="#cb11-8"></a><span class="co">#the density histogram of the sample with the Pareto density curve superimposed</span></span>
<span id="cb11-9"><a href="#cb11-9"></a><span class="kw">hist</span>(x,<span class="dt">prob =</span> <span class="ot">TRUE</span>,<span class="dt">xlab =</span><span class="st">&quot;x&quot;</span>,<span class="dt">breaks =</span> <span class="dv">40</span>,<span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">20</span>),<span class="dt">main =</span> <span class="kw">expression</span>(<span class="kw">f</span>(x)<span class="op">==</span><span class="dv">64</span><span class="op">/</span>(<span class="dv">2</span><span class="op">+</span>y)<span class="op">^</span><span class="dv">5</span>))</span>
<span id="cb11-10"><a href="#cb11-10"></a>y&lt;-<span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">20</span>,<span class="fl">0.01</span>)</span>
<span id="cb11-11"><a href="#cb11-11"></a><span class="kw">lines</span>(y,<span class="dv">64</span><span class="op">/</span>(<span class="dv">2</span><span class="op">+</span>y)<span class="op">^</span><span class="dv">5</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>  FIGURE 3 Probability density histogram of a random sample from the mixture with <span class="math inline">\(r=4\)</span> and <span class="math inline">\(\beta=2\)</span> with the theoretical (Pareto) density <span class="math inline">\(f(x)=\frac{64}{(2+y)^5}\)</span> superimposed.</p>
<p>  The histogram and density plot in Figure 3 suggests that the empirical and theoretical (Pareto) distribution approximately agree when <span class="math inline">\(r=4\)</span>, <span class="math inline">\(\beta=2\)</span>.</p>
</div>
</div>
<div id="hw3" class="section level2">
<h2>HW3</h2>
<div id="question3" class="section level3">
<h3>Question3：</h3>
<ul>
<li><p><strong>Exercise5.1</strong></p>
<p>Compute a Monte Carlo estimate of <span class="math display">\[\int_0^{\pi/3}sin\ t\ dt\]</span> and compare your estimate with the exact value of the integral.</p></li>
<li><p><strong>Exercise5.7</strong></p>
<p>Refer to Exercise 5.6. Use a Monte Carlo simulation to estimate θ by the antithetic variate approach and by the simple Monte Carlo method. Compute an empirical estimate of the percent reduction in variance using the antithetic variate. Compare the result with the theoretical value from Exercise 5.6.</p></li>
<li><p><strong>Exercise5.11</strong></p>
<p>If <span class="math inline">\(\hat\theta_1\)</span> and <span class="math inline">\(\hat\theta_2\)</span> are estimators of <span class="math inline">\(\theta\)</span>, and <span class="math inline">\(\hat\theta_1\)</span> and <span class="math inline">\(\hat\theta_2\)</span> are antithetic, we derived that <span class="math inline">\(c^*=1/2\)</span> is the optimal constant that minimizes the variance of <span class="math inline">\(\hat\theta_c=c\hat\theta_2+(1-c)\hat\theta_2\)</span>. Derive <span class="math inline">\(c^*\)</span> for the general case. That is, if <span class="math inline">\(\hat\theta_1\)</span> and <span class="math inline">\(\hat\theta_2\)</span> are any two unbiased estimators of <span class="math inline">\(\theta\)</span>, find the value <span class="math inline">\(c^*\)</span> that minimizes the variance of the estimator <span class="math inline">\(\hat\theta_c=c\hat\theta_2+(1-c)\hat\theta_2\)</span> in equation (5.11) (<span class="math inline">\(c^*\)</span> will be a function of the variances and the covariance of the estimators.)</p></li>
</ul>
</div>
<div id="answer3" class="section level3">
<h3>Answer3：</h3>
<ul>
<li><p><strong>5.1</strong></p>
<p><strong>Basic idea:</strong></p>
<p>The integral can be written as <span class="math display">\[\int_{0}^{\pi/3}\sin{t}\ dt=\frac{\pi}{3}\int_{0}^{\pi/3}\sin{t}\cdot\frac{3}{\pi}\ dt\ .\]</span> Therefore, the simple Monte Carlo estimator of <span class="math inline">\(\theta=\int_{0}^{\pi/3}\sin{t}\ dt\)</span> is <span class="math display">\[\hat{\theta}=\frac{\pi}{3n}\sum\limits_{i=1}^n\sin{X_i}\]</span> where <span class="math inline">\(X_1,\dots,X_n\ i.i.d\sim U(0,\pi/3)\)</span>. In addition, the exact value of the integral is <span class="math display">\[\theta=1-\cos{\frac{\pi}{3}}=\frac{1}{2}\]</span></p>
<p><strong>Rcode and results:</strong></p></li>
</ul>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a><span class="kw">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb12-2"><a href="#cb12-2"></a>x&lt;-<span class="kw">runif</span>(<span class="dv">100</span>,<span class="dv">0</span>,pi<span class="op">/</span><span class="dv">3</span>)</span>
<span id="cb12-3"><a href="#cb12-3"></a><span class="co">#Monte Carlo estimate</span></span>
<span id="cb12-4"><a href="#cb12-4"></a>sinMC&lt;-<span class="kw">mean</span>(pi<span class="op">*</span><span class="kw">sin</span>(x)<span class="op">/</span><span class="dv">3</span>) </span>
<span id="cb12-5"><a href="#cb12-5"></a><span class="co"># Exact value</span></span>
<span id="cb12-6"><a href="#cb12-6"></a>sinEV&lt;-<span class="dv">1</span><span class="op">-</span><span class="kw">cos</span>(pi<span class="op">/</span><span class="dv">3</span>) </span>
<span id="cb12-7"><a href="#cb12-7"></a><span class="kw">print</span>(<span class="kw">c</span>(sinMC,sinEV))</span>
<span id="cb12-8"><a href="#cb12-8"></a><span class="co">#&gt; [1] 0.4250122 0.4800467</span></span></code></pre></div>
<p>As shown above, the estimate is <span class="math inline">\(\hat\theta=\)</span> 0.4250122 and the exact value is <span class="math inline">\(\theta=0.5\)</span>.</p>
<ul>
<li><p><strong>5.7</strong></p>
<p><strong>Basic idea:</strong></p>
<p><strong>(1)The simple Monte Carlo method</strong></p>
<p>The integral can be considered as the mathematical expectation of the random variable <span class="math inline">\(g(U)=e^U\)</span>,where <span class="math inline">\(U\sim U(0,1)\)</span>.Therefore, the simple Monte Carlo estimator of <span class="math inline">\(\theta=E(g(U))\)</span> is <span class="math display">\[\hat\theta=\frac{1}{m}\sum\limits_{i=1}^me^{U_i}\]</span> where <span class="math inline">\(U_1,\dots,U_m\ i.i.d\sim U(0,1)\)</span>.</p>
<p><strong>(2)The antithetic variate approach</strong></p>
<p>The integrated function <span class="math inline">\(g(x)=e^x\)</span> is monotonically increasing. Thus, for a random variable <span class="math inline">\(U\sim U(0,1)\)</span>, <span class="math inline">\(g(U)\)</span> and <span class="math inline">\(g(1-U)\)</span> are negatively correlated.Generate random numbers <span class="math inline">\(U_1,\dots,U_m\ i.i.d\sim U(0,1)\)</span>. <span class="math inline">\(\hat\theta_1=\frac{2}{m}\sum\limits_{i=1}^{m/2}g(U_i)\)</span> and <span class="math inline">\(\hat\theta_2=\frac{2}{m}\sum\limits_{i=1}^{m/2}g(1-U_i)\)</span> are also negatively correlated which are the unbiased estimators of <span class="math inline">\(\theta\)</span>. Therefore,the antithetic variable estimator is <span class="math display">\[\begin{aligned}
\hat\theta&#39;&amp;=\frac{1}{2}\hat\theta_1+\frac{1}{2}\hat\theta_2\\
&amp;=\frac{1}{m}\sum\limits_{i=1}^{m/2}e^{U_i}+\frac{1}{m}\sum\limits_{i=1}^{m/2}e^{1-U_i}
\end{aligned}\]</span></p>
<p><strong>(3)The theoretical value</strong></p>
<p>Compute <span class="math inline">\(cov(e^U,e^{1-U})\)</span>, <span class="math display">\[E(e^U)=E(e^{1-U})=e-1\]</span> <span class="math display">\[\begin{aligned}
Var(e^U)&amp;=\int_0^1e^{2u}du-(e-1)^2\\
&amp;=\frac{1}{2}e^2-\frac{1}{2}-(e-1)^2
\end{aligned}\]</span> <span class="math display">\[\begin{aligned}
cov(e^U,e^{1-U})&amp;=\int_0^1[e^u-(e-1)][e^{1-u}-(e-1)]du\\
&amp;=e-(e-1)^2
\end{aligned}\]</span></p>
<p>Compute <span class="math inline">\(Var(e^U+e^{1-U})\)</span>, <span class="math display">\[\begin{aligned}
Var(e^U+e^{1-U})&amp;=Var(e^U)+Var(e^{1-U})+2cov(e^U,e^{1-U})\\
&amp;=2(\frac{1}{2}e^2-\frac{1}{2})-2(e-1)^2+2e-2(e-1)^2\\
&amp;=e^2-1+2e-4(e-1)^2\\
&amp;=-3e^2+10e-5
\end{aligned}\]</span></p>
<p>In the simulation,compared with the simple Monte Carlo method, only half of random numbers are used in the antithetic variate approach. <span class="math display">\[\begin{aligned}Var(\hat\theta&#39;)&amp;=Var(\frac{1}{m}\sum\limits_{i=1}^{m/2}e^{U_i}+\frac{1}{m}\sum\limits_{i=1}^{m/2}e^{1-U_i})\\
&amp;=\frac{2}{m}Var(\frac{1}{2}e^U+\frac{1}{2}e^{1-U})\\
\end{aligned}\]</span> <span class="math display">\[Var(\hat\theta)=Var(\frac{1}{m}\sum\limits_{i=1}^{m}e^{U_i})=\frac{1}{m}Var(e^U)\]</span></p>
<p>The theoretical value is <span class="math display">\[\begin{aligned}
100\cdot\left(\frac{Var(\hat{\theta})-Var(\hat\theta&#39;)}{Var(\hat{\theta})}\right)&amp;=100\cdot\left(\frac{Var(e^U)-2Var(\frac{1}{2}e^U+\frac{1}{2}e^{1-U})}{Var(e^U)}\right)\\
&amp;=100\times\left[1-2\frac{-3e^2+10e-5}{2e^2-2-4(e-1)^2}\right]\\
&amp;\approx96.76701
\end{aligned}\]</span> <strong>Rcode and results:</strong></p></li>
</ul>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a>f&lt;-<span class="cf">function</span>(x){</span>
<span id="cb13-2"><a href="#cb13-2"></a>  y&lt;-<span class="kw">exp</span>(x)</span>
<span id="cb13-3"><a href="#cb13-3"></a>  <span class="kw">return</span>(y)</span>
<span id="cb13-4"><a href="#cb13-4"></a>}</span>
<span id="cb13-5"><a href="#cb13-5"></a>theta_MC&lt;-<span class="cf">function</span>(n,<span class="dt">duiou =</span> <span class="ot">TRUE</span>)</span>
<span id="cb13-6"><a href="#cb13-6"></a>{</span>
<span id="cb13-7"><a href="#cb13-7"></a>  x1&lt;-<span class="kw">runif</span>(n<span class="op">/</span><span class="dv">2</span>)</span>
<span id="cb13-8"><a href="#cb13-8"></a>  <span class="cf">if</span>(duiou <span class="op">==</span><span class="st"> </span><span class="ot">TRUE</span>)</span>
<span id="cb13-9"><a href="#cb13-9"></a>    x2&lt;-<span class="dv">1</span><span class="op">-</span>x1</span>
<span id="cb13-10"><a href="#cb13-10"></a>  <span class="cf">else</span></span>
<span id="cb13-11"><a href="#cb13-11"></a>    x2&lt;-<span class="kw">runif</span>(n<span class="op">/</span><span class="dv">2</span>)</span>
<span id="cb13-12"><a href="#cb13-12"></a>  uniform&lt;-<span class="kw">c</span>(x1,x2)</span>
<span id="cb13-13"><a href="#cb13-13"></a>  MC&lt;-<span class="kw">mean</span>(<span class="kw">f</span>(uniform))</span>
<span id="cb13-14"><a href="#cb13-14"></a>}</span>
<span id="cb13-15"><a href="#cb13-15"></a>m&lt;-<span class="dv">10000</span></span>
<span id="cb13-16"><a href="#cb13-16"></a><span class="kw">set.seed</span>(<span class="dv">134</span>)</span>
<span id="cb13-17"><a href="#cb13-17"></a>theta_MC0=<span class="kw">theta_MC</span>(m,<span class="dt">duiou =</span> <span class="ot">FALSE</span>)</span>
<span id="cb13-18"><a href="#cb13-18"></a><span class="kw">set.seed</span>(<span class="dv">134</span>)</span>
<span id="cb13-19"><a href="#cb13-19"></a>theta_MC1=<span class="kw">theta_MC</span>(m,<span class="dt">duiou =</span> <span class="ot">TRUE</span>)</span>
<span id="cb13-20"><a href="#cb13-20"></a><span class="co">#estimators and exact value</span></span>
<span id="cb13-21"><a href="#cb13-21"></a><span class="kw">print</span>(<span class="kw">c</span>(theta_MC0,theta_MC1,<span class="kw">exp</span>(<span class="dv">1</span>)<span class="op">-</span><span class="dv">1</span>))</span>
<span id="cb13-22"><a href="#cb13-22"></a><span class="co">#&gt; [1] 1.716058 1.717269 1.718282</span></span>
<span id="cb13-23"><a href="#cb13-23"></a><span class="co">#variance</span></span>
<span id="cb13-24"><a href="#cb13-24"></a><span class="kw">set.seed</span>(<span class="dv">1220</span>)</span>
<span id="cb13-25"><a href="#cb13-25"></a>num&lt;-<span class="dv">100</span></span>
<span id="cb13-26"><a href="#cb13-26"></a>eMC0&lt;-<span class="kw">numeric</span>(num)</span>
<span id="cb13-27"><a href="#cb13-27"></a>eMC1&lt;-<span class="kw">numeric</span>(num)</span>
<span id="cb13-28"><a href="#cb13-28"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>num)</span>
<span id="cb13-29"><a href="#cb13-29"></a>{</span>
<span id="cb13-30"><a href="#cb13-30"></a>  eMC0[i]&lt;-<span class="kw">theta_MC</span>(m,<span class="dt">duiou =</span> <span class="ot">FALSE</span>)</span>
<span id="cb13-31"><a href="#cb13-31"></a>  eMC1[i]&lt;-<span class="kw">theta_MC</span>(m,<span class="dt">duiou =</span> <span class="ot">TRUE</span>)</span>
<span id="cb13-32"><a href="#cb13-32"></a>}</span>
<span id="cb13-33"><a href="#cb13-33"></a><span class="kw">print</span>(<span class="kw">c</span>(<span class="kw">var</span>(eMC0),<span class="kw">var</span>(eMC1)))</span>
<span id="cb13-34"><a href="#cb13-34"></a><span class="co">#&gt; [1] 2.386305e-05 6.922278e-07</span></span>
<span id="cb13-35"><a href="#cb13-35"></a><span class="co">#percent reduction</span></span>
<span id="cb13-36"><a href="#cb13-36"></a><span class="kw">print</span>(<span class="dv">100</span><span class="op">*</span>(<span class="dv">1</span><span class="op">-</span><span class="kw">var</span>(eMC1)<span class="op">/</span><span class="kw">var</span>(eMC0)))</span>
<span id="cb13-37"><a href="#cb13-37"></a><span class="co">#&gt; [1] 97.09916</span></span>
<span id="cb13-38"><a href="#cb13-38"></a><span class="co">#compare</span></span>
<span id="cb13-39"><a href="#cb13-39"></a><span class="kw">print</span>(<span class="kw">c</span>(<span class="dv">100</span><span class="op">*</span>(<span class="dv">1</span><span class="op">-</span><span class="kw">var</span>(eMC1)<span class="op">/</span><span class="kw">var</span>(eMC0)),<span class="dv">100-100</span><span class="op">*</span>(<span class="op">-</span><span class="dv">3</span><span class="op">*</span><span class="kw">exp</span>(<span class="dv">2</span>)<span class="op">+</span><span class="dv">10</span><span class="op">*</span><span class="kw">exp</span>(<span class="dv">1</span>)<span class="op">-</span><span class="dv">5</span>)<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span><span class="kw">exp</span>(<span class="dv">2</span>)<span class="op">-</span><span class="dv">2-4</span><span class="op">*</span>(<span class="kw">exp</span>(<span class="dv">1</span>)<span class="op">-</span><span class="dv">1</span>)<span class="op">^</span><span class="dv">2</span>)<span class="op">*</span><span class="dv">2</span>))</span>
<span id="cb13-40"><a href="#cb13-40"></a><span class="co">#&gt; [1] 97.09916 96.76701</span></span></code></pre></div>
<p>As shown above, the estimates in the antithetic variate approach and in the simple Monte Carlo method are <span class="math inline">\(\hat\theta&#39;=\)</span> 1.7172689, <span class="math inline">\(\hat\theta=\)</span> 1.7160579 and the exact value is <span class="math inline">\(\theta=\)</span> 1.718282. By calculation, the empirical estimate of the percent reduction in variance is approximately equal to the theoretical value.</p>
<ul>
<li><p><strong>5.11</strong></p>
<p>Compute <span class="math inline">\(Var(\hat\theta_c)\)</span> <span class="math display">\[\begin{aligned}
Var(\hat\theta_c)&amp;=Var[c\hat\theta_1+(1-c)\hat\theta_2]\\
&amp;=Var[c(\hat\theta_1-\hat\theta_2)+\hat\theta_2]\\
&amp;=c^2Var(\hat\theta_1-\hat\theta_2)+2ccov(\hat\theta_2,\hat\theta_1-\hat\theta_2)+Var(\hat\theta_2)\\
\end{aligned}\]</span></p>
<p>According to the Vieta theorem, the optimal constant <span class="math display">\[\begin{aligned}
c^*\ &amp;=-\frac{2cov(\hat\theta_2,\hat\theta_1-\hat\theta_2)}{2Var(\hat\theta_1-\hat\theta_2)}\\
&amp;=-\frac{cov(\hat\theta_2,\hat\theta_1-\hat\theta_2)}{Var(\hat\theta_1-\hat\theta_2)}
\end{aligned}\]</span></p>
<p><span class="math inline">\(c^*\)</span> is a function of the variances and the covariance of the estimators.If <span class="math inline">\(\hat\theta_1\)</span> and <span class="math inline">\(\hat\theta_2\)</span> are antithetic, <span class="math display">\[c^*=\frac{1}{2}.\]</span></p></li>
</ul>
</div>
</div>
<div id="hw4" class="section level2">
<h2>HW4</h2>
<div id="question4" class="section level3">
<h3>Question4：</h3>
<ul>
<li><p><strong>Exercise5.13</strong></p>
<p>Find two importance functions <span class="math inline">\(f_1\)</span> and <span class="math inline">\(f_2\)</span> that are supported on <span class="math inline">\((1,\infty)\)</span> and are ‘close’ to <span class="math display">\[g(x)=\frac{x^2}{\sqrt{2\pi}}e^{-x^2/2}, \qquad x&gt;1.\]</span> Which of your two importance functions should produce the smaller variance in estimating <span class="math display">\[\int_1^\infty \frac{x^2}{\sqrt{2\pi}}e^{-x^2/2}dx\]</span> by importance sampling? Explain.</p></li>
<li><p><strong>Exercise5.15</strong></p>
<p>Obtain the stratified importance sampling estimate in Example 5.13 and compare it with the result of Example 5.10.</p></li>
<li><p><strong>Exercise6.4</strong></p>
<p>Suppose that <span class="math inline">\(X_1,\cdots,X_n\)</span> are a random sample from a from a lognormal distribution with unknown parameters. Construct a 95% confidence interval for the parameter <span class="math inline">\(\mu\)</span>. Use a Monte Carlo method to obtain an empirical estimate of the confidence level.</p></li>
<li><p><strong>Exercise6.5</strong></p>
<p>Suppose a 95% symmetric t-interval is applied to estimate a mean, but the sample data are non-normal. Then the probability that the confidence interval covers the mean is not necessarily equal to 0.95. Use a Monte Carlo experiment to estimate the coverage probability of the t-interval for random samples of <span class="math inline">\(\chi^2(2)\)</span> data with sample size <span class="math inline">\(n=20\)</span>. Compare your t-interval results with the simulation results in Example 6.4. (The t-interval should be more robust to departures from normality than the interval for variance.)</p></li>
</ul>
</div>
<div id="answer4" class="section level3">
<h3>Answer4：</h3>
<ul>
<li><p><strong>5.13</strong></p>
<p><strong>Basic idea:</strong></p>
<p>Choose three functions to estimate the integral <span class="math inline">\(\int_0^1g(x)dx=\int_0^1\frac{e^{-x}}{1-e^{-1}}dx\)</span>, <span class="math display">\[\begin{aligned}
f_1&amp;=\frac{2}{\sqrt{2\pi}}e^{-\frac{(x-1)^2}{2}}, &amp;\qquad x&gt;1,\\
f_2&amp;= e^{-x+1}, &amp;\qquad x&gt;1,\\
f_3&amp;=\frac{4}{\pi(1+x)^2}, &amp;\qquad x&gt;1.
\end{aligned}\]</span> The densities are plotted for comparison with <span class="math inline">\(g(x)\)</span> in the first figure below. The function seems to be <span class="math inline">\(f_1\)</span> that corresponds to the most nearly constant ratio <span class="math inline">\(\frac{g(x)}{f(x)}\)</span> by analyzing the second figure below. From the graphs, I prefer <span class="math inline">\(f_1\)</span> for the smallest variance.</p>
<p><strong>Rcode and results:</strong></p></li>
</ul>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a><span class="co">#plot the graphs</span></span>
<span id="cb14-2"><a href="#cb14-2"></a>x=<span class="kw">seq</span>(<span class="dv">1</span>,<span class="dv">4</span>,<span class="fl">0.01</span>)</span>
<span id="cb14-3"><a href="#cb14-3"></a>g=x<span class="op">^</span><span class="dv">2</span><span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>x<span class="op">^</span><span class="dv">2</span><span class="op">/</span><span class="dv">2</span>)<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>pi)</span>
<span id="cb14-4"><a href="#cb14-4"></a><span class="kw">plot</span>(x,g,<span class="dt">type=</span><span class="st">&quot;l&quot;</span>, <span class="dt">lwd=</span><span class="dv">3</span>,<span class="dt">col=</span><span class="st">&quot;black&quot;</span>,<span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="dt">ylab =</span> <span class="st">&quot;function&quot;</span>)</span>
<span id="cb14-5"><a href="#cb14-5"></a>f1=<span class="dv">2</span><span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>(x<span class="dv">-1</span>)<span class="op">^</span><span class="dv">2</span><span class="op">/</span><span class="dv">2</span>)<span class="op">/</span><span class="kw">sqrt</span>(<span class="dv">2</span><span class="op">*</span>pi)</span>
<span id="cb14-6"><a href="#cb14-6"></a><span class="kw">lines</span>(x,f1,<span class="dt">lty=</span><span class="dv">1</span>,<span class="dt">col=</span><span class="st">&quot;blue&quot;</span>)</span>
<span id="cb14-7"><a href="#cb14-7"></a>f2=<span class="kw">exp</span>(<span class="op">-</span>x<span class="op">+</span><span class="dv">1</span>)</span>
<span id="cb14-8"><a href="#cb14-8"></a><span class="kw">lines</span>(x,f2,<span class="dt">lty=</span><span class="dv">1</span>,<span class="dt">col=</span><span class="st">&quot;green&quot;</span>)</span>
<span id="cb14-9"><a href="#cb14-9"></a>f3=<span class="dv">1</span><span class="op">/</span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>x<span class="op">^</span><span class="dv">2</span>)<span class="op">/</span>(pi<span class="op">/</span><span class="dv">4</span>)</span>
<span id="cb14-10"><a href="#cb14-10"></a><span class="kw">lines</span>(x,f3,<span class="dt">lty=</span><span class="dv">1</span>,<span class="dt">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb14-11"><a href="#cb14-11"></a><span class="kw">legend</span>(<span class="fl">3.6</span>, <span class="fl">0.95</span>, <span class="kw">c</span>(<span class="st">&quot;g&quot;</span>,<span class="st">&quot;f1&quot;</span>,<span class="st">&quot;f2&quot;</span>,<span class="st">&quot;f3&quot;</span>), <span class="dt">cex=</span><span class="fl">0.9</span>, <span class="dt">col=</span><span class="kw">c</span>(<span class="st">&quot;black&quot;</span>,<span class="st">&quot;blue&quot;</span>,<span class="st">&quot;green&quot;</span>,<span class="st">&quot;red&quot;</span>), <span class="dt">pch=</span><span class="dv">21</span><span class="op">:</span><span class="dv">24</span>, <span class="dt">lty=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>), <span class="dt">bg=</span><span class="st">&quot;grey&quot;</span>, <span class="dt">title.col=</span><span class="st">&quot;black&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a></span>
<span id="cb15-2"><a href="#cb15-2"></a></span>
<span id="cb15-3"><a href="#cb15-3"></a>x=<span class="kw">seq</span>(<span class="dv">1</span>,<span class="dv">10</span>,<span class="fl">0.01</span>)</span>
<span id="cb15-4"><a href="#cb15-4"></a>g=x<span class="op">^</span><span class="dv">2</span><span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>x<span class="op">^</span><span class="dv">2</span><span class="op">/</span><span class="dv">2</span>)<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>pi)</span>
<span id="cb15-5"><a href="#cb15-5"></a>f1=<span class="dv">2</span><span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>(x<span class="dv">-1</span>)<span class="op">^</span><span class="dv">2</span><span class="op">/</span><span class="dv">2</span>)<span class="op">/</span><span class="kw">sqrt</span>(<span class="dv">2</span><span class="op">*</span>pi)</span>
<span id="cb15-6"><a href="#cb15-6"></a><span class="kw">plot</span>(x,g<span class="op">/</span>f1,<span class="dt">type=</span><span class="st">&quot;l&quot;</span>, <span class="dt">lwd=</span><span class="dv">2</span>,<span class="dt">col=</span><span class="st">&quot;blue&quot;</span>,<span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="fl">0.8</span>),<span class="dt">ylab =</span> <span class="st">&quot;function&quot;</span>)</span>
<span id="cb15-7"><a href="#cb15-7"></a>f2=<span class="kw">exp</span>(<span class="op">-</span>x<span class="op">+</span><span class="dv">1</span>)</span>
<span id="cb15-8"><a href="#cb15-8"></a><span class="kw">lines</span>(x,g<span class="op">/</span>f2,<span class="dt">lty=</span><span class="dv">1</span>,<span class="dt">col=</span><span class="st">&quot;green&quot;</span>)</span>
<span id="cb15-9"><a href="#cb15-9"></a>f3=<span class="dv">1</span><span class="op">/</span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>x<span class="op">^</span><span class="dv">2</span>)<span class="op">/</span>(pi<span class="op">/</span><span class="dv">4</span>)</span>
<span id="cb15-10"><a href="#cb15-10"></a><span class="kw">lines</span>(x,f3,<span class="dt">lty=</span><span class="dv">1</span>,<span class="dt">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb15-11"><a href="#cb15-11"></a><span class="kw">legend</span>(<span class="fl">8.2</span>, <span class="fl">0.8</span>, <span class="kw">c</span>(<span class="st">&quot;g/f1&quot;</span>,<span class="st">&quot;g/f2&quot;</span>,<span class="st">&quot;g/f3&quot;</span>), <span class="dt">cex=</span><span class="fl">0.9</span>, <span class="dt">col=</span><span class="kw">c</span>(<span class="st">&quot;blue&quot;</span>,<span class="st">&quot;green&quot;</span>,<span class="st">&quot;red&quot;</span>), <span class="dt">pch=</span><span class="dv">21</span><span class="op">:</span><span class="dv">23</span>, <span class="dt">lty=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>), <span class="dt">bg=</span><span class="st">&quot;grey&quot;</span>, <span class="dt">title.col=</span><span class="st">&quot;black&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a></span>
<span id="cb16-2"><a href="#cb16-2"></a></span>
<span id="cb16-3"><a href="#cb16-3"></a><span class="co">#The estimates and the corresponding standard errors</span></span>
<span id="cb16-4"><a href="#cb16-4"></a><span class="kw">set.seed</span>(<span class="dv">520</span>)</span>
<span id="cb16-5"><a href="#cb16-5"></a>m &lt;-<span class="st"> </span><span class="dv">100</span></span>
<span id="cb16-6"><a href="#cb16-6"></a>theta.hat &lt;-<span class="st"> </span>se &lt;-<span class="st"> </span><span class="kw">numeric</span>(<span class="dv">3</span>)</span>
<span id="cb16-7"><a href="#cb16-7"></a>g &lt;-<span class="st"> </span><span class="cf">function</span>(x)</span>
<span id="cb16-8"><a href="#cb16-8"></a>{ x<span class="op">^</span><span class="dv">2</span><span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>x<span class="op">^</span><span class="dv">2</span><span class="op">/</span><span class="dv">2</span>)<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>pi)<span class="op">*</span>(x<span class="op">&gt;</span><span class="dv">1</span>)}  </span>
<span id="cb16-9"><a href="#cb16-9"></a>f1 &lt;-<span class="st"> </span><span class="cf">function</span>(x)</span>
<span id="cb16-10"><a href="#cb16-10"></a>{<span class="dv">2</span><span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>(x<span class="dv">-1</span>)<span class="op">^</span><span class="dv">2</span><span class="op">/</span><span class="dv">2</span>)<span class="op">/</span><span class="kw">sqrt</span>(<span class="dv">2</span><span class="op">*</span>pi)}</span>
<span id="cb16-11"><a href="#cb16-11"></a>f2 &lt;-<span class="st"> </span><span class="cf">function</span>(x)</span>
<span id="cb16-12"><a href="#cb16-12"></a>{<span class="kw">exp</span>(<span class="op">-</span>x<span class="op">+</span><span class="dv">1</span>)}</span>
<span id="cb16-13"><a href="#cb16-13"></a>f3 &lt;-<span class="st"> </span><span class="cf">function</span>(x)</span>
<span id="cb16-14"><a href="#cb16-14"></a>{<span class="dv">1</span><span class="op">/</span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>x<span class="op">^</span><span class="dv">2</span>)<span class="op">/</span>(pi<span class="op">/</span><span class="dv">4</span>)}</span>
<span id="cb16-15"><a href="#cb16-15"></a><span class="co">#f1 normal transform</span></span>
<span id="cb16-16"><a href="#cb16-16"></a>u1&lt;-<span class="kw">rnorm</span>(m)</span>
<span id="cb16-17"><a href="#cb16-17"></a>x1&lt;-<span class="kw">abs</span>(u1)<span class="op">+</span><span class="dv">1</span></span>
<span id="cb16-18"><a href="#cb16-18"></a>gf1&lt;-<span class="st"> </span><span class="kw">g</span>(x1)<span class="op">/</span><span class="kw">f1</span>(x1)</span>
<span id="cb16-19"><a href="#cb16-19"></a>theta.hat[<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">mean</span>(gf1)</span>
<span id="cb16-20"><a href="#cb16-20"></a>se[<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">sd</span>(gf1)</span>
<span id="cb16-21"><a href="#cb16-21"></a></span>
<span id="cb16-22"><a href="#cb16-22"></a><span class="co">#f2 inverse </span></span>
<span id="cb16-23"><a href="#cb16-23"></a>u &lt;-<span class="kw">runif</span>(m)</span>
<span id="cb16-24"><a href="#cb16-24"></a>x2&lt;-<span class="dv">1</span><span class="op">-</span><span class="kw">log</span>(<span class="dv">1</span><span class="op">-</span>u)</span>
<span id="cb16-25"><a href="#cb16-25"></a>gf2 &lt;-<span class="st"> </span><span class="kw">g</span>(x2)<span class="op">/</span><span class="kw">f2</span>(x2)</span>
<span id="cb16-26"><a href="#cb16-26"></a>theta.hat[<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">mean</span>(gf2)</span>
<span id="cb16-27"><a href="#cb16-27"></a>se[<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">sd</span>(gf2)</span>
<span id="cb16-28"><a href="#cb16-28"></a></span>
<span id="cb16-29"><a href="#cb16-29"></a><span class="co">#f3 inverse </span></span>
<span id="cb16-30"><a href="#cb16-30"></a>u &lt;-<span class="st"> </span><span class="kw">runif</span>(m) </span>
<span id="cb16-31"><a href="#cb16-31"></a>x3 &lt;-<span class="st"> </span><span class="kw">tan</span>(pi<span class="op">*</span>(u<span class="op">+</span><span class="dv">1</span>)<span class="op">/</span><span class="dv">4</span>)</span>
<span id="cb16-32"><a href="#cb16-32"></a>gf3 &lt;-<span class="st"> </span><span class="kw">g</span>(x3)<span class="op">/</span><span class="kw">f3</span>(x3)</span>
<span id="cb16-33"><a href="#cb16-33"></a>theta.hat[<span class="dv">3</span>] &lt;-<span class="st"> </span><span class="kw">mean</span>(gf3)</span>
<span id="cb16-34"><a href="#cb16-34"></a>se[<span class="dv">3</span>] &lt;-<span class="st"> </span><span class="kw">sd</span>(gf3)</span>
<span id="cb16-35"><a href="#cb16-35"></a><span class="kw">print</span>(<span class="kw">rbind</span>(theta.hat,se))</span>
<span id="cb16-36"><a href="#cb16-36"></a><span class="co">#&gt;                 [,1]       [,2]      [,3]</span></span>
<span id="cb16-37"><a href="#cb16-37"></a><span class="co">#&gt; theta.hat 0.16191602 0.16466930 0.1733000</span></span>
<span id="cb16-38"><a href="#cb16-38"></a><span class="co">#&gt; se        0.01817033 0.06292074 0.1262988</span></span></code></pre></div>
<p>The estimate is 0.161916 and the corresponding standard error <span class="math inline">\(se\)</span> is 0.0181703 using the importance function <span class="math inline">\(f_1\)</span>. And the simulation indicates that <span class="math inline">\(f_1\)</span> produces the smallest variance in estimating the integral among these three importance functions.</p>
<ul>
<li><p><strong>5.15</strong></p>
<p><strong>Basic idea:</strong></p>
<p><strong>The stratified importance sampling approach</strong></p>
<p>The estimation is already given in Example 5.10 with importance function <span class="math inline">\(f(x)=\frac{e^{-x}}{1-e^{-1}}\)</span>. Now divide the interval (0,1) into five subintervals,<span class="math inline">\((\frac{j-1}{5},\frac{j}{5}),j=1,\cdots,5\)</span>.Then, make a modification to the importance function on each interval.Considering the selected importance function is <span class="math display">\[f_3(x)=\frac{e^{-x}}{1-e^{-1}},\quad 0&lt;x&lt;1\]</span> The corresponding cumulative distribution function is <span class="math display">\[F_3(x)=\frac{1-e^{-x}}{1-e^{-1}},\quad 0&lt;x&lt;1\]</span> The modification is <span class="math display">\[\begin{aligned}
f_{3j}(x)&amp;=\frac{1}{[F_3(\frac{j}{5})-F_3(\frac{j-1}{5})]}\cdot\frac{e^{-x}}{1-e^{-1}}\\
&amp;=\frac{e^{-x}}{e^{-\frac{j-1}{5}}-e^{-\frac{j}{5}}} \\
F_{3j}(x)&amp;=\frac{e^{-\frac{j-1}{5}}-e^{-x}}{e^{-\frac{j-1}{5}}-e^{-\frac{j}{5}}}
 \end{aligned}\]</span> where <span class="math inline">\(\frac{j-1}{5}&lt;x&lt;\frac{j}{5}\)</span>. Therefore, the stratified importance sampling estimate is <span class="math display">\[\begin{aligned}
\hat{\theta}_{j}&amp;=\frac{5}{n}\sum_{i=1}^{n/5}\frac{g(X_{ji})}{f_{3j}(X_{ji})}\\
\hat{\theta}^{SI}&amp;=\sum_{j=1}^{k=5}\hat{\theta}_{j}\end{aligned}\]</span> where the probability density function of <span class="math inline">\(X_{ji},i=1,\cdots,\frac{n}{5}\)</span> is <span class="math inline">\(f_{3j}(x)\)</span>.</p>
<p><strong>Rcode and results:</strong></p></li>
</ul>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a><span class="co">##Stratified Importance Sampling</span></span>
<span id="cb17-2"><a href="#cb17-2"></a><span class="kw">set.seed</span>(<span class="dv">124</span>)</span>
<span id="cb17-3"><a href="#cb17-3"></a>n=<span class="dv">100</span></span>
<span id="cb17-4"><a href="#cb17-4"></a>k=<span class="dv">5</span></span>
<span id="cb17-5"><a href="#cb17-5"></a>X&lt;-<span class="kw">matrix</span>(<span class="dt">data=</span><span class="ot">NA</span>, <span class="dt">nrow =</span> n<span class="op">/</span>k, <span class="dt">ncol =</span> k)</span>
<span id="cb17-6"><a href="#cb17-6"></a>thetai&lt;-<span class="kw">matrix</span>(<span class="dt">data=</span><span class="ot">NA</span>, <span class="dt">nrow =</span> n<span class="op">/</span>k, <span class="dt">ncol =</span> k)</span>
<span id="cb17-7"><a href="#cb17-7"></a>thetasi&lt;-Varsi&lt;-<span class="kw">numeric</span>(k)</span>
<span id="cb17-8"><a href="#cb17-8"></a>  <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>k)</span>
<span id="cb17-9"><a href="#cb17-9"></a>  {</span>
<span id="cb17-10"><a href="#cb17-10"></a>    <span class="co">#g/f on each subinterval</span></span>
<span id="cb17-11"><a href="#cb17-11"></a>    gfj&lt;-<span class="cf">function</span>(x)</span>
<span id="cb17-12"><a href="#cb17-12"></a>    {(<span class="kw">exp</span>((<span class="op">-</span>j<span class="op">+</span><span class="dv">1</span>)<span class="op">/</span><span class="dv">5</span>) <span class="op">-</span><span class="st"> </span><span class="kw">exp</span>((<span class="op">-</span>j)<span class="op">/</span><span class="dv">5</span>))<span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>x<span class="op">^</span><span class="dv">2</span>)}</span>
<span id="cb17-13"><a href="#cb17-13"></a>    u &lt;-<span class="st"> </span><span class="kw">runif</span>(n<span class="op">/</span>k)</span>
<span id="cb17-14"><a href="#cb17-14"></a>    <span class="co">#randoms on each subinterval</span></span>
<span id="cb17-15"><a href="#cb17-15"></a>    X[,j] &lt;-<span class="op">-</span><span class="kw">log</span>(<span class="kw">exp</span>((<span class="op">-</span>j<span class="op">+</span><span class="dv">1</span>)<span class="op">/</span><span class="dv">5</span>) <span class="op">-</span><span class="st"> </span>u<span class="op">*</span>(<span class="kw">exp</span>((<span class="op">-</span>j<span class="op">+</span><span class="dv">1</span>)<span class="op">/</span><span class="dv">5</span>) <span class="op">-</span><span class="st"> </span><span class="kw">exp</span>((<span class="op">-</span>j)<span class="op">/</span><span class="dv">5</span>)))</span>
<span id="cb17-16"><a href="#cb17-16"></a>    <span class="co"># Integration on each subinterval</span></span>
<span id="cb17-17"><a href="#cb17-17"></a>    thetai[,j]&lt;-<span class="st"> </span><span class="kw">gfj</span>(X[,j])</span>
<span id="cb17-18"><a href="#cb17-18"></a>    Varsi[j]&lt;-<span class="kw">var</span>(thetai[,j])</span>
<span id="cb17-19"><a href="#cb17-19"></a>    thetasi[j]&lt;-<span class="kw">mean</span>(thetai[,j])</span>
<span id="cb17-20"><a href="#cb17-20"></a>  }</span>
<span id="cb17-21"><a href="#cb17-21"></a> theta&lt;-<span class="kw">sum</span>(thetasi)</span>
<span id="cb17-22"><a href="#cb17-22"></a> Var&lt;-(k<span class="op">/</span>n)<span class="op">*</span><span class="kw">sum</span>(Varsi)</span>
<span id="cb17-23"><a href="#cb17-23"></a> se&lt;-<span class="kw">sqrt</span>(Var)</span>
<span id="cb17-24"><a href="#cb17-24"></a> <span class="kw">print</span>(<span class="kw">c</span>(theta,se))</span>
<span id="cb17-25"><a href="#cb17-25"></a><span class="co">#&gt; [1] 0.52670064 0.00168391</span></span></code></pre></div>
<p>The stratified importance sampling estimate is 0.5267006 and <span class="math inline">\(\widehat {se}\)</span>=0.0016839 which is smaller than the five standard errors of Example 5.10.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a><span class="co">##Importance Sampling</span></span>
<span id="cb18-2"><a href="#cb18-2"></a><span class="kw">set.seed</span>(<span class="dv">137</span>)</span>
<span id="cb18-3"><a href="#cb18-3"></a>n=<span class="dv">100</span><span class="co">#sample size</span></span>
<span id="cb18-4"><a href="#cb18-4"></a>Moni=<span class="dv">50</span><span class="co">#number of times to repeat the estimation</span></span>
<span id="cb18-5"><a href="#cb18-5"></a>theta.hat1&lt;-theta.hat2&lt;-<span class="kw">numeric</span>(Moni)</span>
<span id="cb18-6"><a href="#cb18-6"></a>gf&lt;-<span class="cf">function</span>(x)</span>
<span id="cb18-7"><a href="#cb18-7"></a>{(<span class="dv">1</span><span class="op">-</span><span class="kw">exp</span>(<span class="op">-</span><span class="dv">1</span>))<span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>x<span class="op">^</span><span class="dv">2</span>)}</span>
<span id="cb18-8"><a href="#cb18-8"></a><span class="cf">for</span>(mo <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>Moni)</span>
<span id="cb18-9"><a href="#cb18-9"></a>{U&lt;-<span class="kw">runif</span>(n)</span>
<span id="cb18-10"><a href="#cb18-10"></a>x&lt;-<span class="op">-</span><span class="kw">log</span>(<span class="dv">1</span><span class="op">-</span>U<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span><span class="kw">exp</span>(<span class="op">-</span><span class="dv">1</span>)))</span>
<span id="cb18-11"><a href="#cb18-11"></a>theta.hat1[mo]&lt;-<span class="st"> </span><span class="kw">mean</span>(<span class="kw">gf</span>(x))</span>
<span id="cb18-12"><a href="#cb18-12"></a>}</span>
<span id="cb18-13"><a href="#cb18-13"></a>theta1&lt;-<span class="kw">mean</span>(theta.hat1)</span>
<span id="cb18-14"><a href="#cb18-14"></a>se1=<span class="kw">sd</span>(theta.hat1)</span>
<span id="cb18-15"><a href="#cb18-15"></a>Var1=<span class="kw">var</span>(theta.hat1)</span>
<span id="cb18-16"><a href="#cb18-16"></a><span class="co">##Stratified Importance Sampling</span></span>
<span id="cb18-17"><a href="#cb18-17"></a>k=<span class="dv">5</span></span>
<span id="cb18-18"><a href="#cb18-18"></a>X&lt;-<span class="kw">matrix</span>(<span class="dt">data=</span><span class="ot">NA</span>, <span class="dt">nrow =</span> n<span class="op">/</span>k, <span class="dt">ncol =</span> k)</span>
<span id="cb18-19"><a href="#cb18-19"></a>theta.si&lt;-<span class="kw">matrix</span>(<span class="dt">data=</span><span class="ot">NA</span>, <span class="dt">nrow =</span> Moni, <span class="dt">ncol =</span> k)</span>
<span id="cb18-20"><a href="#cb18-20"></a><span class="cf">for</span>(mo <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>Moni)</span>
<span id="cb18-21"><a href="#cb18-21"></a>{</span>
<span id="cb18-22"><a href="#cb18-22"></a>  <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>k)</span>
<span id="cb18-23"><a href="#cb18-23"></a>  {</span>
<span id="cb18-24"><a href="#cb18-24"></a>    <span class="co">#g/f on each subinterval</span></span>
<span id="cb18-25"><a href="#cb18-25"></a>    gfj&lt;-<span class="cf">function</span>(x)</span>
<span id="cb18-26"><a href="#cb18-26"></a>    {(<span class="kw">exp</span>((<span class="op">-</span>j<span class="op">+</span><span class="dv">1</span>)<span class="op">/</span><span class="dv">5</span>) <span class="op">-</span><span class="st"> </span><span class="kw">exp</span>((<span class="op">-</span>j)<span class="op">/</span><span class="dv">5</span>))<span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>x<span class="op">^</span><span class="dv">2</span>)}</span>
<span id="cb18-27"><a href="#cb18-27"></a>    u &lt;-<span class="st"> </span><span class="kw">runif</span>(n<span class="op">/</span>k)</span>
<span id="cb18-28"><a href="#cb18-28"></a>    <span class="co">#randoms on each subinterval</span></span>
<span id="cb18-29"><a href="#cb18-29"></a>    X[,j] &lt;-<span class="op">-</span><span class="kw">log</span>(<span class="kw">exp</span>((<span class="op">-</span>j<span class="op">+</span><span class="dv">1</span>)<span class="op">/</span><span class="dv">5</span>) <span class="op">-</span><span class="st"> </span>u<span class="op">*</span>(<span class="kw">exp</span>((<span class="op">-</span>j<span class="op">+</span><span class="dv">1</span>)<span class="op">/</span><span class="dv">5</span>) <span class="op">-</span><span class="st"> </span><span class="kw">exp</span>((<span class="op">-</span>j)<span class="op">/</span><span class="dv">5</span>)))</span>
<span id="cb18-30"><a href="#cb18-30"></a>    <span class="co"># Integration on each subinterval</span></span>
<span id="cb18-31"><a href="#cb18-31"></a>    theta.si[mo,j]&lt;-<span class="st"> </span><span class="kw">mean</span>(<span class="kw">gfj</span>(X[,j]))</span>
<span id="cb18-32"><a href="#cb18-32"></a>    theta.hat2[mo]&lt;-<span class="kw">sum</span>(theta.si[mo,])</span>
<span id="cb18-33"><a href="#cb18-33"></a>  }</span>
<span id="cb18-34"><a href="#cb18-34"></a>}</span>
<span id="cb18-35"><a href="#cb18-35"></a>theta2&lt;-<span class="kw">mean</span>(theta.hat2)</span>
<span id="cb18-36"><a href="#cb18-36"></a>se2=<span class="kw">sd</span>(theta.hat2)</span>
<span id="cb18-37"><a href="#cb18-37"></a>Var2=<span class="kw">var</span>(theta.hat2) <span class="co">#variance of integrated items</span></span>
<span id="cb18-38"><a href="#cb18-38"></a>rv=(Var1<span class="op">-</span>Var2)<span class="op">/</span>Var1</span>
<span id="cb18-39"><a href="#cb18-39"></a>theta&lt;-<span class="kw">c</span>(theta1,theta2)</span>
<span id="cb18-40"><a href="#cb18-40"></a>Var&lt;-<span class="kw">c</span>(Var1,Var2)</span>
<span id="cb18-41"><a href="#cb18-41"></a>se&lt;-<span class="kw">c</span>(se1,se2)</span>
<span id="cb18-42"><a href="#cb18-42"></a><span class="kw">print</span>(<span class="kw">rbind</span>(theta,Var,se))</span>
<span id="cb18-43"><a href="#cb18-43"></a><span class="co">#&gt;               [,1]         [,2]</span></span>
<span id="cb18-44"><a href="#cb18-44"></a><span class="co">#&gt; theta 0.5223876943 5.250622e-01</span></span>
<span id="cb18-45"><a href="#cb18-45"></a><span class="co">#&gt; Var   0.0001040151 2.577162e-06</span></span>
<span id="cb18-46"><a href="#cb18-46"></a><span class="co">#&gt; se    0.0101987789 1.605354e-03</span></span>
<span id="cb18-47"><a href="#cb18-47"></a><span class="kw">print</span>(rv)</span>
<span id="cb18-48"><a href="#cb18-48"></a><span class="co">#&gt; [1] 0.9752232</span></span></code></pre></div>
<p>The number of times to repeat the estimation is 50. From the results, the stratified importance sampling estimate is 0.5223877. <span class="math inline">\(SE\)</span> is the sample standard error of <span class="math inline">\(\hat\theta_1,\cdots,\hat\theta_m\)</span>. <span class="math inline">\(SE\)</span> in the stratified importance sampling method is 0.0101988 and <span class="math inline">\(SE\)</span> in the importance sampling method is 0.0016054. Compared with the importance sampling estimate, the percent reduction in variance is 97.5223187%.</p>
<ul>
<li><p><strong>6.4</strong></p>
<p><strong>Basic idea:</strong></p>
<p>The population is known that <span class="math inline">\(lnX\sim N(\mu,\sigma^2)\)</span> and <span class="math inline">\(\mu=E(lnX)\)</span>. The confidence interval for the parameter <span class="math inline">\(\mu\)</span> is: <span class="math display">\[\Big(\overline{lnx}-t_{\frac{\alpha}{2}}(n-1)\cdot\frac{S_{lnx}}{\sqrt{n}},\overline{lnx}+t_{\frac{\alpha}{2}}(n-1)\cdot\frac{S_{lnx}}{\sqrt{n}}\Big)\]</span> where <span class="math inline">\(\overline{lnx}=\frac{1}{n}\sum_{i=1}^n lnX_i\)</span>,<span class="math inline">\(S_{lnx}=\sqrt{\frac{1}{n-1}\sum_{i=1}^n(lnX_i-\overline{lnX})^2}\)</span> and <span class="math inline">\(t_{\frac{\alpha}{2}}(n-1)\)</span> is the upper <span class="math inline">\(\frac{\alpha}{2}\)</span>-quantile of <span class="math inline">\(t\)</span> distribution with <span class="math inline">\(df=n-1\)</span>. Therefore, the empirical estimate of the confidence level is <span class="math display">\[\hat{P}=\frac{1}{m} \sum\limits_{j=1}^m I(\mu\in C_j)\]</span> where <span class="math inline">\(C_j\)</span> is the confidence interval for <span class="math inline">\(\mu\)</span> in the <span class="math inline">\(j^{th}\)</span> MC experiment.</p>
<p><strong>Rcode and results:</strong></p></li>
</ul>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a><span class="kw">set.seed</span>(<span class="dv">676</span>)</span>
<span id="cb19-2"><a href="#cb19-2"></a><span class="co">## confidence interval for mu</span></span>
<span id="cb19-3"><a href="#cb19-3"></a><span class="co">#  sample size</span></span>
<span id="cb19-4"><a href="#cb19-4"></a>n&lt;-<span class="dv">50</span></span>
<span id="cb19-5"><a href="#cb19-5"></a><span class="co"># Times to repeat MC experiment</span></span>
<span id="cb19-6"><a href="#cb19-6"></a>Tm&lt;-<span class="dv">100</span></span>
<span id="cb19-7"><a href="#cb19-7"></a><span class="co">#100(1-a)% confidence interval</span></span>
<span id="cb19-8"><a href="#cb19-8"></a>a&lt;-<span class="fl">0.05</span></span>
<span id="cb19-9"><a href="#cb19-9"></a>u&lt;-<span class="dv">5</span></span>
<span id="cb19-10"><a href="#cb19-10"></a>I.ci&lt;-<span class="kw">numeric</span>(Tm)</span>
<span id="cb19-11"><a href="#cb19-11"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>Tm) </span>
<span id="cb19-12"><a href="#cb19-12"></a>{</span>
<span id="cb19-13"><a href="#cb19-13"></a>  <span class="co">#random sample</span></span>
<span id="cb19-14"><a href="#cb19-14"></a>  x&lt;-<span class="kw">rlnorm</span>(n,u,<span class="dv">1</span>)</span>
<span id="cb19-15"><a href="#cb19-15"></a>  <span class="co">#the confidence interval</span></span>
<span id="cb19-16"><a href="#cb19-16"></a>  CI&lt;-<span class="kw">c</span>(<span class="kw">qt</span>(a<span class="op">/</span><span class="dv">2</span>,n<span class="dv">-1</span>)<span class="op">*</span><span class="kw">sd</span>(<span class="kw">log</span>(x))<span class="op">/</span><span class="kw">sqrt</span>(n),<span class="op">-</span><span class="kw">qt</span>(a<span class="op">/</span><span class="dv">2</span>,n<span class="dv">-1</span>)<span class="op">*</span><span class="kw">sd</span>(<span class="kw">log</span>(x))<span class="op">/</span><span class="kw">sqrt</span>(n))<span class="op">+</span><span class="kw">mean</span>(<span class="kw">log</span>(x))</span>
<span id="cb19-17"><a href="#cb19-17"></a>  I.ci[i]&lt;-<span class="st"> </span>u<span class="op">&gt;</span>CI[<span class="dv">1</span>]<span class="op">&amp;&amp;</span>u<span class="op">&lt;</span>CI[<span class="dv">2</span>]</span>
<span id="cb19-18"><a href="#cb19-18"></a>}</span>
<span id="cb19-19"><a href="#cb19-19"></a><span class="co">#confidence level</span></span>
<span id="cb19-20"><a href="#cb19-20"></a>p.ci&lt;-<span class="kw">mean</span>(I.ci)</span>
<span id="cb19-21"><a href="#cb19-21"></a><span class="kw">print</span>(p.ci)</span>
<span id="cb19-22"><a href="#cb19-22"></a><span class="co">#&gt; [1] 0.94</span></span></code></pre></div>
<p>The empirical estimate of the confidence level is <span class="math inline">\(\hat{P}=\)</span> 0.94.</p>
<ul>
<li><p><strong>6.5</strong></p>
<p><strong>Basic idea:</strong></p>
<p><strong>(1)t-interval for mean</strong></p>
<p>The t-interval for the mean of a population is: <span class="math display">\[(\bar{x}-t_{\frac{\alpha}{2}}(n-1)\cdot\frac{S}{\sqrt{n}},\bar{x}+t_{\frac{\alpha}{2}}(n-1)\cdot\frac{S}{\sqrt{n}})\]</span> where <span class="math inline">\(S\)</span> is the sample standard deviation,<span class="math inline">\(\bar{x}\)</span> is the mean of sample, <span class="math inline">\(t_{\frac{\alpha}{2}}(n-1)\)</span> is the upper <span class="math inline">\(\frac{\alpha}{2}\)</span>-quantile of <span class="math inline">\(t\)</span> distribution with <span class="math inline">\(df=n-1\)</span>.</p>
<p>The population is known that <span class="math inline">\(X\sim \chi^2(2)\)</span> and <span class="math inline">\(\theta=E(X)=2\)</span>. Therefore, the empirical estimate of the confidence level is <span class="math display">\[\hat{P}=\frac{1}{m} \sum\limits_{j=1}^m I(\hat{\theta}_1^{(j)}&lt;\theta&lt;\hat{\theta}_2^{(j)})\]</span> where <span class="math inline">\((\hat{\theta}_1^{(j)},\hat{\theta}_2^{(j)})\)</span> is the confidence interval <span class="math inline">\(C_j\)</span> for the <span class="math inline">\(j^{th}\)</span> sample.</p>
<p><strong>(2)Confidence interval for variance</strong></p>
<p>The confidence interval for the variance of a population is: <span class="math display">\[(0,\frac{(n-1)S^2}{\chi^2_\alpha})\]</span> where <span class="math inline">\(\chi^2_\alpha\)</span> is the <span class="math inline">\(\alpha\)</span>-quantile of the <span class="math inline">\(\chi^2(n-1)\)</span> distribution.</p>
<p><strong>Rcode and results:</strong></p></li>
</ul>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1"></a><span class="kw">set.seed</span>(<span class="dv">77</span>)</span>
<span id="cb20-2"><a href="#cb20-2"></a><span class="co">## t-interval for mean</span></span>
<span id="cb20-3"><a href="#cb20-3"></a><span class="co"># Required sample size</span></span>
<span id="cb20-4"><a href="#cb20-4"></a>n&lt;-<span class="dv">20</span> </span>
<span id="cb20-5"><a href="#cb20-5"></a><span class="co"># Times to repeat MC experiment</span></span>
<span id="cb20-6"><a href="#cb20-6"></a>Tm&lt;-<span class="dv">100</span></span>
<span id="cb20-7"><a href="#cb20-7"></a><span class="co">#100(1-a)% confidence interval</span></span>
<span id="cb20-8"><a href="#cb20-8"></a>a&lt;-<span class="fl">0.05</span></span>
<span id="cb20-9"><a href="#cb20-9"></a>I1&lt;-<span class="kw">numeric</span>(Tm)</span>
<span id="cb20-10"><a href="#cb20-10"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>Tm) </span>
<span id="cb20-11"><a href="#cb20-11"></a>{</span>
<span id="cb20-12"><a href="#cb20-12"></a>  <span class="co">#random sample</span></span>
<span id="cb20-13"><a href="#cb20-13"></a>  x&lt;-<span class="kw">rchisq</span>(n,<span class="dv">2</span>)</span>
<span id="cb20-14"><a href="#cb20-14"></a>  <span class="co">#the confidence interval</span></span>
<span id="cb20-15"><a href="#cb20-15"></a>  CI&lt;-<span class="kw">c</span>(<span class="kw">qt</span>(a<span class="op">/</span><span class="dv">2</span>,n<span class="dv">-1</span>)<span class="op">*</span><span class="kw">sd</span>(x)<span class="op">/</span><span class="kw">sqrt</span>(n),<span class="op">-</span><span class="kw">qt</span>(a<span class="op">/</span><span class="dv">2</span>,n<span class="dv">-1</span>)<span class="op">*</span><span class="kw">sd</span>(x)<span class="op">/</span><span class="kw">sqrt</span>(n))<span class="op">+</span><span class="kw">mean</span>(x)</span>
<span id="cb20-16"><a href="#cb20-16"></a>  I1[i]&lt;-<span class="st"> </span><span class="dv">2</span><span class="op">&gt;</span>CI[<span class="dv">1</span>]<span class="op">&amp;&amp;</span><span class="dv">2</span><span class="op">&lt;</span>CI[<span class="dv">2</span>]</span>
<span id="cb20-17"><a href="#cb20-17"></a>}</span>
<span id="cb20-18"><a href="#cb20-18"></a><span class="co">#confidence level</span></span>
<span id="cb20-19"><a href="#cb20-19"></a>p1.ci&lt;-<span class="kw">mean</span>(I1)</span>
<span id="cb20-20"><a href="#cb20-20"></a></span>
<span id="cb20-21"><a href="#cb20-21"></a><span class="co">## Confidence interval for  variance in example 6.4</span></span>
<span id="cb20-22"><a href="#cb20-22"></a>I2&lt;-<span class="kw">numeric</span>(Tm)</span>
<span id="cb20-23"><a href="#cb20-23"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>Tm){</span>
<span id="cb20-24"><a href="#cb20-24"></a>  x&lt;-<span class="kw">rnorm</span>(n,<span class="dv">0</span>,<span class="dv">2</span>)</span>
<span id="cb20-25"><a href="#cb20-25"></a>  UCL&lt;-(n<span class="dv">-1</span>)<span class="op">*</span><span class="kw">var</span>(x)<span class="op">/</span><span class="kw">qchisq</span>(a,n<span class="dv">-1</span>)</span>
<span id="cb20-26"><a href="#cb20-26"></a>  I2[i]&lt;-<span class="st"> </span><span class="dv">4</span><span class="op">&lt;</span>UCL</span>
<span id="cb20-27"><a href="#cb20-27"></a>}</span>
<span id="cb20-28"><a href="#cb20-28"></a>p2.ci&lt;-<span class="kw">mean</span>(I2)</span>
<span id="cb20-29"><a href="#cb20-29"></a><span class="kw">cbind</span>(p1.ci,p2.ci)</span>
<span id="cb20-30"><a href="#cb20-30"></a><span class="co">#&gt;      p1.ci p2.ci</span></span>
<span id="cb20-31"><a href="#cb20-31"></a><span class="co">#&gt; [1,]  0.91  0.93</span></span></code></pre></div>
<p><strong>Compare t-interval results with the simulation results in Example 6.4</strong></p>
<p>The estimate of the coverage probability of the t-interval is <span class="math inline">\(\hat{P}=\)</span> 0.91.It is smaller than 0.95.However, the simulation results in Example 6.4 is 0.93,which is approximately equal to 0.95. Hence, t-interval is more robust to departures from normality than the interval for variance.</p>
</div>
</div>
<div id="hw5" class="section level2">
<h2>HW5</h2>
<div id="question5" class="section level3">
<h3>Question5：</h3>
<ul>
<li><strong>Exercise6.7</strong></li>
</ul>
<p>Estimate the power of the skewness test of normality against symmetric Beta<span class="math inline">\((\alpha, \alpha)\)</span> distributions and comment on the results. Are the results different for heavy-tailed symmetric alternatives such as <span class="math inline">\(t(v)\)</span>?</p>
<ul>
<li><strong>Exercise6.8</strong></li>
</ul>
<p>Refer to Example 6.16. Repeat the simulation, but also compute the <span class="math inline">\(F\)</span> test of equal variance, at significance level <span class="math inline">\(\hat \alpha= 0.055\)</span>. Compare the power of the Count Five test and <span class="math inline">\(F\)</span> test for small, medium, and large sample sizes. (Recall that the F test is not applicable for non-normal distributions.)</p>
<ul>
<li><strong>Exercise6.C</strong></li>
</ul>
<p>Repeat Examples 6.8 and 6.10 for Mardia’s multivariate skewness test. Mardia [187] proposed tests of multivariate normality based on multivariate generalizations of skewness and kurtosis. If <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> are iid, the multivariate population skewness <span class="math inline">\(\beta_{1,d}\)</span> is defined by Mardia as <span class="math display">\[\beta_{1,d} = E [(X − \mu)^T Σ^{−1}(Y − \mu)]^3 \]</span> Under normality, <span class="math inline">\(\beta_{1,d} = 0\)</span>. The multivariate skewness statistic is <span class="math display">\[b_{1,d} = \frac{1}{n^2}\sum_{i,j=1}^{n}
((X_i − \bar X )^T \hatΣ^{−1}(X_j − \bar X))^3,\]</span> where <span class="math inline">\(\hat Σ\)</span> is the maximum likelihood estimator of covariance. Large values of <span class="math inline">\(b_{1,d}\)</span> are significant. The asymptotic distribution of <span class="math inline">\(nb_{1,d}/6\)</span> is chisquared with <span class="math inline">\(d(d + 1)(d + 2)/6\)</span> degrees of freedom.</p>
<ul>
<li><strong>Discussion</strong></li>
</ul>
<p>If we obtain the powers for two methods under a particular simulation setting with 10,000 experiments: say, 0.651 for one method and 0.676 for another method. Can we say the powers are different at 0.05 level?</p>
<p><strong>(1)</strong>What is the corresponding hypothesis test problem?</p>
<p><strong>(2)</strong>What test should we use? Z-test, two-sample t-test, paired-t test or McNemar test?</p>
<p><strong>(3)</strong>What information is needed to test your hypothesis?</p>
</div>
<div id="answer5" class="section level3">
<h3>Answer5：</h3>
<ul>
<li><p><strong>6.7</strong></p>
<p><strong>Basic idea:</strong></p>
<p><strong>The skewness test of normality</strong></p>
<p>The skewness <span class="math inline">\(\sqrt{\beta_1}\)</span> of a random variable X is <span class="math display">\[\sqrt{\beta_1} = \frac{E[(X − \mu_X)]^3}{\sigma^3_X} .\]</span> And the hypotheses are <span class="math display">\[H_0 :\sqrt{\beta_1} = 0;\qquad H_1 :\sqrt{\beta_1} \neq 0\]</span> Under <span class="math inline">\(H_0\)</span>, the sample coefficient of skewness <span class="math display">\[\sqrt{b_1} \stackrel{d}\rightarrow N(0,6/n),\]</span> Thus, reject <span class="math inline">\(H_0\)</span> at <span class="math inline">\(\alpha\)</span> if <span class="math display">\[|\sqrt{b_1}|&gt;z_{\alpha/2}(0,6/n)\]</span> where <span class="math inline">\(z_{\alpha/2}(0,6/n)\)</span> represents the upper <span class="math inline">\(\alpha/2\)</span> quantile for <span class="math inline">\(N(0,6/n)\)</span>.Then the power of the test <span class="math inline">\(P(p\le\alpha|H_1)\)</span> is estimated by Monte Carlo experiment.</p>
<p><strong>Rcode and results:</strong></p></li>
</ul>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1"></a><span class="co">## Generate sample from Beta and t</span></span>
<span id="cb21-2"><a href="#cb21-2"></a><span class="co"># Sample size</span></span>
<span id="cb21-3"><a href="#cb21-3"></a><span class="kw">set.seed</span>(<span class="dv">18</span>)</span>
<span id="cb21-4"><a href="#cb21-4"></a>n&lt;-<span class="dv">100</span> </span>
<span id="cb21-5"><a href="#cb21-5"></a><span class="co"># replication</span></span>
<span id="cb21-6"><a href="#cb21-6"></a>m&lt;-<span class="dv">100</span>  </span>
<span id="cb21-7"><a href="#cb21-7"></a><span class="co"># Sample skewness function</span></span>
<span id="cb21-8"><a href="#cb21-8"></a>ssk&lt;-<span class="cf">function</span>(x){</span>
<span id="cb21-9"><a href="#cb21-9"></a>  q3&lt;-<span class="kw">mean</span>((x<span class="op">-</span><span class="kw">mean</span>(x))<span class="op">^</span><span class="dv">3</span>)</span>
<span id="cb21-10"><a href="#cb21-10"></a>  q2&lt;-<span class="kw">mean</span>((x<span class="op">-</span><span class="kw">mean</span>(x))<span class="op">^</span><span class="dv">2</span>)</span>
<span id="cb21-11"><a href="#cb21-11"></a>  y&lt;-q3<span class="op">/</span>q2<span class="op">^</span><span class="fl">1.5</span></span>
<span id="cb21-12"><a href="#cb21-12"></a>  <span class="kw">return</span>(y)</span>
<span id="cb21-13"><a href="#cb21-13"></a>}</span>
<span id="cb21-14"><a href="#cb21-14"></a><span class="co">#parameters</span></span>
<span id="cb21-15"><a href="#cb21-15"></a>theta&lt;-<span class="kw">c</span>(<span class="kw">seq</span>(<span class="dv">1</span>,<span class="dv">10</span>,<span class="fl">0.5</span>)) </span>
<span id="cb21-16"><a href="#cb21-16"></a>N &lt;-<span class="st"> </span><span class="kw">length</span>(theta)</span>
<span id="cb21-17"><a href="#cb21-17"></a>power1&lt;-power2&lt;-<span class="kw">numeric</span>(N)</span>
<span id="cb21-18"><a href="#cb21-18"></a><span class="co">#the quantile</span></span>
<span id="cb21-19"><a href="#cb21-19"></a>z&lt;-<span class="kw">qnorm</span>(<span class="fl">0.975</span>,<span class="dv">0</span>,<span class="kw">sqrt</span>(<span class="dv">6</span><span class="op">/</span>n))</span>
<span id="cb21-20"><a href="#cb21-20"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N)</span>
<span id="cb21-21"><a href="#cb21-21"></a>{<span class="co">#theta</span></span>
<span id="cb21-22"><a href="#cb21-22"></a>  I1&lt;-I2&lt;-<span class="kw">numeric</span>(m)</span>
<span id="cb21-23"><a href="#cb21-23"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m)</span>
<span id="cb21-24"><a href="#cb21-24"></a>  {<span class="co">#replicate experiment</span></span>
<span id="cb21-25"><a href="#cb21-25"></a>    x1&lt;-<span class="kw">rbeta</span>(n,theta[i],theta[i])</span>
<span id="cb21-26"><a href="#cb21-26"></a>    x2&lt;-<span class="kw">rt</span>(n,theta[i])</span>
<span id="cb21-27"><a href="#cb21-27"></a>    ske1&lt;-<span class="kw">ssk</span>(x1)</span>
<span id="cb21-28"><a href="#cb21-28"></a>    ske2&lt;-<span class="kw">ssk</span>(x2)</span>
<span id="cb21-29"><a href="#cb21-29"></a>    I1[j]&lt;-<span class="st"> </span><span class="kw">as.integer</span>(<span class="kw">abs</span>(ske1)<span class="op">&gt;=</span>z)</span>
<span id="cb21-30"><a href="#cb21-30"></a>    I2[j]&lt;-<span class="kw">as.integer</span>(<span class="kw">abs</span>(ske2)<span class="op">&gt;=</span>z)</span>
<span id="cb21-31"><a href="#cb21-31"></a>  }</span>
<span id="cb21-32"><a href="#cb21-32"></a>  power1[i]&lt;-<span class="kw">mean</span>(I1)</span>
<span id="cb21-33"><a href="#cb21-33"></a>  power2[i]&lt;-<span class="kw">mean</span>(I2)</span>
<span id="cb21-34"><a href="#cb21-34"></a>}</span>
<span id="cb21-35"><a href="#cb21-35"></a>se1 &lt;-<span class="st"> </span><span class="kw">sqrt</span>(power1<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>power1)<span class="op">/</span>m)</span>
<span id="cb21-36"><a href="#cb21-36"></a>se2 &lt;-<span class="st"> </span><span class="kw">sqrt</span>(power2<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>power2)<span class="op">/</span>m)</span>
<span id="cb21-37"><a href="#cb21-37"></a><span class="co"># power curve</span></span>
<span id="cb21-38"><a href="#cb21-38"></a><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb21-39"><a href="#cb21-39"></a><span class="kw">plot</span>(theta,power1,<span class="dt">xlab=</span><span class="st">&quot;α&quot;</span>,<span class="dt">ylab=</span><span class="st">&quot;power1&quot;</span>,<span class="dt">lwd=</span><span class="dv">2</span>,<span class="dt">col=</span><span class="st">&quot;blue&quot;</span>,<span class="dt">main=</span><span class="st">&quot;Beta(α,α)&quot;</span>,<span class="dt">type=</span><span class="st">&quot;l&quot;</span>)</span>
<span id="cb21-40"><a href="#cb21-40"></a><span class="kw">lines</span>(theta, power1<span class="op">+</span>se1, <span class="dt">lty =</span> <span class="dv">4</span>)</span>
<span id="cb21-41"><a href="#cb21-41"></a><span class="kw">lines</span>(theta, power1<span class="op">-</span>se1, <span class="dt">lty =</span> <span class="dv">4</span>)</span>
<span id="cb21-42"><a href="#cb21-42"></a><span class="kw">plot</span>(theta,power2,<span class="dt">xlab=</span><span class="st">&quot;ν&quot;</span>,<span class="dt">ylab=</span><span class="st">&quot;power2&quot;</span>,<span class="dt">lwd=</span><span class="dv">2</span>,<span class="dt">col=</span><span class="st">&quot;blue&quot;</span>,<span class="dt">main=</span><span class="st">&quot;t(ν)&quot;</span>,<span class="dt">type=</span><span class="st">&quot;l&quot;</span>)</span>
<span id="cb21-43"><a href="#cb21-43"></a><span class="kw">lines</span>(theta, power2<span class="op">+</span>se2, <span class="dt">lty =</span> <span class="dv">3</span>)</span>
<span id="cb21-44"><a href="#cb21-44"></a><span class="kw">lines</span>(theta, power2<span class="op">-</span>se2, <span class="dt">lty =</span> <span class="dv">3</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>The empirical power curves are shown in the figures above.From the first figure, the empirical power of the test against symmetric Beta<span class="math inline">\((α,α)\)</span> distributions increases with the rise of parameter <span class="math inline">\(\alpha\)</span> approximately.Compare the results,they are different for heavy-tailed symmetric alternatives such as <span class="math inline">\(t(v)\)</span>.</p>
<ul>
<li><p><strong>6.8</strong></p>
<p><strong>Basic idea:</strong></p>
<p>The sampled distributions are <span class="math inline">\(N(\mu_1 = 0, \sigma^2_1 = 1), N(\mu_2 = 0,\sigma_2^2=1.5^2)\)</span> and the sample sizes are <span class="math inline">\(n_1,n_2\)</span>.Consider significance test problem: <span class="math display">\[H_0:\sigma_1^2=\sigma_2^2,\qquad H_1:\sigma_1^2\ne\sigma_2^2 \]</span> The Count Five statistic is the maximum number of extreme points. The <span class="math inline">\(F\)</span> statistic is <span class="math display">\[F=\frac{s_2^2}{s_1^2}\sim F(n_2-1,n_1-1)\]</span> If <span class="math inline">\(F&gt;F_{1-\alpha}(n_2-1,n_1-2)\)</span>,reject <span class="math inline">\(H_0\)</span>.</p>
<p><strong>Rcode and result:</strong></p></li>
</ul>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1"></a><span class="co">#small,medium and large sample</span></span>
<span id="cb22-2"><a href="#cb22-2"></a><span class="kw">set.seed</span>(<span class="dv">77</span>)</span>
<span id="cb22-3"><a href="#cb22-3"></a>size&lt;-<span class="kw">c</span>(<span class="dv">10</span>,<span class="dv">100</span>,<span class="dv">1000</span>)</span>
<span id="cb22-4"><a href="#cb22-4"></a>N&lt;-<span class="kw">length</span>(size)</span>
<span id="cb22-5"><a href="#cb22-5"></a>m&lt;-<span class="dv">100</span></span>
<span id="cb22-6"><a href="#cb22-6"></a><span class="co">#parameters</span></span>
<span id="cb22-7"><a href="#cb22-7"></a>sigma1 &lt;-<span class="st"> </span><span class="dv">1</span></span>
<span id="cb22-8"><a href="#cb22-8"></a>sigma2 &lt;-<span class="st"> </span><span class="fl">1.5</span></span>
<span id="cb22-9"><a href="#cb22-9"></a><span class="co">#the quantile</span></span>
<span id="cb22-10"><a href="#cb22-10"></a>a&lt;-<span class="fl">0.055</span></span>
<span id="cb22-11"><a href="#cb22-11"></a>CFtest &lt;-<span class="st"> </span><span class="cf">function</span>(x, y) {</span>
<span id="cb22-12"><a href="#cb22-12"></a>  X &lt;-<span class="st"> </span>x <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(x)</span>
<span id="cb22-13"><a href="#cb22-13"></a>  Y &lt;-<span class="st"> </span>y <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(y)</span>
<span id="cb22-14"><a href="#cb22-14"></a>  outx &lt;-<span class="st"> </span><span class="kw">sum</span>(X <span class="op">&lt;</span><span class="st"> </span><span class="kw">min</span>(Y))<span class="op">+</span><span class="kw">sum</span>(X <span class="op">&gt;</span><span class="st"> </span><span class="kw">max</span>(Y))</span>
<span id="cb22-15"><a href="#cb22-15"></a>  outy &lt;-<span class="st"> </span><span class="kw">sum</span>(Y <span class="op">&lt;</span><span class="st"> </span><span class="kw">min</span>(X))<span class="op">+</span><span class="kw">sum</span>(Y <span class="op">&gt;</span><span class="st"> </span><span class="kw">max</span>(X))</span>
<span id="cb22-16"><a href="#cb22-16"></a>  I&lt;-<span class="kw">as.integer</span>(<span class="kw">max</span>(<span class="kw">c</span>(outx, outy)) <span class="op">&gt;</span><span class="st"> </span><span class="dv">5</span>)</span>
<span id="cb22-17"><a href="#cb22-17"></a>  <span class="kw">return</span>(I)</span>
<span id="cb22-18"><a href="#cb22-18"></a>}</span>
<span id="cb22-19"><a href="#cb22-19"></a>power1&lt;-power2&lt;-<span class="kw">numeric</span>(N)</span>
<span id="cb22-20"><a href="#cb22-20"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N)</span>
<span id="cb22-21"><a href="#cb22-21"></a>{ </span>
<span id="cb22-22"><a href="#cb22-22"></a>  I1&lt;-I2&lt;-<span class="kw">numeric</span>(m)</span>
<span id="cb22-23"><a href="#cb22-23"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m)</span>
<span id="cb22-24"><a href="#cb22-24"></a>  {</span>
<span id="cb22-25"><a href="#cb22-25"></a>   x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(size[i], <span class="dv">0</span>, sigma1)</span>
<span id="cb22-26"><a href="#cb22-26"></a>   y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(size[i], <span class="dv">0</span>, sigma2)</span>
<span id="cb22-27"><a href="#cb22-27"></a>   F.test&lt;-<span class="kw">var.test</span>(x,y)<span class="op">$</span>p.value</span>
<span id="cb22-28"><a href="#cb22-28"></a>   I1[j]&lt;-<span class="kw">CFtest</span>(x, y)</span>
<span id="cb22-29"><a href="#cb22-29"></a>   I2[j]&lt;-<span class="kw">as.integer</span>(F.test<span class="op">&lt;=</span>a)</span>
<span id="cb22-30"><a href="#cb22-30"></a>  }</span>
<span id="cb22-31"><a href="#cb22-31"></a>  power1[i]&lt;-<span class="kw">mean</span>(I1)</span>
<span id="cb22-32"><a href="#cb22-32"></a>  power2[i]&lt;-<span class="kw">mean</span>(I2)  </span>
<span id="cb22-33"><a href="#cb22-33"></a>} </span>
<span id="cb22-34"><a href="#cb22-34"></a><span class="kw">print</span>(<span class="kw">rbind</span>(power1,power2))</span>
<span id="cb22-35"><a href="#cb22-35"></a><span class="co">#&gt;        [,1] [,2] [,3]</span></span>
<span id="cb22-36"><a href="#cb22-36"></a><span class="co">#&gt; power1 0.12 0.81 0.99</span></span>
<span id="cb22-37"><a href="#cb22-37"></a><span class="co">#&gt; power2 0.25 0.96 1.00</span></span></code></pre></div>
<p>From the results, the empirical power of the <span class="math inline">\(F\)</span> test is greater than the power of the Count Five test when the sample size is <span class="math inline">\(n = 10,100,1000\)</span>.In addition, the power of the Count Five test and F test increase with the rise of the sample size <span class="math inline">\(n\)</span> approximately.</p>
<ul>
<li><p><strong>6.C</strong></p>
<p><strong>Basic idea(Example 6.8):</strong></p>
<p>The multivariate population skewness is <span class="math display">\[\beta_{1,d} = E [(X − \mu)^T Σ^{−1}(Y − \mu)]^3 ,\]</span> and the hypotheses are <span class="math display">\[H_0 :\beta_{1,d} = 0;\qquad H_1 :\beta_{1,d} \neq 0\]</span> Under<span class="math inline">\(H_0\)</span>, the multivariate skewness statistic is <span class="math display">\[b_{1,d} = \frac{1}{n^2}\sum_{i,j=1}^{n}
((X_i − \bar X )^T \hatΣ^{−1}(X_j − \bar X))^3\\
nb_{1,d}/6\sim\chi^2(v),\quad v=\frac{d(d+1)(d+2)}{6}\]</span> If <span class="math inline">\(nb_{1,d}/6&gt;\chi^2_{1-\alpha}\)</span>, reject <span class="math inline">\(H_0\)</span>.The sampled distribution here is <span class="math inline">\(X=[X_1,X_2]^T\sim N(0,\Sigma)\)</span>,where <span class="math inline">\(\Sigma=I_2\)</span></p>
<p><strong>Rcode and result:</strong></p></li>
</ul>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1"></a><span class="kw">set.seed</span>(<span class="dv">777</span>)</span>
<span id="cb23-2"><a href="#cb23-2"></a><span class="kw">library</span>(MASS)</span>
<span id="cb23-3"><a href="#cb23-3"></a><span class="co">#&gt; </span></span>
<span id="cb23-4"><a href="#cb23-4"></a><span class="co">#&gt; 载入程辑包：&#39;MASS&#39;</span></span>
<span id="cb23-5"><a href="#cb23-5"></a><span class="co">#&gt; The following object is masked from &#39;package:DAAG&#39;:</span></span>
<span id="cb23-6"><a href="#cb23-6"></a><span class="co">#&gt; </span></span>
<span id="cb23-7"><a href="#cb23-7"></a><span class="co">#&gt;     hills</span></span>
<span id="cb23-8"><a href="#cb23-8"></a>size &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">10</span>, <span class="dv">20</span>, <span class="dv">30</span>, <span class="dv">50</span>, <span class="dv">100</span>,<span class="dv">500</span>)</span>
<span id="cb23-9"><a href="#cb23-9"></a>N &lt;-<span class="st"> </span><span class="kw">length</span>(size)</span>
<span id="cb23-10"><a href="#cb23-10"></a>m &lt;-<span class="st"> </span><span class="dv">200</span></span>
<span id="cb23-11"><a href="#cb23-11"></a><span class="co"># Sample multivariate  skewness function</span></span>
<span id="cb23-12"><a href="#cb23-12"></a>smsk &lt;-<span class="st"> </span><span class="cf">function</span>(x) {</span>
<span id="cb23-13"><a href="#cb23-13"></a>  xbar &lt;-<span class="st"> </span><span class="kw">colMeans</span>(x)</span>
<span id="cb23-14"><a href="#cb23-14"></a>  xcov &lt;-<span class="st"> </span><span class="kw">cov</span>(x)</span>
<span id="cb23-15"><a href="#cb23-15"></a>  n &lt;-<span class="st"> </span><span class="kw">nrow</span>(x)</span>
<span id="cb23-16"><a href="#cb23-16"></a>  xSigma &lt;-<span class="st"> </span>xcov<span class="op">*</span>(n<span class="dv">-1</span>)<span class="op">/</span>n</span>
<span id="cb23-17"><a href="#cb23-17"></a>  m&lt;-<span class="kw">numeric</span>(n)</span>
<span id="cb23-18"><a href="#cb23-18"></a>  b&lt;-<span class="st"> </span><span class="kw">sum</span>(((<span class="kw">t</span>(<span class="kw">t</span>(x)<span class="op">-</span>xbar))<span class="op">%*%</span><span class="kw">solve</span>(xSigma)<span class="op">%*%</span>(<span class="kw">t</span>(x)<span class="op">-</span>xbar))<span class="op">^</span><span class="dv">3</span>)<span class="op">/</span>n<span class="op">^</span><span class="dv">2</span></span>
<span id="cb23-19"><a href="#cb23-19"></a>}</span>
<span id="cb23-20"><a href="#cb23-20"></a><span class="co">#estimates of Type I error rate</span></span>
<span id="cb23-21"><a href="#cb23-21"></a>TIer &lt;-<span class="st"> </span><span class="kw">numeric</span>(N)</span>
<span id="cb23-22"><a href="#cb23-22"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N) </span>
<span id="cb23-23"><a href="#cb23-23"></a>{</span>
<span id="cb23-24"><a href="#cb23-24"></a>  I &lt;-<span class="st"> </span><span class="kw">numeric</span>(m)</span>
<span id="cb23-25"><a href="#cb23-25"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) </span>
<span id="cb23-26"><a href="#cb23-26"></a>  {</span>
<span id="cb23-27"><a href="#cb23-27"></a>    x &lt;-<span class="st"> </span><span class="kw">mvrnorm</span>(size[i], <span class="kw">rep</span>(<span class="dv">0</span>, <span class="dv">2</span>), <span class="kw">diag</span>(<span class="dv">2</span>))</span>
<span id="cb23-28"><a href="#cb23-28"></a>    <span class="co">#test reject or not reject</span></span>
<span id="cb23-29"><a href="#cb23-29"></a>    I[j] &lt;-<span class="st"> </span><span class="kw">as.integer</span>(size[i]<span class="op">*</span><span class="kw">abs</span>(<span class="kw">smsk</span>(x))<span class="op">/</span><span class="dv">6</span> <span class="op">&gt;=</span><span class="st"> </span><span class="kw">qchisq</span>(<span class="fl">0.95</span>,<span class="dv">4</span>))</span>
<span id="cb23-30"><a href="#cb23-30"></a>  }</span>
<span id="cb23-31"><a href="#cb23-31"></a>  TIer[i] &lt;-<span class="st"> </span><span class="kw">mean</span>(I) </span>
<span id="cb23-32"><a href="#cb23-32"></a>}</span>
<span id="cb23-33"><a href="#cb23-33"></a><span class="kw">print</span>(TIer)</span>
<span id="cb23-34"><a href="#cb23-34"></a><span class="co">#&gt; [1] 0.000 0.010 0.030 0.070 0.035 0.055</span></span>
<span id="cb23-35"><a href="#cb23-35"></a><span class="kw">plot</span>(size,TIer,<span class="dt">xlab=</span><span class="st">&quot;size&quot;</span>,<span class="dt">ylab=</span><span class="st">&quot;power&quot;</span>,<span class="dt">lwd=</span><span class="dv">2</span>,<span class="dt">col=</span><span class="st">&quot;black&quot;</span>,<span class="dt">type=</span><span class="st">&quot;l&quot;</span>)</span>
<span id="cb23-36"><a href="#cb23-36"></a><span class="kw">points</span>(size,TIer,<span class="dt">type=</span><span class="st">&quot;b&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p><strong>Basic idea(Example 6.10):</strong></p>
<p>The contaminated multivariate normal distribution is denoted by<br />
<span class="math display">\[(1 − \epsilon)N(µ = 0, \Sigma = I_d) + \epsilon N(µ = 0, \Sigma = 100I_d),\qquad 0 ≤ \epsilon ≤ 1.\]</span></p>
<p><strong>Rcode and result:</strong></p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1"></a><span class="kw">set.seed</span>(<span class="dv">21</span>)</span>
<span id="cb24-2"><a href="#cb24-2"></a><span class="kw">library</span>(MASS)</span>
<span id="cb24-3"><a href="#cb24-3"></a>n &lt;-<span class="st"> </span><span class="dv">20</span></span>
<span id="cb24-4"><a href="#cb24-4"></a>m &lt;-<span class="st"> </span><span class="dv">100</span></span>
<span id="cb24-5"><a href="#cb24-5"></a>e &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">seq</span>(<span class="dv">0</span>, <span class="fl">.2</span>, <span class="fl">.02</span>), <span class="kw">seq</span>(.<span class="dv">2</span>, <span class="dv">1</span>, <span class="fl">.1</span>))</span>
<span id="cb24-6"><a href="#cb24-6"></a>N &lt;-<span class="st"> </span><span class="kw">length</span>(e)</span>
<span id="cb24-7"><a href="#cb24-7"></a>smsk &lt;-<span class="st"> </span><span class="cf">function</span>(x) {</span>
<span id="cb24-8"><a href="#cb24-8"></a>  xbar &lt;-<span class="st"> </span><span class="kw">colMeans</span>(x)</span>
<span id="cb24-9"><a href="#cb24-9"></a>  xcov &lt;-<span class="st"> </span><span class="kw">cov</span>(x)</span>
<span id="cb24-10"><a href="#cb24-10"></a>  n &lt;-<span class="st"> </span><span class="kw">nrow</span>(x)</span>
<span id="cb24-11"><a href="#cb24-11"></a>  xSigma &lt;-<span class="st"> </span>xcov<span class="op">*</span>(n<span class="dv">-1</span>)<span class="op">/</span>n</span>
<span id="cb24-12"><a href="#cb24-12"></a>  m&lt;-<span class="kw">numeric</span>(n)</span>
<span id="cb24-13"><a href="#cb24-13"></a>  b&lt;-<span class="st"> </span><span class="kw">sum</span>(((<span class="kw">t</span>(<span class="kw">t</span>(x)<span class="op">-</span>xbar))<span class="op">%*%</span><span class="kw">solve</span>(xSigma)<span class="op">%*%</span>(<span class="kw">t</span>(x)<span class="op">-</span>xbar))<span class="op">^</span><span class="dv">3</span>)<span class="op">/</span>n<span class="op">^</span><span class="dv">2</span></span>
<span id="cb24-14"><a href="#cb24-14"></a>}</span>
<span id="cb24-15"><a href="#cb24-15"></a>power &lt;-<span class="st"> </span><span class="kw">numeric</span>(N)</span>
<span id="cb24-16"><a href="#cb24-16"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N) </span>
<span id="cb24-17"><a href="#cb24-17"></a>{<span class="co">#epsilon</span></span>
<span id="cb24-18"><a href="#cb24-18"></a>  I1 &lt;-<span class="st"> </span><span class="kw">numeric</span>(m)</span>
<span id="cb24-19"><a href="#cb24-19"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) </span>
<span id="cb24-20"><a href="#cb24-20"></a>  {<span class="co">#replicate experiment</span></span>
<span id="cb24-21"><a href="#cb24-21"></a>   c&lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">100</span>), <span class="dt">replace =</span> <span class="ot">TRUE</span>,<span class="dt">size =</span> n, <span class="dt">prob =</span> <span class="kw">c</span>(<span class="dv">1</span><span class="op">-</span>e[i], e[i]))</span>
<span id="cb24-22"><a href="#cb24-22"></a>   x&lt;-<span class="kw">matrix</span>(<span class="dt">nr=</span>n,<span class="dt">nc=</span><span class="dv">2</span>) </span>
<span id="cb24-23"><a href="#cb24-23"></a>     <span class="cf">for</span>(s <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n)</span>
<span id="cb24-24"><a href="#cb24-24"></a>     {x[s,] &lt;-<span class="st"> </span><span class="kw">mvrnorm</span>(<span class="dv">1</span>, <span class="kw">rep</span>(<span class="dv">0</span>, <span class="dv">2</span>), c[s]<span class="op">*</span><span class="kw">diag</span>(<span class="dv">2</span>))}</span>
<span id="cb24-25"><a href="#cb24-25"></a>   I1[j] &lt;-<span class="st"> </span><span class="kw">as.integer</span>(n<span class="op">*</span><span class="kw">abs</span>(<span class="kw">smsk</span>(x))<span class="op">/</span><span class="dv">6</span> <span class="op">&gt;=</span><span class="st"> </span><span class="kw">qchisq</span>(<span class="fl">0.9</span>,<span class="dv">4</span>))</span>
<span id="cb24-26"><a href="#cb24-26"></a>  }</span>
<span id="cb24-27"><a href="#cb24-27"></a>  power[i] &lt;-<span class="st"> </span><span class="kw">mean</span>(I1)</span>
<span id="cb24-28"><a href="#cb24-28"></a>}</span>
<span id="cb24-29"><a href="#cb24-29"></a><span class="co">#plot power against ε-contaminated multivariate normal</span></span>
<span id="cb24-30"><a href="#cb24-30"></a><span class="kw">plot</span>(e,power,<span class="dt">xlab=</span><span class="st">&quot;ε&quot;</span>,<span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="dt">ylab=</span><span class="st">&quot;power&quot;</span>,<span class="dt">lwd=</span><span class="dv">2</span>,<span class="dt">col=</span><span class="st">&quot;blue&quot;</span>,<span class="dt">type=</span><span class="st">&quot;l&quot;</span>)</span>
<span id="cb24-31"><a href="#cb24-31"></a>se &lt;-<span class="st"> </span><span class="kw">sqrt</span>(power <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span><span class="op">-</span>power) <span class="op">/</span><span class="st"> </span>m) <span class="co">#add standard errors</span></span>
<span id="cb24-32"><a href="#cb24-32"></a><span class="kw">lines</span>(e, power<span class="op">+</span>se, <span class="dt">lty =</span> <span class="dv">4</span>)</span>
<span id="cb24-33"><a href="#cb24-33"></a><span class="kw">lines</span>(e, power<span class="op">-</span>se, <span class="dt">lty =</span> <span class="dv">4</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>The empirical power curve is shown in figure above. Note that the power curve crosses the horizontal line corresponding to α = 0.10 at both endpoints, ε = 0 and ε = 1 where the alternative is normally distributed. For 0 &lt;ε&lt; 1 the empirical power of the test is greater than 0.10 and highest when ε is about 0.15.</p>
<ul>
<li><p><strong>Discussion</strong></p>
<p><strong>(1)</strong>Consider significance test problem: <span class="math display">\[H_0^\diamond:\theta=\theta_0,\qquad H_a^\diamond:\theta\ne\theta_0. \qquad(1)\]</span> The definition of power is <span class="math display">\[P(p\le \alpha|H_a)\]</span> Now we obtain the powers for two methods <span class="math inline">\(P(p_1\le \alpha|H_a^\diamond),P(p_2\le \alpha|H_a^\diamond)\)</span>,where <span class="math inline">\(p_1,p_2\)</span> denote the p-value in the two methods respectively. Our task is to test if the two powers are equal at <span class="math inline">\(\alpha\)</span>.Thus, the corresponding hypothesis test problem is <span class="math display">\[H_0:P(p_1\le \alpha|H_a^\diamond)=P(p_2\le \alpha|H_a^\diamond),\qquad H_1:P(p_1\le \alpha|H_a^\diamond)\ne P(p_2\le \alpha|H_a^\diamond).\qquad(2)\]</span> where <span class="math display">\[P(p_1\le \alpha|H_a^\diamond)=E(I(p_1\le \alpha|H_a^\diamond))\\
P(p_2\le \alpha|H_a^\diamond)=E(I(p_2\le \alpha|H_a^\diamond)).\]</span> Note that <span class="math inline">\(I(p_1\le \alpha|H_a^\diamond)\sim B(1,P(p_1\le \alpha|H_a^\diamond)),I(p_2\le \alpha|H_a^\diamond)\sim B(1,P(p_2\le \alpha|H_a^\diamond))\)</span>.Then,let X be <span class="math inline">\(I(p_1\le \alpha|H_a^\diamond)\)</span>,Y be <span class="math inline">\(I(p_2\le \alpha|H_a^\diamond)\)</span>, and their distributions are <span class="math display">\[X\sim B(1,\mu_1),Y\sim B(1,\mu_2)\qquad (3)\]</span> where <span class="math inline">\(\mu_1=P(p_1\le \alpha|H_a^\diamond),\mu_2=P(p_2\le \alpha|H_a^\diamond).\)</span> Therefore,the hypothesis test problem above is equivalent to <span class="math display">\[H_0:\mu_1=\mu_2,\qquad H_1:\mu_1\ne\mu_2.\]</span></p>
<p><strong>(2)</strong>Since the samples <span class="math inline">\(X_i\sim B(1,\mu_1),Y_i\sim B(1,\mu_2),i=1,\cdots,m\)</span> are dependent.Thus, all the tests can be used except two-sample t-test.</p>
<p><strong>(3)</strong> For the hypothesis(3), the information <span class="math inline">\(m,\bar X,\bar Y,S_{\bar X-\bar Y}\)</span> is needed,where m is the number of times the experiment is repeated <span class="math display">\[\begin{aligned}
\bar X&amp;=\frac{1}{m}\sum_{i=1}^mI(p_{1}^{i}\le \alpha|H_a^\diamond)=\hat P(p_1\le \alpha|H_a^\diamond) \\
\bar Y&amp;=\frac{1}{m}\sum_{i=1}^mI(p_{2}^{i}\le \alpha|H_a^\diamond)=\hat P(p_2\le \alpha|H_a^\diamond)\\
S_{\bar X-\bar Y}^2&amp;=\frac{1}{m}S_{X-Y}^2=\frac{1}{m(m-1)}\sum_{i=1}^{m}(X_i-Y_i)^2
\end{aligned}\]</span> For example, in the dependent <span class="math inline">\(t\)</span>-test for paired samples,under <span class="math inline">\(H_0\)</span>, the t-test statistic is <span class="math display">\[T=\frac{\bar d}{S_\bar d}=\frac{\bar X-\bar Y}{S_{\bar X-\bar Y}}\\
T\sim t(v),\quad v=m-1\]</span> If <span class="math inline">\(|T|&gt;t_{\alpha_1/2}\)</span>,reject <span class="math inline">\(H_0\)</span>.In this discussion,we have <span class="math inline">\(m=10000,\bar X=0.651,\bar Y=0.676\)</span>.</p></li>
</ul>
</div>
</div>
<div id="hw6" class="section level2">
<h2>HW6</h2>
<div id="question6" class="section level3">
<h3>Question6：</h3>
<ul>
<li><p><strong>Exercise7.1</strong></p>
<p>Compute a jackknife estimate of the bias and the standard error of the correlation statistic in Example 7.2.</p></li>
<li><p><strong>Exercise7.5</strong></p>
<p>Refer to Exercise 7.4. Compute 95% bootstrap confidence intervals for the mean time between failures <span class="math inline">\(1/λ\)</span> by the standard normal, basic, percentile, and BCa methods. Compare the intervals and explain why they may differ.</p></li>
<li><p><strong>Exercise7.8</strong></p>
<p>Refer to Exercise 7.7. Obtain the jackknife estimates of bias and standard error of <span class="math inline">\(\hatθ\)</span>.</p></li>
<li><p><strong>Exercise7.11</strong></p>
<p>In Example 7.18, leave-one-out (n-fold) cross validation was used to select the best fitting model. Use leave-two-out cross validation to compare the models.</p></li>
</ul>
</div>
<div id="answer6" class="section level3">
<h3>Answer6：</h3>
<ul>
<li><p><strong>7.1</strong></p>
<p><strong>The jackknife estimate of bias</strong> <span class="math display">\[\widehat{bias}_{jack}=(n-1)(\overline{\hat{\theta}_{(\cdot)}}-\hat\theta)\]</span> where <span class="math inline">\(\overline{\hat{\theta}_{(\cdot)}}=\frac{1}{n}\sum_{i=1}^{n}\hat\theta_{(i)}\)</span></p>
<p><strong>The jackknife estimate of standard error</strong></p>
<p><span class="math display">\[\hat{se}=\sqrt{\frac{n-1}{n}\sum_{i=1}^{n}\Big(\hat\theta_{(i)}-\overline{\hat{\theta}_{(\cdot)}}\Big)^2}\]</span></p>
<p><strong>Rcode and results:</strong></p></li>
</ul>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1"></a><span class="kw">library</span>(bootstrap)</span>
<span id="cb25-2"><a href="#cb25-2"></a><span class="kw">data</span>(<span class="st">&quot;law&quot;</span>)</span>
<span id="cb25-3"><a href="#cb25-3"></a>law&lt;-<span class="kw">as.matrix</span>(law)</span>
<span id="cb25-4"><a href="#cb25-4"></a>law82&lt;-<span class="kw">as.matrix</span>(law82)</span>
<span id="cb25-5"><a href="#cb25-5"></a>law82&lt;-law82[,<span class="dv">2</span><span class="op">:</span><span class="dv">3</span>]</span>
<span id="cb25-6"><a href="#cb25-6"></a>R.hat&lt;-<span class="kw">cor</span>(law[,<span class="dv">1</span>],law[,<span class="dv">2</span>])</span>
<span id="cb25-7"><a href="#cb25-7"></a><span class="co">#bias Jackknife</span></span>
<span id="cb25-8"><a href="#cb25-8"></a>n&lt;-<span class="kw">nrow</span>(law)</span>
<span id="cb25-9"><a href="#cb25-9"></a>R.jack&lt;-<span class="kw">numeric</span>(n)</span>
<span id="cb25-10"><a href="#cb25-10"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n)</span>
<span id="cb25-11"><a href="#cb25-11"></a>{R.jack[i]&lt;-<span class="kw">cor</span>(law[<span class="op">-</span>i,<span class="dv">1</span>],law[<span class="op">-</span>i,<span class="dv">2</span>])}</span>
<span id="cb25-12"><a href="#cb25-12"></a><span class="co">#estimate of bias</span></span>
<span id="cb25-13"><a href="#cb25-13"></a>ebias.jack&lt;-(n<span class="dv">-1</span>)<span class="op">*</span>(<span class="kw">mean</span>(R.jack)<span class="op">-</span>R.hat)</span>
<span id="cb25-14"><a href="#cb25-14"></a><span class="co">#standard error jackknife</span></span>
<span id="cb25-15"><a href="#cb25-15"></a><span class="co">#estimate of standard error</span></span>
<span id="cb25-16"><a href="#cb25-16"></a>ese.jack&lt;-<span class="kw">sqrt</span>((n<span class="dv">-1</span>)<span class="op">*</span><span class="kw">mean</span>((R.jack<span class="op">-</span><span class="kw">mean</span>(R.jack))<span class="op">^</span><span class="dv">2</span>))</span>
<span id="cb25-17"><a href="#cb25-17"></a>out&lt;-<span class="kw">data.frame</span>(ebias.jack,ese.jack)</span>
<span id="cb25-18"><a href="#cb25-18"></a>knitr<span class="op">::</span><span class="kw">kable</span>(out)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">ebias.jack</th>
<th align="right">ese.jack</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">-0.0064736</td>
<td align="right">0.1425186</td>
</tr>
</tbody>
</table>
<ul>
<li><p><strong>7.5</strong></p>
<p><strong>Exponential Distribution</strong></p>
<p>The pdf is <span class="math display">\[\begin{equation}
f(x)=\left\{
\begin{aligned}
&amp;\lambda e^{-\lambda x}  &amp;x&gt;0,\\
&amp;0  &amp;x\le1.
\end{aligned}
\right.
\end{equation}\]</span> If <span class="math inline">\(X\)</span> is exponentially distributed with rate <span class="math inline">\(\lambda\)</span>, then <span class="math display">\[E[X]=\frac{1}{\lambda},\qquad Var[X]=\frac{1}{\lambda^2}\]</span></p>
<p><strong>Rcode and results:</strong></p></li>
</ul>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1"></a><span class="co">#Bootstrap estimate of bias of a ratio estimate</span></span>
<span id="cb26-2"><a href="#cb26-2"></a><span class="kw">set.seed</span>(<span class="dv">187</span>)</span>
<span id="cb26-3"><a href="#cb26-3"></a><span class="kw">library</span>(bootstrap)</span>
<span id="cb26-4"><a href="#cb26-4"></a><span class="kw">library</span>(boot)</span>
<span id="cb26-5"><a href="#cb26-5"></a><span class="co">#&gt; </span></span>
<span id="cb26-6"><a href="#cb26-6"></a><span class="co">#&gt; 载入程辑包：&#39;boot&#39;</span></span>
<span id="cb26-7"><a href="#cb26-7"></a><span class="co">#&gt; The following object is masked from &#39;package:lattice&#39;:</span></span>
<span id="cb26-8"><a href="#cb26-8"></a><span class="co">#&gt; </span></span>
<span id="cb26-9"><a href="#cb26-9"></a><span class="co">#&gt;     melanoma</span></span>
<span id="cb26-10"><a href="#cb26-10"></a><span class="kw">data</span>(<span class="st">&quot;aircondit&quot;</span>)</span>
<span id="cb26-11"><a href="#cb26-11"></a>aircondit&lt;-<span class="kw">as.matrix</span>(aircondit)</span>
<span id="cb26-12"><a href="#cb26-12"></a><span class="co">#the statistic function</span></span>
<span id="cb26-13"><a href="#cb26-13"></a>theta.boot &lt;-<span class="st"> </span><span class="cf">function</span>(Data, index) </span>
<span id="cb26-14"><a href="#cb26-14"></a>{</span>
<span id="cb26-15"><a href="#cb26-15"></a>  x&lt;-Data[index]</span>
<span id="cb26-16"><a href="#cb26-16"></a>  <span class="kw">mean</span>(x) </span>
<span id="cb26-17"><a href="#cb26-17"></a>}</span>
<span id="cb26-18"><a href="#cb26-18"></a>boot.result &lt;-<span class="st"> </span><span class="kw">boot</span>(aircondit, <span class="dt">statistic =</span> theta.boot, <span class="dt">R =</span> <span class="dv">100</span>)</span>
<span id="cb26-19"><a href="#cb26-19"></a><span class="kw">print</span>(boot.result)</span>
<span id="cb26-20"><a href="#cb26-20"></a><span class="co">#&gt; </span></span>
<span id="cb26-21"><a href="#cb26-21"></a><span class="co">#&gt; ORDINARY NONPARAMETRIC BOOTSTRAP</span></span>
<span id="cb26-22"><a href="#cb26-22"></a><span class="co">#&gt; </span></span>
<span id="cb26-23"><a href="#cb26-23"></a><span class="co">#&gt; </span></span>
<span id="cb26-24"><a href="#cb26-24"></a><span class="co">#&gt; Call:</span></span>
<span id="cb26-25"><a href="#cb26-25"></a><span class="co">#&gt; boot(data = aircondit, statistic = theta.boot, R = 100)</span></span>
<span id="cb26-26"><a href="#cb26-26"></a><span class="co">#&gt; </span></span>
<span id="cb26-27"><a href="#cb26-27"></a><span class="co">#&gt; </span></span>
<span id="cb26-28"><a href="#cb26-28"></a><span class="co">#&gt; Bootstrap Statistics :</span></span>
<span id="cb26-29"><a href="#cb26-29"></a><span class="co">#&gt;     original    bias    std. error</span></span>
<span id="cb26-30"><a href="#cb26-30"></a><span class="co">#&gt; t1* 108.0833 -2.521667    38.16827</span></span>
<span id="cb26-31"><a href="#cb26-31"></a><span class="co">#Compute 95% bootstrap confidence intervals</span></span>
<span id="cb26-32"><a href="#cb26-32"></a><span class="kw">print</span>(<span class="kw">boot.ci</span>(boot.result,<span class="dt">type =</span> <span class="kw">c</span>(<span class="st">&quot;norm&quot;</span>, <span class="st">&quot;basic&quot;</span>, <span class="st">&quot;perc&quot;</span>,<span class="st">&quot;bca&quot;</span>)))</span>
<span id="cb26-33"><a href="#cb26-33"></a><span class="co">#&gt; Warning in norm.inter(t, adj.alpha): extreme order statistics used as endpoints</span></span>
<span id="cb26-34"><a href="#cb26-34"></a><span class="co">#&gt; BOOTSTRAP CONFIDENCE INTERVAL CALCULATIONS</span></span>
<span id="cb26-35"><a href="#cb26-35"></a><span class="co">#&gt; Based on 100 bootstrap replicates</span></span>
<span id="cb26-36"><a href="#cb26-36"></a><span class="co">#&gt; </span></span>
<span id="cb26-37"><a href="#cb26-37"></a><span class="co">#&gt; CALL : </span></span>
<span id="cb26-38"><a href="#cb26-38"></a><span class="co">#&gt; boot.ci(boot.out = boot.result, type = c(&quot;norm&quot;, &quot;basic&quot;, &quot;perc&quot;, </span></span>
<span id="cb26-39"><a href="#cb26-39"></a><span class="co">#&gt;     &quot;bca&quot;))</span></span>
<span id="cb26-40"><a href="#cb26-40"></a><span class="co">#&gt; </span></span>
<span id="cb26-41"><a href="#cb26-41"></a><span class="co">#&gt; Intervals : </span></span>
<span id="cb26-42"><a href="#cb26-42"></a><span class="co">#&gt; Level      Normal              Basic         </span></span>
<span id="cb26-43"><a href="#cb26-43"></a><span class="co">#&gt; 95%   ( 35.8, 185.4 )   ( 23.1, 171.9 )  </span></span>
<span id="cb26-44"><a href="#cb26-44"></a><span class="co">#&gt; </span></span>
<span id="cb26-45"><a href="#cb26-45"></a><span class="co">#&gt; Level     Percentile            BCa          </span></span>
<span id="cb26-46"><a href="#cb26-46"></a><span class="co">#&gt; 95%   ( 44.3, 193.1 )   ( 60.6, 213.1 )  </span></span>
<span id="cb26-47"><a href="#cb26-47"></a><span class="co">#&gt; Calculations and Intervals on Original Scale</span></span>
<span id="cb26-48"><a href="#cb26-48"></a><span class="co">#&gt; Some basic intervals may be unstable</span></span>
<span id="cb26-49"><a href="#cb26-49"></a><span class="co">#&gt; Some percentile intervals may be unstable</span></span>
<span id="cb26-50"><a href="#cb26-50"></a><span class="co">#&gt; Warning : BCa Intervals used Extreme Quantiles</span></span>
<span id="cb26-51"><a href="#cb26-51"></a><span class="co">#&gt; Some BCa intervals may be unstable</span></span></code></pre></div>
<p><strong>Comparison</strong></p>
<p><strong>(a)</strong>For the normal distribution, we assume that the distribution of <span class="math inline">\(\bar X\)</span> is normal or the sample size is large. Here the sample size is small. Therefore, it may be not applicable for this sample.</p>
<p><strong>(b)</strong>When the sampling distribution of the statistic is approximately normal, the percentile interval will agree with the normal interval.Here there is a difference in the percentile and normal confidence intervals.Thus, the sampling distribution of the statistic may be not close to normal.</p>
<p><strong>(c)</strong>The basic bootstrap confidence interval is based on the large sample property. It may also be not applicable for this sample.</p>
<p><strong>(d)</strong>The BCa confidence interval is a modified version of percentile intervals that have better theoretical properties and better performance in practice.It is transformation respecting and BCa interval has second order accuracy.</p>
<ul>
<li><strong>7.8</strong></li>
</ul>
<p>From Exercise7.7, we know the sample estimate is <span class="math display">\[\hat\theta=\frac{\hat\lambda_1}{\sum_{j=1}^5\hat\lambda_j}\]</span></p>
</div>
</div>
<div id="hw7" class="section level2">
<h2>HW7</h2>
<div id="question7" class="section level3">
<h3>Question7：</h3>
<ul>
<li><p><strong>Exercise8.3</strong></p>
<p>Implement a random walk Metropolis sampler for generating the standard Laplace distribution (see Exercise 3.2). For the increment, simulate from a normal distribution. Compare the chains generated when different variances are used for the proposal distribution. Also, compute the acceptance rates of each chain.</p></li>
<li><p><strong>Q1</strong> Design experiments for evaluating the performance of the NN, energy, and ball methods in various situations.</p>
<p><strong>1.</strong>Unequal variances and equal expectations</p>
<p><strong>2.</strong>Unequal variances and unequal expectations</p>
<p><strong>3.</strong>Non-normal distributions: t distribution with 1 df (heavy-tailed distribution), bimodel distribution (mixture of two normal distributions)</p>
<p><strong>4.</strong>Unbalanced samples (say, 1 case versus 10 controls)</p>
<p><strong>Note:</strong> The parameters should be chosen such that the powers are distinguishable (say, range from 0.3 to 0.8).</p></li>
</ul>
</div>
<div id="answer7" class="section level3">
<h3>Answer7：</h3>
<ul>
<li><p><strong>8.3</strong></p>
<p><strong>Count Five test</strong></p>
<p>An observation in one sample is considered extreme if it is not within the range of the other sample. If either sample has five or more extreme points, the hypothesis of equal variance is rejected. Thus, the Count Five statistic is the maximum number of extreme points.The sampling distribution of the extreme count statistic can be estimated by a Monte Carlo experiment.</p>
<p><strong>Rcode and results:</strong></p></li>
</ul>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1"></a><span class="kw">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb27-2"><a href="#cb27-2"></a><span class="co"># Sample size</span></span>
<span id="cb27-3"><a href="#cb27-3"></a>n1 &lt;-<span class="st"> </span><span class="dv">20</span></span>
<span id="cb27-4"><a href="#cb27-4"></a>n2 &lt;-<span class="st"> </span><span class="dv">30</span></span>
<span id="cb27-5"><a href="#cb27-5"></a>N &lt;-<span class="st"> </span>n1<span class="op">+</span>n2</span>
<span id="cb27-6"><a href="#cb27-6"></a>m &lt;-<span class="st"> </span><span class="dv">100</span></span>
<span id="cb27-7"><a href="#cb27-7"></a>pv &lt;-pv1&lt;-<span class="st"> </span><span class="kw">numeric</span>(m)</span>
<span id="cb27-8"><a href="#cb27-8"></a><span class="co">#Confidence level</span></span>
<span id="cb27-9"><a href="#cb27-9"></a>a &lt;-<span class="st"> </span><span class="fl">0.05</span></span>
<span id="cb27-10"><a href="#cb27-10"></a>R&lt;-<span class="dv">999</span></span>
<span id="cb27-11"><a href="#cb27-11"></a>ex.piont &lt;-<span class="st"> </span><span class="cf">function</span>(x,y) {</span>
<span id="cb27-12"><a href="#cb27-12"></a>  X.c &lt;-<span class="st"> </span>x<span class="op">-</span><span class="kw">mean</span>(x)</span>
<span id="cb27-13"><a href="#cb27-13"></a>  Y.c &lt;-<span class="st"> </span>y<span class="op">-</span><span class="kw">mean</span>(y)</span>
<span id="cb27-14"><a href="#cb27-14"></a>  outx &lt;-<span class="st"> </span><span class="kw">sum</span>(X.c<span class="op">&gt;</span><span class="kw">max</span>(Y.c))<span class="op">+</span><span class="kw">sum</span>(X.c<span class="op">&lt;</span><span class="kw">min</span>(Y.c))</span>
<span id="cb27-15"><a href="#cb27-15"></a>  outy &lt;-<span class="st"> </span><span class="kw">sum</span>(Y.c<span class="op">&gt;</span><span class="kw">max</span>(X.c))<span class="op">+</span><span class="kw">sum</span>(Y.c<span class="op">&lt;</span><span class="kw">min</span>(X.c))</span>
<span id="cb27-16"><a href="#cb27-16"></a>  <span class="kw">return</span>(<span class="kw">max</span>(<span class="kw">c</span>(outx,outy)))</span>
<span id="cb27-17"><a href="#cb27-17"></a>}</span>
<span id="cb27-18"><a href="#cb27-18"></a>pv &lt;-<span class="st"> </span><span class="kw">replicate</span>(m,<span class="dt">expr =</span> {<span class="co">#Calculate pvalue</span></span>
<span id="cb27-19"><a href="#cb27-19"></a>   x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n1,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb27-20"><a href="#cb27-20"></a>   y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n2,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb27-21"><a href="#cb27-21"></a>   z &lt;-<span class="st"> </span><span class="kw">c</span>(x,y)</span>
<span id="cb27-22"><a href="#cb27-22"></a>   Cs0 &lt;-<span class="st"> </span><span class="kw">ex.piont</span>(x,y)</span>
<span id="cb27-23"><a href="#cb27-23"></a>   Cs &lt;-<span class="st"> </span><span class="kw">numeric</span>(R)</span>
<span id="cb27-24"><a href="#cb27-24"></a>   <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>R)</span>
<span id="cb27-25"><a href="#cb27-25"></a>   {<span class="co">#Permutation</span></span>
<span id="cb27-26"><a href="#cb27-26"></a>   index &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span>N,n1)</span>
<span id="cb27-27"><a href="#cb27-27"></a>   x.p &lt;-<span class="st"> </span>z[index]</span>
<span id="cb27-28"><a href="#cb27-28"></a>   y.p &lt;-<span class="st"> </span>z[<span class="op">-</span>index]</span>
<span id="cb27-29"><a href="#cb27-29"></a>   Cs[i] &lt;-<span class="st"> </span><span class="kw">ex.piont</span>(x.p,y.p)</span>
<span id="cb27-30"><a href="#cb27-30"></a>   }</span>
<span id="cb27-31"><a href="#cb27-31"></a>   p &lt;-<span class="st"> </span><span class="kw">mean</span>(<span class="kw">c</span>(Cs0,Cs)<span class="op">&gt;=</span>Cs0)</span>
<span id="cb27-32"><a href="#cb27-32"></a>   <span class="kw">return</span>(p)</span>
<span id="cb27-33"><a href="#cb27-33"></a>})</span>
<span id="cb27-34"><a href="#cb27-34"></a><span class="co">#Estimate tpye 1 error</span></span>
<span id="cb27-35"><a href="#cb27-35"></a>t1er &lt;-<span class="st"> </span><span class="kw">mean</span>(pv<span class="op">&lt;=</span><span class="st"> </span>a)</span>
<span id="cb27-36"><a href="#cb27-36"></a><span class="kw">print</span>(t1er)</span>
<span id="cb27-37"><a href="#cb27-37"></a><span class="co">#&gt; [1] 0.04</span></span></code></pre></div>
<ul>
<li><p><strong>Q1</strong></p>
<p><strong>Tests for Equal Distributions</strong> <span class="math display">\[H_0:F=G\qquad H_a:F\ne G\]</span></p>
<p><strong>Nearest neighbor(NN)</strong> <span class="math display">\[T_{n,J}=\frac{1}{nJ}\sum_{i=1}^n\sum_{r=1}^JI_i(r)\]</span></p>
<p><strong>Energy</strong> <span class="math display">\[\begin{aligned}
e(X,Y)=&amp;\frac{n_1n_2}{n_1+n_2}\Big(\frac{2}{n_1n_2}\sum_{i=1}^{n_1}\sum_{j=1}^{n_2}\lVert X_i-Y_j\rVert\\
&amp;-\frac{1}{n_1^2}\sum_{i=1}^{n_1}\sum_{i=1}^{n_1}\lVert X_i-X_j\rVert-\frac{1}{n_2^2}\sum_{j=1}^{n_2}\sum_{j=1}^{n_2}\lVert Y_i-Y_j\rVert\Big)
\end{aligned}\]</span> <strong>Ball</strong></p>
<p>Use R package “Ball”</p>
<p><strong>Rcode and results:</strong></p></li>
</ul>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1"></a><span class="kw">library</span>(RANN)</span>
<span id="cb28-2"><a href="#cb28-2"></a><span class="kw">library</span>(boot)</span>
<span id="cb28-3"><a href="#cb28-3"></a><span class="kw">library</span>(energy)</span>
<span id="cb28-4"><a href="#cb28-4"></a><span class="kw">library</span>(Ball)</span>
<span id="cb28-5"><a href="#cb28-5"></a><span class="kw">library</span>(MASS)</span>
<span id="cb28-6"><a href="#cb28-6"></a>n1 &lt;-<span class="st"> </span>n2 &lt;-<span class="st"> </span><span class="dv">30</span></span>
<span id="cb28-7"><a href="#cb28-7"></a>n &lt;-<span class="st"> </span>n1 <span class="op">+</span><span class="st"> </span>n2</span>
<span id="cb28-8"><a href="#cb28-8"></a>d &lt;-<span class="st"> </span><span class="dv">2</span></span>
<span id="cb28-9"><a href="#cb28-9"></a>m &lt;-<span class="st"> </span><span class="dv">100</span></span>
<span id="cb28-10"><a href="#cb28-10"></a>N &lt;-<span class="st"> </span><span class="kw">c</span>(n1, n2)</span>
<span id="cb28-11"><a href="#cb28-11"></a>R &lt;-<span class="st"> </span><span class="dv">999</span></span>
<span id="cb28-12"><a href="#cb28-12"></a>J &lt;-<span class="st"> </span><span class="dv">3</span></span>
<span id="cb28-13"><a href="#cb28-13"></a>alpha &lt;-<span class="st"> </span><span class="fl">0.05</span></span>
<span id="cb28-14"><a href="#cb28-14"></a>NNJ &lt;-<span class="st"> </span><span class="cf">function</span>(z, index, sizes,J) </span>
<span id="cb28-15"><a href="#cb28-15"></a>{</span>
<span id="cb28-16"><a href="#cb28-16"></a>  n1 &lt;-<span class="st"> </span>sizes[<span class="dv">1</span>]</span>
<span id="cb28-17"><a href="#cb28-17"></a>  n2 &lt;-<span class="st"> </span>sizes[<span class="dv">2</span>]</span>
<span id="cb28-18"><a href="#cb28-18"></a>  n&lt;-<span class="st"> </span>n1 <span class="op">+</span><span class="st"> </span>n2</span>
<span id="cb28-19"><a href="#cb28-19"></a>  <span class="cf">if</span>(<span class="kw">is.vector</span>(z))</span>
<span id="cb28-20"><a href="#cb28-20"></a>    z &lt;-<span class="st"> </span><span class="kw">data.frame</span>(z, <span class="dv">0</span>)</span>
<span id="cb28-21"><a href="#cb28-21"></a>  z &lt;-<span class="st"> </span>z[index, ]</span>
<span id="cb28-22"><a href="#cb28-22"></a>  NN &lt;-<span class="st"> </span><span class="kw">nn2</span>(z, <span class="dt">k =</span> J<span class="op">+</span><span class="dv">1</span>)</span>
<span id="cb28-23"><a href="#cb28-23"></a>  block1 &lt;-<span class="st"> </span>NN<span class="op">$</span>nn.idx[<span class="dv">1</span><span class="op">:</span>n1, <span class="dv">-1</span>]</span>
<span id="cb28-24"><a href="#cb28-24"></a>  block2 &lt;-<span class="st"> </span>NN<span class="op">$</span>nn.idx[(n1<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>n,<span class="op">-</span><span class="dv">1</span> ]</span>
<span id="cb28-25"><a href="#cb28-25"></a>  I1 &lt;-<span class="st"> </span><span class="kw">sum</span>(block1 <span class="op">&lt;</span><span class="st"> </span>n1 <span class="op">+</span><span class="st"> </span><span class="fl">.5</span>)</span>
<span id="cb28-26"><a href="#cb28-26"></a>  I2 &lt;-<span class="st"> </span><span class="kw">sum</span>(block2 <span class="op">&gt;</span><span class="st"> </span>n1 <span class="op">+</span><span class="st"> </span><span class="fl">.5</span>)</span>
<span id="cb28-27"><a href="#cb28-27"></a>  <span class="kw">return</span>((I1 <span class="op">+</span><span class="st"> </span>I2) <span class="op">/</span><span class="st"> </span>(J <span class="op">*</span><span class="st"> </span>n))</span>
<span id="cb28-28"><a href="#cb28-28"></a>}</span>
<span id="cb28-29"><a href="#cb28-29"></a>eqdist.nn &lt;-<span class="st"> </span><span class="cf">function</span>(z,sizes,J)</span>
<span id="cb28-30"><a href="#cb28-30"></a>{</span>
<span id="cb28-31"><a href="#cb28-31"></a>  boot.obj &lt;-<span class="st"> </span><span class="kw">boot</span>(<span class="dt">data =</span> z, <span class="dt">statistic =</span> NNJ,</span>
<span id="cb28-32"><a href="#cb28-32"></a>                       <span class="dt">sim =</span> <span class="st">&quot;permutation&quot;</span>, <span class="dt">R =</span> <span class="dv">999</span>, <span class="dt">sizes =</span> sizes,<span class="dt">J=</span>J)</span>
<span id="cb28-33"><a href="#cb28-33"></a>  TS &lt;-<span class="st"> </span><span class="kw">c</span>(boot.obj<span class="op">$</span>t0,boot.obj<span class="op">$</span>t)</span>
<span id="cb28-34"><a href="#cb28-34"></a>  p.value &lt;-<span class="st"> </span><span class="kw">mean</span>(TS <span class="op">&gt;=</span><span class="st"> </span>boot.obj<span class="op">$</span>t0)</span>
<span id="cb28-35"><a href="#cb28-35"></a>  <span class="kw">list</span>(<span class="dt">statistic =</span> boot.obj<span class="op">$</span>t0,<span class="dt">p.value =</span> p.value)</span>
<span id="cb28-36"><a href="#cb28-36"></a>}</span>
<span id="cb28-37"><a href="#cb28-37"></a><span class="co">#Unequal variances and equal expectations</span></span>
<span id="cb28-38"><a href="#cb28-38"></a>p.values &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA</span>,m,<span class="dv">3</span>)</span>
<span id="cb28-39"><a href="#cb28-39"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m)</span>
<span id="cb28-40"><a href="#cb28-40"></a>{</span>
<span id="cb28-41"><a href="#cb28-41"></a>  x &lt;-<span class="st"> </span><span class="kw">mvrnorm</span>(<span class="dt">n =</span> n1, <span class="kw">rep</span>(<span class="dv">0</span>, <span class="dv">2</span>), <span class="kw">diag</span>(<span class="dv">1</span>,d))</span>
<span id="cb28-42"><a href="#cb28-42"></a>  y &lt;-<span class="st"> </span><span class="kw">mvrnorm</span>(<span class="dt">n =</span> n2, <span class="kw">rep</span>(<span class="dv">0</span>, <span class="dv">2</span>), <span class="kw">diag</span>(<span class="fl">2.5</span>,d))</span>
<span id="cb28-43"><a href="#cb28-43"></a>  z&lt;-<span class="kw">rbind</span>(x,y)</span>
<span id="cb28-44"><a href="#cb28-44"></a>  p.values[i,<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.nn</span>(z,N,J)<span class="op">$</span>p.value</span>
<span id="cb28-45"><a href="#cb28-45"></a>  p.values[i,<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.etest</span>(z,<span class="dt">sizes =</span> N,<span class="dt">R =</span> R)<span class="op">$</span>p.value</span>
<span id="cb28-46"><a href="#cb28-46"></a>  p.values[i,<span class="dv">3</span>] &lt;-<span class="st"> </span><span class="kw">bd.test</span>(<span class="dt">x =</span> x,<span class="dt">y =</span> y,<span class="dt">num.permutations =</span> <span class="dv">999</span>,<span class="dt">seed =</span> i<span class="op">*</span><span class="dv">125</span>)<span class="op">$</span>p.value</span>
<span id="cb28-47"><a href="#cb28-47"></a>}</span>
<span id="cb28-48"><a href="#cb28-48"></a>pwr1 &lt;-<span class="st"> </span><span class="kw">colMeans</span>(p.values<span class="op">&lt;</span>alpha)</span>
<span id="cb28-49"><a href="#cb28-49"></a><span class="kw">print</span>(pwr1)</span>
<span id="cb28-50"><a href="#cb28-50"></a><span class="co">#Unequal variances and unequal expectations</span></span>
<span id="cb28-51"><a href="#cb28-51"></a>p.values &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA</span>,m,<span class="dv">3</span>)</span>
<span id="cb28-52"><a href="#cb28-52"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m)</span>
<span id="cb28-53"><a href="#cb28-53"></a>{</span>
<span id="cb28-54"><a href="#cb28-54"></a>  x &lt;-<span class="st"> </span><span class="kw">mvrnorm</span>(<span class="dt">n=</span>n1, <span class="kw">c</span>(<span class="dv">1</span>, <span class="fl">0.5</span>), <span class="kw">diag</span>(<span class="dv">1</span>,d))</span>
<span id="cb28-55"><a href="#cb28-55"></a>  y &lt;-<span class="st"> </span><span class="kw">mvrnorm</span>(<span class="dt">n=</span>n2, <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">0</span>), <span class="kw">diag</span>(<span class="fl">0.5</span>,d))</span>
<span id="cb28-56"><a href="#cb28-56"></a>  z &lt;-<span class="st"> </span><span class="kw">rbind</span>(x,y)</span>
<span id="cb28-57"><a href="#cb28-57"></a>  p.values[i,<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.nn</span>(z,N,J)<span class="op">$</span>p.value</span>
<span id="cb28-58"><a href="#cb28-58"></a>  p.values[i,<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.etest</span>(z,<span class="dt">sizes =</span> N,<span class="dt">R =</span> R)<span class="op">$</span>p.value</span>
<span id="cb28-59"><a href="#cb28-59"></a>  p.values[i,<span class="dv">3</span>] &lt;-<span class="st"> </span><span class="kw">bd.test</span>(<span class="dt">x =</span> x,<span class="dt">y =</span> y,<span class="dt">num.permutations=</span><span class="dv">999</span>,<span class="dt">seed =</span> i<span class="op">*</span><span class="dv">145</span>)<span class="op">$</span>p.value</span>
<span id="cb28-60"><a href="#cb28-60"></a>}</span>
<span id="cb28-61"><a href="#cb28-61"></a>pwr2 &lt;-<span class="st"> </span><span class="kw">colMeans</span>(p.values<span class="op">&lt;</span>alpha)</span>
<span id="cb28-62"><a href="#cb28-62"></a><span class="kw">print</span>(pwr2)</span>
<span id="cb28-63"><a href="#cb28-63"></a><span class="co">#t distribution with 1 df, bimodel distribution</span></span>
<span id="cb28-64"><a href="#cb28-64"></a>p.values &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA</span>,m,<span class="dv">3</span>)</span>
<span id="cb28-65"><a href="#cb28-65"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m)</span>
<span id="cb28-66"><a href="#cb28-66"></a>{</span>
<span id="cb28-67"><a href="#cb28-67"></a>  x &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rt</span>(n1<span class="op">*</span>d,<span class="dv">1</span>),<span class="dt">ncol=</span>d);</span>
<span id="cb28-68"><a href="#cb28-68"></a>  mix &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="dt">size =</span> n2<span class="op">*</span>d, <span class="dt">prob =</span> <span class="kw">c</span>(<span class="fl">0.3</span>, <span class="fl">0.7</span>), <span class="dt">replace =</span> T)</span>
<span id="cb28-69"><a href="#cb28-69"></a>  y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n2<span class="op">*</span>d, <span class="dt">mean =</span> <span class="kw">ifelse</span>(mix <span class="op">==</span><span class="st"> </span><span class="dv">0</span>, <span class="dv">0</span>, <span class="fl">1.5</span>), <span class="dt">sd =</span> <span class="kw">ifelse</span>(mix <span class="op">==</span><span class="st"> </span><span class="dv">0</span>, <span class="dv">2</span>, <span class="dv">4</span>))</span>
<span id="cb28-70"><a href="#cb28-70"></a>  y &lt;-<span class="st"> </span><span class="kw">matrix</span>(y,<span class="dt">ncol=</span>d)</span>
<span id="cb28-71"><a href="#cb28-71"></a>  z &lt;-<span class="st"> </span><span class="kw">rbind</span>(x,y)</span>
<span id="cb28-72"><a href="#cb28-72"></a>  p.values[i,<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.nn</span>(z,N,J)<span class="op">$</span>p.value</span>
<span id="cb28-73"><a href="#cb28-73"></a>  p.values[i,<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.etest</span>(z,<span class="dt">sizes =</span> N,<span class="dt">R =</span> R)<span class="op">$</span>p.value</span>
<span id="cb28-74"><a href="#cb28-74"></a>  p.values[i,<span class="dv">3</span>] &lt;-<span class="st"> </span><span class="kw">bd.test</span>(<span class="dt">x =</span> x,<span class="dt">y =</span> y,<span class="dt">num.permutations=</span><span class="dv">999</span>,<span class="dt">seed =</span> i<span class="op">*</span><span class="dv">145</span>)<span class="op">$</span>p.value</span>
<span id="cb28-75"><a href="#cb28-75"></a>}</span>
<span id="cb28-76"><a href="#cb28-76"></a>pwr3 &lt;-<span class="st"> </span><span class="kw">colMeans</span>(p.values<span class="op">&lt;</span>alpha)</span>
<span id="cb28-77"><a href="#cb28-77"></a><span class="kw">print</span>(pwr3)</span>
<span id="cb28-78"><a href="#cb28-78"></a><span class="co">#Unbalanced samples(1:10)</span></span>
<span id="cb28-79"><a href="#cb28-79"></a>n1 &lt;-<span class="st"> </span><span class="dv">10</span></span>
<span id="cb28-80"><a href="#cb28-80"></a>n2 &lt;-<span class="st"> </span><span class="dv">100</span></span>
<span id="cb28-81"><a href="#cb28-81"></a>n &lt;-<span class="st"> </span>n1 <span class="op">+</span><span class="st"> </span>n2</span>
<span id="cb28-82"><a href="#cb28-82"></a>N &lt;-<span class="st"> </span><span class="kw">c</span>(n1, n2)</span>
<span id="cb28-83"><a href="#cb28-83"></a>p.values &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA</span>,m,<span class="dv">3</span>)</span>
<span id="cb28-84"><a href="#cb28-84"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m)</span>
<span id="cb28-85"><a href="#cb28-85"></a>{</span>
<span id="cb28-86"><a href="#cb28-86"></a>  x &lt;-<span class="st"> </span><span class="kw">mvrnorm</span>(<span class="dt">n=</span>n1, <span class="kw">c</span>(<span class="dv">1</span>, <span class="fl">0.5</span>), <span class="kw">diag</span>(<span class="dv">1</span>,d))</span>
<span id="cb28-87"><a href="#cb28-87"></a>  y &lt;-<span class="st"> </span><span class="kw">mvrnorm</span>(<span class="dt">n=</span>n2, <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">0</span>), <span class="kw">diag</span>(<span class="fl">0.5</span>,d))</span>
<span id="cb28-88"><a href="#cb28-88"></a>  z &lt;-<span class="st"> </span><span class="kw">rbind</span>(x,y)</span>
<span id="cb28-89"><a href="#cb28-89"></a>  p.values[i,<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.nn</span>(z,N,J)<span class="op">$</span>p.value</span>
<span id="cb28-90"><a href="#cb28-90"></a>  p.values[i,<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.etest</span>(z,<span class="dt">sizes =</span> N,<span class="dt">R =</span> R)<span class="op">$</span>p.value</span>
<span id="cb28-91"><a href="#cb28-91"></a>  p.values[i,<span class="dv">3</span>] &lt;-<span class="st"> </span><span class="kw">bd.test</span>(<span class="dt">x =</span> x,<span class="dt">y =</span> y,<span class="dt">num.permutations=</span><span class="dv">999</span>,<span class="dt">seed =</span> i<span class="op">*</span><span class="dv">125</span>)<span class="op">$</span>p.value</span>
<span id="cb28-92"><a href="#cb28-92"></a>}</span>
<span id="cb28-93"><a href="#cb28-93"></a>pwr4 &lt;-<span class="st"> </span><span class="kw">colMeans</span>(p.values<span class="op">&lt;</span>alpha)</span>
<span id="cb28-94"><a href="#cb28-94"></a><span class="kw">print</span>(pwr4)</span>
<span id="cb28-95"><a href="#cb28-95"></a>out&lt;-<span class="kw">rbind</span>(pwr1,pwr2,pwr3,pwr4)</span>
<span id="cb28-96"><a href="#cb28-96"></a><span class="kw">colnames</span>(out)&lt;-<span class="kw">c</span>(<span class="st">&quot;NN&quot;</span>,<span class="st">&quot;Energy&quot;</span>,<span class="st">&quot;Ball&quot;</span>)</span>
<span id="cb28-97"><a href="#cb28-97"></a>knitr<span class="op">::</span><span class="kw">kable</span>(out)</span></code></pre></div>
<p><strong>Conclusion</strong></p>
<p>1.The powers between methods NN,energy and ball is distingushable,range from 0.28 to 0.78,and the ball method perform best.</p>
<p>2.The powers between methods NN,energy and ball is distingushable,range from 0.30 to 0.76,and the ball method perform best.</p>
<p>3.The powers between methods NN,energy and ball are distingushable,range from 0.47 to 0.62,and the ball method perform best.</p>
<p>4.The powers between methods NN,energy and ball is distingushable,range from 0.32 to 0.63,and energy test perform best.</p>
</div>
</div>
<div id="hw8" class="section level2">
<h2>HW8</h2>
<div id="question8" class="section level3">
<h3>Question8：</h3>
<ul>
<li><p><strong>Exercise9.4</strong></p>
<p>Implement a random walk Metropolis sampler for generating the standard Laplace distribution (see Exercise 3.2). For the increment, simulate from a normal distribution. Compare the chains generated when different variances are used for the proposal distribution. Also, compute the acceptance rates of each chain.</p></li>
<li><p><strong>Q1</strong></p>
<p>For Exercise 9.4, use the Gelman-Rubin method to monitor convergence of the chain, and run the chain until it converges approximately to the target distribution according to <span class="math inline">\(\hat R &lt; 1.2\)</span>.</p></li>
<li><p><strong>Exercise11.4</strong></p>
<p>Find the intersection points <span class="math inline">\(A(k)\)</span> in <span class="math inline">\((0, \sqrt k)\)</span> of the curves <span class="math display">\[S_{k−1}(a) = P \bigg(t(k − 1) &gt; \sqrt {\frac{a^2(k − 1)}{k-a^2}}\bigg)\]</span> and <span class="math display">\[S_k(a) = P\bigg(t(k) &gt; \frac{a^2k }{k+1− a^2}\bigg)\]</span> for <span class="math inline">\(k = 4 : 25, 100, 500, 1000\)</span>, where t(k) is a Student <span class="math inline">\(t\)</span> random variable with <span class="math inline">\(k\)</span> degrees of freedom. (These intersection points determine the critical values for a t-test for scale-mixture errors proposed by Sz´ekely [260].)</p></li>
</ul>
</div>
<div id="answer8" class="section level3">
<h3>Answer8：</h3>
<ul>
<li><p><strong>9.4</strong></p>
<p><strong>Target density</strong> <span class="math display">\[f(x)=\frac{1}{2}e^{-|x|},\quad x\in R\]</span></p>
<p><strong>The Metropolis Sampler</strong></p>
<p>The candidate point Y is accepted with probability <span class="math display">\[\alpha(X_t, Y ) = min\{1, \frac{f(Y )}{f(X_t)}\}\]</span></p>
<p><strong>Rcode and results:</strong></p></li>
</ul>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1"></a><span class="kw">set.seed</span>(<span class="dv">127</span>)</span>
<span id="cb29-2"><a href="#cb29-2"></a><span class="co">#x0 initial value </span></span>
<span id="cb29-3"><a href="#cb29-3"></a>Metro.rw &lt;-<span class="st"> </span><span class="cf">function</span>(x0, N,sigma)</span>
<span id="cb29-4"><a href="#cb29-4"></a>{</span>
<span id="cb29-5"><a href="#cb29-5"></a>  x &lt;-<span class="st"> </span><span class="kw">numeric</span>(N)</span>
<span id="cb29-6"><a href="#cb29-6"></a>  x[<span class="dv">1</span>] &lt;-<span class="st"> </span>x0</span>
<span id="cb29-7"><a href="#cb29-7"></a>  k &lt;-<span class="st"> </span><span class="dv">0</span></span>
<span id="cb29-8"><a href="#cb29-8"></a>  <span class="co">#U(0,1)</span></span>
<span id="cb29-9"><a href="#cb29-9"></a>  u &lt;-<span class="st"> </span><span class="kw">runif</span>(N)</span>
<span id="cb29-10"><a href="#cb29-10"></a> </span>
<span id="cb29-11"><a href="#cb29-11"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>N) </span>
<span id="cb29-12"><a href="#cb29-12"></a>  {</span>
<span id="cb29-13"><a href="#cb29-13"></a>    y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">1</span>, x[i<span class="dv">-1</span>], sigma)</span>
<span id="cb29-14"><a href="#cb29-14"></a>    alpha &lt;-<span class="st"> </span><span class="kw">exp</span>(<span class="op">-</span><span class="dv">1</span><span class="op">*</span><span class="kw">abs</span>(y))<span class="op">/</span><span class="kw">exp</span>(<span class="op">-</span><span class="dv">1</span><span class="op">*</span><span class="kw">abs</span>(x[i<span class="dv">-1</span>]))</span>
<span id="cb29-15"><a href="#cb29-15"></a>    <span class="cf">if</span> (u[i]<span class="op">&lt;=</span>alpha)</span>
<span id="cb29-16"><a href="#cb29-16"></a>      x[i] &lt;-<span class="st"> </span>y </span>
<span id="cb29-17"><a href="#cb29-17"></a>    <span class="cf">else</span></span>
<span id="cb29-18"><a href="#cb29-18"></a>    {</span>
<span id="cb29-19"><a href="#cb29-19"></a>        x[i] &lt;-<span class="st"> </span>x[i<span class="dv">-1</span>]</span>
<span id="cb29-20"><a href="#cb29-20"></a>        <span class="co">#reject</span></span>
<span id="cb29-21"><a href="#cb29-21"></a>        k &lt;-<span class="st"> </span>k <span class="op">+</span><span class="st"> </span><span class="dv">1</span></span>
<span id="cb29-22"><a href="#cb29-22"></a>    }</span>
<span id="cb29-23"><a href="#cb29-23"></a>  }</span>
<span id="cb29-24"><a href="#cb29-24"></a>  <span class="kw">return</span>(<span class="kw">list</span>(<span class="dt">x=</span>x, <span class="dt">acc.rate=</span><span class="dv">1</span><span class="op">-</span>k<span class="op">/</span>N))</span>
<span id="cb29-25"><a href="#cb29-25"></a>}</span>
<span id="cb29-26"><a href="#cb29-26"></a>x0 &lt;-<span class="st"> </span><span class="dv">20</span></span>
<span id="cb29-27"><a href="#cb29-27"></a><span class="co">#length N</span></span>
<span id="cb29-28"><a href="#cb29-28"></a>N &lt;-<span class="st"> </span><span class="dv">300</span></span>
<span id="cb29-29"><a href="#cb29-29"></a><span class="co">#n chains</span></span>
<span id="cb29-30"><a href="#cb29-30"></a>n &lt;-<span class="st"> </span><span class="dv">4</span> </span>
<span id="cb29-31"><a href="#cb29-31"></a>sigma &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.05</span>, <span class="fl">0.5</span>, <span class="dv">2</span>, <span class="dv">16</span>)</span>
<span id="cb29-32"><a href="#cb29-32"></a>Metro.rw1 &lt;-<span class="st"> </span><span class="kw">Metro.rw</span>(x0, N, sigma[<span class="dv">1</span>])</span>
<span id="cb29-33"><a href="#cb29-33"></a>Metro.rw2 &lt;-<span class="st"> </span><span class="kw">Metro.rw</span>(x0, N, sigma[<span class="dv">2</span>])</span>
<span id="cb29-34"><a href="#cb29-34"></a>Metro.rw3 &lt;-<span class="st"> </span><span class="kw">Metro.rw</span>(x0, N, sigma[<span class="dv">3</span>])</span>
<span id="cb29-35"><a href="#cb29-35"></a>Metro.rw4 &lt;-<span class="st"> </span><span class="kw">Metro.rw</span>(x0, N, sigma[<span class="dv">4</span>])</span>
<span id="cb29-36"><a href="#cb29-36"></a><span class="co">#accept</span></span>
<span id="cb29-37"><a href="#cb29-37"></a>acc.rate&lt;-<span class="kw">c</span>(Metro.rw1<span class="op">$</span>acc.rate, Metro.rw2<span class="op">$</span>acc.rate, Metro.rw3<span class="op">$</span>acc.rate, Metro.rw4<span class="op">$</span>acc.rate)</span>
<span id="cb29-38"><a href="#cb29-38"></a>acc.rate&lt;-<span class="kw">round</span>(acc.rate,<span class="dv">3</span>)</span>
<span id="cb29-39"><a href="#cb29-39"></a>ACC&lt;-<span class="kw">data.frame</span>(<span class="dt">sigma=</span>sigma,<span class="dt">Acceptance_rate=</span>acc.rate)</span>
<span id="cb29-40"><a href="#cb29-40"></a>knitr<span class="op">::</span><span class="kw">kable</span>(ACC)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">sigma</th>
<th align="right">Acceptance_rate</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0.05</td>
<td align="right">0.997</td>
</tr>
<tr class="even">
<td align="right">0.50</td>
<td align="right">0.810</td>
</tr>
<tr class="odd">
<td align="right">2.00</td>
<td align="right">0.597</td>
</tr>
<tr class="even">
<td align="right">16.00</td>
<td align="right">0.123</td>
</tr>
</tbody>
</table>
<p>Plot the four chains:</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1"></a><span class="co">#par(mfrow=c(2,2))  </span></span>
<span id="cb30-2"><a href="#cb30-2"></a>Metro.rw =<span class="st"> </span><span class="kw">cbind</span>(Metro.rw1<span class="op">$</span>x, Metro.rw2<span class="op">$</span>x, Metro.rw3<span class="op">$</span>x,  Metro.rw4<span class="op">$</span>x)</span>
<span id="cb30-3"><a href="#cb30-3"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>)</span>
<span id="cb30-4"><a href="#cb30-4"></a>  <span class="kw">plot</span>(Metro.rw[,i], <span class="dt">type=</span><span class="st">&quot;l&quot;</span>,<span class="dt">sub=</span><span class="kw">bquote</span>(sigma <span class="op">==</span><span class="st"> </span>.(sigma[i])),<span class="dt">xlab =</span> <span class="st">&quot;n&quot;</span>,<span class="dt">ylab=</span><span class="st">&quot;X&quot;</span>, <span class="dt">ylim=</span><span class="kw">range</span>(Metro.rw[,i]))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --></p>
<ul>
<li><p><strong>Q1</strong></p>
<p><strong>Gelman-Rubin method of monitoring convergence</strong></p>
<p>The Gelman-Rubin statistic is the estimated potential scale reduction <span class="math display">\[\hat R = \frac{\widehat {Var}(\psi)}{W}\]</span> <strong>Rcode and results:</strong></p></li>
</ul>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1"></a><span class="co">#Q1</span></span>
<span id="cb31-2"><a href="#cb31-2"></a><span class="kw">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb31-3"><a href="#cb31-3"></a><span class="co">#k chains</span></span>
<span id="cb31-4"><a href="#cb31-4"></a>k &lt;-<span class="st"> </span><span class="dv">4</span> </span>
<span id="cb31-5"><a href="#cb31-5"></a><span class="co">#length N</span></span>
<span id="cb31-6"><a href="#cb31-6"></a>N &lt;-<span class="st"> </span><span class="dv">150</span></span>
<span id="cb31-7"><a href="#cb31-7"></a><span class="co">#burn-in length</span></span>
<span id="cb31-8"><a href="#cb31-8"></a>N0 &lt;-<span class="st"> </span><span class="dv">10</span></span>
<span id="cb31-9"><a href="#cb31-9"></a><span class="co">#initial values</span></span>
<span id="cb31-10"><a href="#cb31-10"></a>x0 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="op">-</span><span class="dv">10</span>, <span class="dv">-5</span>, <span class="dv">5</span>, <span class="dv">10</span>)</span>
<span id="cb31-11"><a href="#cb31-11"></a>sigma &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.05</span>, <span class="fl">0.5</span>, <span class="dv">2</span>, <span class="dv">16</span>)</span>
<span id="cb31-12"><a href="#cb31-12"></a><span class="co">#generate chains</span></span>
<span id="cb31-13"><a href="#cb31-13"></a>Metro.rw &lt;-<span class="st"> </span><span class="cf">function</span>(x0, N,sigma)</span>
<span id="cb31-14"><a href="#cb31-14"></a>{</span>
<span id="cb31-15"><a href="#cb31-15"></a>  x &lt;-<span class="st"> </span><span class="kw">numeric</span>(N)</span>
<span id="cb31-16"><a href="#cb31-16"></a>  x[<span class="dv">1</span>] &lt;-<span class="st"> </span>x0</span>
<span id="cb31-17"><a href="#cb31-17"></a>  k &lt;-<span class="st"> </span><span class="dv">0</span></span>
<span id="cb31-18"><a href="#cb31-18"></a>  <span class="co">#U(0,1)</span></span>
<span id="cb31-19"><a href="#cb31-19"></a>  u &lt;-<span class="st"> </span><span class="kw">runif</span>(N)</span>
<span id="cb31-20"><a href="#cb31-20"></a> </span>
<span id="cb31-21"><a href="#cb31-21"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>N) </span>
<span id="cb31-22"><a href="#cb31-22"></a>  {</span>
<span id="cb31-23"><a href="#cb31-23"></a>    y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">1</span>, x[i<span class="dv">-1</span>], sigma)</span>
<span id="cb31-24"><a href="#cb31-24"></a>    alpha &lt;-<span class="st"> </span><span class="kw">exp</span>(<span class="op">-</span><span class="dv">1</span><span class="op">*</span><span class="kw">abs</span>(y))<span class="op">/</span><span class="kw">exp</span>(<span class="op">-</span><span class="dv">1</span><span class="op">*</span><span class="kw">abs</span>(x[i<span class="dv">-1</span>]))</span>
<span id="cb31-25"><a href="#cb31-25"></a>    <span class="cf">if</span> (u[i]<span class="op">&lt;=</span>alpha)</span>
<span id="cb31-26"><a href="#cb31-26"></a>      x[i] &lt;-<span class="st"> </span>y </span>
<span id="cb31-27"><a href="#cb31-27"></a>    <span class="cf">else</span></span>
<span id="cb31-28"><a href="#cb31-28"></a>    {</span>
<span id="cb31-29"><a href="#cb31-29"></a>        x[i] &lt;-<span class="st"> </span>x[i<span class="dv">-1</span>]</span>
<span id="cb31-30"><a href="#cb31-30"></a>        <span class="co">#reject</span></span>
<span id="cb31-31"><a href="#cb31-31"></a>        k &lt;-<span class="st"> </span>k <span class="op">+</span><span class="st"> </span><span class="dv">1</span></span>
<span id="cb31-32"><a href="#cb31-32"></a>    }</span>
<span id="cb31-33"><a href="#cb31-33"></a>  }</span>
<span id="cb31-34"><a href="#cb31-34"></a>  <span class="kw">return</span>(<span class="kw">list</span>(<span class="dt">x=</span>x, <span class="dt">acc.rate=</span><span class="dv">1</span><span class="op">-</span>k<span class="op">/</span>N))</span>
<span id="cb31-35"><a href="#cb31-35"></a>}</span>
<span id="cb31-36"><a href="#cb31-36"></a><span class="co">#psi statistics</span></span>
<span id="cb31-37"><a href="#cb31-37"></a>psi.st &lt;-<span class="st"> </span><span class="cf">function</span>(X)</span>
<span id="cb31-38"><a href="#cb31-38"></a>{</span>
<span id="cb31-39"><a href="#cb31-39"></a>  Y &lt;-<span class="st"> </span><span class="kw">t</span>(<span class="kw">apply</span>(X, <span class="dv">1</span>, cumsum))</span>
<span id="cb31-40"><a href="#cb31-40"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(X))</span>
<span id="cb31-41"><a href="#cb31-41"></a>    Y[i,] &lt;-<span class="st"> </span>Y[i,] <span class="op">/</span><span class="st"> </span>(<span class="dv">1</span><span class="op">:</span><span class="kw">ncol</span>(X))</span>
<span id="cb31-42"><a href="#cb31-42"></a>  <span class="kw">return</span>(Y)</span>
<span id="cb31-43"><a href="#cb31-43"></a>}</span>
<span id="cb31-44"><a href="#cb31-44"></a><span class="co">#Gelman Rubin statistic</span></span>
<span id="cb31-45"><a href="#cb31-45"></a>Gelman.Rubin &lt;-<span class="st"> </span><span class="cf">function</span>(psi) </span>
<span id="cb31-46"><a href="#cb31-46"></a>{ </span>
<span id="cb31-47"><a href="#cb31-47"></a>  k &lt;-<span class="st"> </span><span class="kw">nrow</span>(psi)</span>
<span id="cb31-48"><a href="#cb31-48"></a>  N &lt;-<span class="st"> </span><span class="kw">ncol</span>(psi)</span>
<span id="cb31-49"><a href="#cb31-49"></a>  psi.means &lt;-<span class="st"> </span><span class="kw">rowMeans</span>(psi) </span>
<span id="cb31-50"><a href="#cb31-50"></a>  B &lt;-<span class="st"> </span>N <span class="op">*</span><span class="st"> </span><span class="kw">var</span>(psi.means)</span>
<span id="cb31-51"><a href="#cb31-51"></a>  W &lt;-<span class="st"> </span><span class="kw">mean</span>(<span class="kw">apply</span>(psi, <span class="dv">1</span>, <span class="st">&quot;var&quot;</span>)) </span>
<span id="cb31-52"><a href="#cb31-52"></a>  Var.hat &lt;-<span class="st"> </span>(N<span class="dv">-1</span>)<span class="op">*</span>W<span class="op">/</span>N <span class="op">+</span><span class="st"> </span>B<span class="op">/</span>N</span>
<span id="cb31-53"><a href="#cb31-53"></a>  R.hat &lt;-<span class="st"> </span>Var.hat<span class="op">/</span>W </span>
<span id="cb31-54"><a href="#cb31-54"></a>  <span class="kw">return</span>(R.hat)</span>
<span id="cb31-55"><a href="#cb31-55"></a>}</span>
<span id="cb31-56"><a href="#cb31-56"></a><span class="co">#calculate Rhat</span></span>
<span id="cb31-57"><a href="#cb31-57"></a>rhat &lt;-<span class="st"> </span><span class="cf">function</span>(sigma,x0,N,N0)</span>
<span id="cb31-58"><a href="#cb31-58"></a>{</span>
<span id="cb31-59"><a href="#cb31-59"></a>  X &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA</span>, <span class="dt">nrow=</span>k, <span class="dt">ncol=</span>N)</span>
<span id="cb31-60"><a href="#cb31-60"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>k)</span>
<span id="cb31-61"><a href="#cb31-61"></a>  X[i, ] &lt;-<span class="st"> </span><span class="kw">Metro.rw</span>(x0[i], N, sigma)<span class="op">$</span>x</span>
<span id="cb31-62"><a href="#cb31-62"></a>  psi &lt;-<span class="st"> </span><span class="kw">psi.st</span>(X)</span>
<span id="cb31-63"><a href="#cb31-63"></a>  <span class="co">#par(mfrow=c(2,2))</span></span>
<span id="cb31-64"><a href="#cb31-64"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>k)</span>
<span id="cb31-65"><a href="#cb31-65"></a>  <span class="kw">plot</span>(psi[i, (N0<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>N], <span class="dt">type=</span><span class="st">&quot;l&quot;</span>,<span class="dt">sub=</span><span class="kw">bquote</span>(sigma <span class="op">==</span><span class="st"> </span>.(sigma)),<span class="dt">xlab=</span>i, <span class="dt">ylab=</span><span class="kw">bquote</span>(psi))</span>
<span id="cb31-66"><a href="#cb31-66"></a>  R.hat &lt;-<span class="st"> </span><span class="kw">numeric</span>(N)</span>
<span id="cb31-67"><a href="#cb31-67"></a>  <span class="cf">for</span> (j <span class="cf">in</span> (N0<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>N)</span>
<span id="cb31-68"><a href="#cb31-68"></a>  R.hat[j] &lt;-<span class="st"> </span><span class="kw">Gelman.Rubin</span>(psi[,<span class="dv">1</span><span class="op">:</span>j])</span>
<span id="cb31-69"><a href="#cb31-69"></a>  R.hat &lt;-<span class="st"> </span>R.hat[(N0<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>N]</span>
<span id="cb31-70"><a href="#cb31-70"></a>  <span class="kw">return</span>(R.hat)</span>
<span id="cb31-71"><a href="#cb31-71"></a>}</span>
<span id="cb31-72"><a href="#cb31-72"></a><span class="co">#number of sigma is 4</span></span>
<span id="cb31-73"><a href="#cb31-73"></a>R &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA</span>,<span class="dt">nrow=</span><span class="dv">4</span>, <span class="dt">ncol=</span>N<span class="op">-</span>N0)</span>
<span id="cb31-74"><a href="#cb31-74"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>)</span>
<span id="cb31-75"><a href="#cb31-75"></a>  R[i,] &lt;-<span class="st"> </span><span class="kw">rhat</span>(sigma[i],x0,N,N0)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAflBMVEUAAAAAADoAAGYAOpAAZrY6AAA6ADo6AGY6Ojo6OpA6ZmY6ZpA6ZrY6kNtmAABmADpmOgBmZmZmZrZmtttmtv+QOgCQOjqQZgCQZjqQZpCQtraQ2/+2ZgC2Zjq22/+2///bkDrbtpDb2//b////tmb/25D/27b//7b//9v////WpbNGAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAHZklEQVR4nO2da5ebNhRFmVebNhmnTcZ9hWbcFsfm///BAgLGjoFzhXWlizn7Q9YQxBXspScPOSvJJFnqE7AOBQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCBBaULYZUgsKG04OCABQEMC3IgkW7gur20YAho4K63sOvI9HApqBscjMqFARYhKCUhkwKutyZzhAFARYiKJ2hyIJEc8ChfWsRJAo3uC+VIQoCGBQ0vIuC0K5EhpYjKJEhe4Im9qRQtCRBScrQogSlMLQsQQkMmROE7qSFPQ0MBQGsCYLZxDa0OEGxO/vlCYqsSEnQcetuaty/+oUT5hLRkI6gXfbs/ii6P4ThpLnEM6Qi6Ljttewe/vMJl6rGB8jI54wOm5fuz2Kkkq1bUIQSFM2QVhvUFiHPNsgjk2ULqiqZ68VGyk+I24aROntb4yC/TKIYWrKgKIVIeaD4MpYg0J15fUM6gvY/fKla6qqHz8eG0qEeXagb0uzm8+rf/NEn3FoEtQPFegzkNVCcc7XahlRL0KOrZ+JwqxFU7u6+uIbosPGpYrMuVtmQUi9WVD3Y3YSf1QuaF46CwPtB8/LQNaQtSL2RXrogr3AUNB1ubhaqhigoVPAIk9WbEHT8c+wW2CnzJqs3Ieiwufv517/+nU47c7I6+0I1DXlXsW9/vKuqzofJtDMnq7chqOHbbyP34h0zJ6vzr1PR0MxGev/TZFM0b7J6xWXqGfJvg/rJwuhz93LeZPWai7QjqAWUoFn5XnWRaobmCTrmk21Ql2o7nup2Bble7L2kAMUUpGZo3jjoq+iQVQqSjaTbtDEFaRnSnKz6Cbr2AhcoyC/c1RnoGKKgUFHtC9IxREGhgmoLChFfwxAFhYq5BEEahm5LkIIhK4JChQ9uiIJCBdQVFC56aEMUFCreUgTpj2hV8x17/SXkVYU1ZKMEJbqmoMEoKGauuoLSVFgKipjpRbhkfXPAUIsSlGJcpSlIYxIe6lOpWxUULOoNCwrzvZ2SIL+VF5QEBaloOoI8V15QE1S+TW5mHx88Yen/3bymoD4PuaSzhCqCPFdeiOHHZSTJqU50UugslKBoggSN0sV+rTbIZ+WFiILKvlEa2XX5f+K4XmfhtfJCXEFdptnp3wE+0VIcByUR1GopUcu0YkEub9goiSN55eszUEzpB2NgoLhCQX7d/AoFeQ0UbfsxUILWKMhroLhKQR4DReN+0o+DKAiEW7sg+MXh2gWhcNb9UBAisqDvXn9J/AOPEgxMVm1jYLJqm/RTDeOkn6waJ1kJWgwaggST1amYw/9tJPEogSerUzHXIOiqmBQEYlIQiElBIObtCzpZQ2dyER0j15ygBB23U15QzBUIqgyNrawkiLkGQdUIcXQJxRtlMZOnVFAQYIagqeVxbg8KAlAQgIIAFARgLwagIAAFASgIQEGA4IKKZkFlGXlz819yxC5rf2kAJt7/WN+RaZ6RP/uezxChBRXV2RTCMyqapyOSI+qVvpsbCTDxYVPfsjpuqzS77NHvfAYJLMiNkcZ+EuCcw6YWJDnC3Yaq0sDEhbvXuX+qi9vu/tXnfIYJLKg/M0Ha3cPvlSDJEb0glLjInk8eilclx+d8hgktqP7ljdEn998nrdsg0RFdFRMkPtmZ3796nM8IgQW56i6p9HXhrwXJjmibWkHiNxn183H5+YyRTFD9+oNYUP1LMPsn0fX2goqujTYlSFykm4TSKta3JB5VzL1fYa6KiRvFXft87UVyRF8OBIlbGe3LcOYaab9uNRd28+4yC1Gv7QR1L+qY6+b9Bma5dKDYtUGCxIUbB3W3rKwNFJu64znVkByRdzMHmLgR1FbgOqXP+QzBySqAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBFiAIPdibyrsC3Iv9ibDvKBiehEDdawLOn+xNwHWBZXXvWF4PRQEoCAABQEoCEBBAAoCUBBgAYLSQkEACgJQEICCABQEoCDAAgSdrZ3QbbhVQa/4UE6KfUFnn8T1G+5j1AiYF3T2UeXbRrThtXlBZ5/lvm3sItSuBiuCjn8/NV9RXiyPdvZh99tG/m4osQJWBOUPX8v9p4Gl8s+WBug3Dpv6c9c8giEjgtqi8cFt5e1H9XU1Ghbk0sVoiIwIcpd6+HjZNY1UMbfvSX9tYluCNpcXPNJIu30R+nojgpyarkScVrHhbr5fi0H9zIwIqtqVz9XlD/2gyfBAsTG2oka6LP/5JcveD/7gS7t2gluGql9IIe+WfVPGjCCrUBCAggAUBKAgwP8lbuU4U3pzfQAAAABJRU5ErkJggg==" /><!-- --><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAgVBMVEUAAAAAADoAAGYAOjoAOpAAZrY6AAA6ADo6AGY6Ojo6OpA6ZmY6ZpA6ZrY6kNtmAABmADpmOgBmZmZmZrZmtttmtv+QOgCQOjqQZgCQZjqQZpCQtraQ2/+2ZgC2Zjq22/+2///bkDrbtpDb2//b////tmb/25D/27b//7b//9v////XB51oAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAHSklEQVR4nO2de3+bNhSGSZak69bGu8W7hTV0w7X9/T/gwAJst8ArCR3pyLzPH2n8izjAU92QhFwcySxF6gvQDgUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAgQWVGRDXEHu501NZEFS4eSgIMANC+oL8rJT3aqgXk7776Ia70YFfR3eX5GQoMPWtFX3b0HCuTIS3TcbyQiqimfzS93/siicI1MqvM4pIuiwHbRUD/8tDufGTE7xOamIoP3mpf+1nihkYoJmA3sUs9vKQbiicT6vVB3UZaG4dZBNUNdMJNSK7TemFZvIPzKCLGO6tWc31A9yCCmRVL0gp4j2iYU7ii9TCRILsq+KZATt3r02NXXTwpdTXenggqSaJ8lmvmx+lo/Lw9ngEQ8c0uUxyY5i2weK1VH06iRPlLOrIU/RHPRoytnScBb4hsOj0EIdxbtXUxHtN1GKmOCjr1ArVjf/EXczfsLekujQQKKLCBlOdGzpFqZ9shYUoZKOPji5MGH0cBQUK9Ky8FoFic8fBU94we5J/mE1S0H9cNnMxE+o+5L2I5SDupFW+Rwk7kduyLUdbKWgGcrmSUNckLwfwUq6Kp6lBcVYhiXYiu2evpMVFEGPbDN/2IqOSUfxIyxoYtbQL5xAiJBnUScojp98BUXyk62gWH5yFRTNT3ZP89HXoeclKMEC/ZwEJXl/ISNBKfTkJCiNn3ymfRL5yScHUVDU0wucmILsEh7+mlq3KnRer+QBcRW039z9+Mvf/8Y7r0fqoDgXsS9/vm/aoI/RzuuROih+ddCX36cfQwOf1yN1UDwr6d0PC6sip1tO6MejDkJzpoHP65w4MDnkoJR+PAUdyoh1UNpNCDxbsQ9Le0P2N51Uj28/6FP08yZDd09awR4fqp/Fkts56hakwQ8FIRQLUuGHghB6Benwo1eQEj9qBWnxo3baZ62CbMOp8UNBCAoC6BSkxw8FIUQE7TftgGPtv8nbKgSd9p662KzLIZwiP3KCLrancA63CkHdiyw+e3do8qMyB61BUPsw8Xjsq2u3cKr8iDXzjaO71+lN8CjIP5wuPxSEEBLkvxuwMj9Cgvx3A9bmR0aQ/16u6vxINfOeuwHr86MsB61FkO9uwAr9SLVifrsBr0iQVziNflRN+6xSkMMmbyr9aCpiFDQTrtDqR4Og5d+/I0n6WQ2lYnrSz2qsVZDtmLRyP+lnNVYriDloBpdZjVUKOtrPamj3k7wftGpBFhssae0enkkrSL2e1IIygIIAFARI3YqpJ5mgbEgkaC6m05xZ7MSTUBCAggAUBKAgAAUBKAhAQQAKAmTzbJAKCgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBAguqC7aBTJ2lKdlWDZHVEVhXqSBiXffvx27VyOfXa9njNCC6nb5kOUV1aeXYmyOqE6Lkl4sEu837eLAw7ZJU7VrvVyuZ5TAgsy0dPlok3a/aQXZHHHYPpo0MHFtliiblZTV/ZvL9YwTWNBwZRZpq4c/GkE2RwyCUOK6eL5YXtrkHJfrGSe0oHdtbp5aA/t10rYOsjqiL2IWiS/+WN6/OVzPBIEFmeJuU+jbzN8Ksjuiq2otEp9ltCsp7a9nimSC2oXE1oKavNAUL6v7HQTVfR2tSpB1lj4ltC1iQ03iUMTMSlx1Rcy6Uqy6VSgvNkcM+cAicSej2wNBXSXt1qyWls28uc3aqtU2gvr3s9U1824ds9K2o9jXQRaJa9MP6lcJausonsqO46OGzRFl/+QAE58EdQW4TelyPWPwYRVAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAmgXdF7Pmwjlgs7reVOhXNDyBVBLUS7IsGiBz0KyEFQyB80yvTNqBDIQVKesozMQlDT/ZCCoSutHvaDh+5ZSoVzQeT1vKpQLuljPmwjlgtJDQQAKAlAQgIIAFASgIEAGgq72Tug/nL8lRhj9gq5eiRs+mJdRI6Be0NVLlecPS97TdUK9oKtR6fOHKtYYkRZBh3+eTk9d3zybXr3Yff5Qvo80HaRFUPnw6bj7deRLy662Bhg+7Dft665lBENKBHVZ46P5VHYv1bfFaFyQSRejIlIiyNzq/qdvm6aJImb+9iQ/mqZL0MiXb05U0uZvEdp6JYKMmj5HXBax8WZ+2ItB/MqUCGrqld+a2x/7asnxjuLJ2Ioq6ePx889F8WH0qze7vRPMNlTDRgplv+2bMGoEaYWCABQEoCAABQH+BxlpLlreYs4YAAAAAElFTkSuQmCC" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAflBMVEUAAAAAADoAAGYAOpAAZrY6AAA6ADo6AGY6Ojo6OpA6ZmY6ZpA6ZrY6kNtmAABmADpmOgBmZmZmZrZmtttmtv+QOgCQOjqQZgCQZjqQZpCQtraQ2/+2ZgC2Zjq22/+2///bkDrbtpDb2//b////tmb/25D/27b//7b//9v////WpbNGAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAHqklEQVR4nO2da2ObNhSG1abZurXxbsmurGGbU9v//w8OIcA34D0SEjrA+3ypiaUjeCqEkAQ2JzKKyb0D2qEgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQYDIgsxiyCUobrh0UBCAggC6BZn8IlULqvxQEEqT2xAFSXYiasJo4UyKcr1RLyi3IQqS7UXEhLHCmZt/MzGzII9bHHP3IQtqa5Dp+ZSDBQjKa0irIDPweXYoCKBUkBnZmhcKAugUZEY3Z4WCACoF3X2Z0RAFATQKuv+OgsB3FHT1957v8hlSJsgO0/d9RUEXf6ag4XCDhVAQKiOboUSCivevp7dHY9795RNuO4JqP99Ucg675+soo0OumxF02D1Vkj7Yj+XDf+Jwfn2jmUgk6Pl0fHmyH/dVXZKG87v9mIlEp1hVe8qoNWhlgg679691FdoPtdIbF1SZcU3xB59wXmNEc6GoH+Q1CjsbyxGUyRAFxSo1uSBcQBZDifpB5x6zuB8kKCCHoTQ16Pgy4GUk3KYEVYYGL/BD4SQFZDCUrh/0PPp92MTFZaKZVgiraaRl8c3lp1kMLVnQLJVIhSCP2mCu/01vKLWgUnKZ93gqq8nYpTfpHue4KUmWfHKhfSOKXqGNC3P5hzSGfOtoolPMeIfuGa9NYihQ0PGP/gGwwOIjnSIJWuubxk6c4bB79/1Pf/6LUh9fRm80Lv5/Ip0h0Q2FCjp9/f1jdeCfxxOX5sl92LcfBsJF683EFmTuPnjtwddfB47b0QzYW8CYdLzjinyWTRR0evturCm6mA0DsxoxjypNLP82CA1knDxqUKL/9ZiRktSgqg1qqhBog5QKCuqkXSU8FqNt0LmiDdSftF2XqHECr2KfpvaGNAu6vU/0yuX6QV/i7kQ0EnQZcvekIxMjrBnZSlx0unAxw84gKGhWIw4xbuzCAnqVHDKrEYfpcc3oZqySA2Y14rAUQf6zGrGYGjh4rGkZjfTiBfm/Gsy7hMj5V1eDJka+y01BIDcFgdzrEzQp9H1eCgJ5KQhkXaGgCbEpyD8jBYGMaxQUGrw32yoFBUanoJBM6xQUFH5TgkLiU1BQjrUK8i+AgsIyJBu075/0ST+ieC4qTvI0gsQrzBKiWZB8hVlCNAuSrzBLiVcRg4nXW4M0CxKvMEuKZkGZVpiFlzGcdLX9IL8ytikoysFREEhIQSBdon5QthVmIaWMpkpTg/KtMAsoZTxRspvVTCvMAorJIijfCjPvYkCSVTfSuBw87rJ2QePPkU2vYAEJs4QLKUo2apdakOi5+bQMzFYI92DmGjTjkOtFoX17EZx5csIs4YSFWS+e/zmbEHQ6V1vvqjvzrEZguIysd1YjEisek47Dimc14pCtBi2GFIIEsxpjMQd6djoSDxJ5VmMs5hYETYpJQSAmBYGYFARirl+QYFZjLOb6BQlmNcZibkAQntUYi7kFQXBWY30s5uYpFxQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBogvaj/xM7S1FPfgvyVEa426TYeK3b+2ITD1H/uS7P33EFmR/HnLwJyJv09azI5IcpU1jDcHE9ncqrZ8qTWl/itFnf3qJLMjNLRaSUSM7QFkJkuRww1BVGph478Y63x5tdSub3/QU7k8/kQV1eyZIWz78VgmS5OgEocR783QxKV7VHJ/96Se2IPtL0IMz97dJbRskytGeYoLEF18W71899meAyILc6S456W3lt4JkOZqmVpD4LMPOj8v3Z4hsguzyB7Eg9zPuouPtBO3bNlqVIHGVrhNKT7GuJfE4xdz6CnWnmLhRLJv5tWdJjq4eCBI3MprFcOoaab/LaiG8zLvD3Iuu2k5Qu1BH3WXer2NWSDuKbRskSLx3/aB2/ZK2jmJ97njeakhyFO2dA0xcC2pOYJvSZ3/64M0qgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFARYgqBi/FUhaVmAoD14l0pa9Atyq4WzoV+QWy2cDfWCmtXC2dAuqF0tnA3tgtrVwtlQLqhbLZwN5YK61cLZ9kC5oBrWIAAFAShIMxQEoCAABQEoCEBBAAoCLEDQ1bsT2g33VtAJD8pJ0S/o6pG4bsM9jDoD6gVdPVR53pjynK4X6gVdPZZ73ihnOLtqtAg6/v1Yj2vcvSv/6sHu80bxsS9xArQIKh6+nN5+7rkpvXo1QLdx2Nkb2GIGQ0oENVXjs9sqmmEyexr1C3Lp5miIlAhyh3r44f7SNHCKue8e04806hK0uz/ggUbafTfDtV6JIKemrRGXp1j/Zb57F0PyPVMiqGpXfqkOv2/osL+jWBvbUCN9Ov3zozGfeodWm3cnuNdQdS9SKGaa61AjSCsUBKAgAAUBKAjwP/qI4sNMW89VAAAAAElFTkSuQmCC" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAgVBMVEUAAAAAADoAAGYAOjoAOpAAZrY6AAA6ADo6AGY6Ojo6OpA6ZmY6ZpA6ZrY6kNtmAABmADpmOgBmZmZmZrZmtttmtv+QOgCQOjqQZgCQZjqQZpCQtraQ2/+2ZgC2Zjq22/+2///bkDrbtpDb2//b////tmb/25D/27b//7b//9v////XB51oAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAGd0lEQVR4nO3daXubRhhGYezK7pZY3exupjGtcCT+/w8sm5BkC55BzDAv8jkfciXxaCD3xSYs4qSgwZLYK2A9gEQAiQASASQCSASQCCARQCKARACJABIBJAJIBJAIIBFAIoBEAIkAEgEkAkgEkAggEUAigEQAiQASASQCSASQCCARQCKARACJABIBJAJIBJAIIBFAIoBEAIkAEgEkAkgEkAggEUAigEQAiQASASQCSASQCCARQCKARACJABIBJAJIBJAIIBFAIoBEAIkAEgEkAkgEkAggEUAigEQAiQASASTyDJQsplhAfqcLF0AigEQA9ZYc/eo83PPSDbc/OgN0WrvZHE5eABUn1xzF21P7BwTaX94k3R8GRztPO3W9gk7nutQDR7ux6Jc4z33xWs0xncMCx1wVH7/O+8Ao06mlXWTTvNT7wCjTDSzowi2ne733gVGmez//2PeavRN5HxhlujeTT3c5zOV9YJTpjib2qVPMDjT+NsvYyb1P6n1glOmKw5sn39N6HxhjukCbZD2194GzTxcOp57d+8D5pgt3NDteiPeBs003z7UmQL6WYg5opjcrAPlajDWgud7tLhVovrsB3gfOMx1AQV8eYklmgGa4ODxZnPeBgaeb+2b2woDm3HbaJXofGG66WXetbqHeBwabLtK30rwPDDRdjK2nXq73gXVZuTs81r+5ffEwXZSdq12094FV2c1zsV3fFR6AZj6rv1++94Flu6eH+tfVZjJQ9E+BBAHaruvdq0hXm4lA0X1CbkFl6d00oPg+oY5BLct2nUwBMuAT7izW7GS7p1OgUd84tOBj+TrIhE9QoO5QdNl0AHlfYIjMAhnxMQtkxQcgldGzmBkfa0AnH/I2kS2g9m+jvn1/01ig3V+bcMs15NI1Fmi7vvnxl7//C7PcawAqvv75fXmU+BxkuVcBVPf19/4T+OXLtehz6UH69YeJh6KrBdquuxsWPXd6Ll/uVQC1hdiCTPpcCLRLAxyDrgSoOYt9mno1dLVAzXXQlwDLtelj6Er6SoDCLReg4emM+gCkAkhkBciqz9xAvd9ZBWh4OrM+AKkAEtkAsusDkAogEUAiE0CGfQBSASSyAGTZByAVQCKARACJDACZ9gFIBZAoKNDr/aPDdB8Q6OgzMg6PQ31AoCJP6k9/OG1Btn1C7WLb9WoD0GDpzTNAg2XJA0CDvd5/8w7ozDcOPy5QsXtK2IKGcnocyrgPQCqARACJABJFfzcP0PB01n0AUgEkAkgUGci8D0CquED2fQBSxT5Imw8gEUAigETRgBZTJKChOc//tZHBvQEkAkgEkAggEUAigEQAiQASLea9QawAEgEkAkgEkAggEUAigEQAiQASASQCSASQyDtQniQ3z45j0+rZIadXdD9cUQ5+/e6lqJ8GSJpnt8asz7l8A+Xl2uSOa5QnFZDLK6ofrphXQnLwdl096rd7Ksdkyd249TmbZ6DmI8LpncvY7boCcnnF7umuGSMH582zkM3zSNnty5j1OZ9noG7NHMZmqz9KIJdXdEBqcJ485IcvllvOmPU5n2+gb6utOXdZoXJodQxyesV+F3MYfPTF9PZlxPr05Bmo2d1ddvpq46+A3F7RHmodBh8wqids3denr2hAWYnjDFRuC+Xu5fTv7YDy/THaFJDzJl0PdN3FuiPJiF2seULb3C7mfFDM2k+hPLq8otsOHAa3GNnxE+yGDtLjTqup42m++WfmTmftBujw806NnebHXZilrheK+2OQw+C8uQ7aP7Fl7UKx3ndGvtVweUW6f+cgB9dA7Q5cjRyzPufizaoIIBFAIoBEAIkAEgEkAkgEkAggEUAigEQAiQASASQCSASQCCARQCKARACJABIBJAJIBJAIIBFAIutAh8/zRso40OHzvLEyDjT9A1BTMw7UNOkDPhNbBFDKFjRYHvMovQCgPOYxegFAUbefBQBlcX3MA2X9PwVmnowDHT7PGyvjQEef542UcaD4ASQCSASQCCARQCKARIsCinH/dUlAUe6/Lgkoyv3XJQE1zXz/1SDQ7p/7+g1Yz8Fm5vuvBoHS1Zfi9ddNz1fnvn9mD6j9vwA+N39K2+fr90fm2e+/2gNqHnzf/nT2SDP//VezQOtzdxIj3H+1B9TQ7H9k+8kuFuP+qz2g8jz+W3lNuHp/lI5y/9UgUPHvz0ny6cxZLMr9V4tApgJIBJAIIBFAov8BGd9OvZfsbjwAAAAASUVORK5CYII=" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1"></a><span class="co">#par(mfrow=c(2,2))</span></span>
<span id="cb32-2"><a href="#cb32-2"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>)</span>
<span id="cb32-3"><a href="#cb32-3"></a>{</span>
<span id="cb32-4"><a href="#cb32-4"></a>  <span class="kw">plot</span>(R[i,], <span class="dt">type=</span><span class="st">&quot;l&quot;</span>, <span class="dt">sub=</span><span class="kw">bquote</span>(sigma <span class="op">==</span><span class="st"> </span>.(sigma[i])),<span class="dt">xlab=</span><span class="st">&quot;&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;R&quot;</span>)</span>
<span id="cb32-5"><a href="#cb32-5"></a>  <span class="kw">abline</span>(<span class="dt">h=</span><span class="fl">1.2</span>, <span class="dt">lty=</span><span class="dv">2</span>,<span class="dt">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb32-6"><a href="#cb32-6"></a>}</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --></p>
<ul>
<li><p><strong>11.4</strong></p>
<p><strong>Bisection method</strong></p>
<p>Brent’s method is implemented in the R function uniroot, which searches for a zero of a univariate function between two points where the function has opposite signs.</p></li>
</ul>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1"></a>k&lt;-<span class="kw">c</span>(<span class="dv">4</span><span class="op">:</span><span class="dv">25</span>, <span class="dv">100</span>, <span class="dv">500</span>, <span class="dv">1000</span>)</span>
<span id="cb33-2"><a href="#cb33-2"></a>f.intersection_find &lt;-<span class="st"> </span><span class="cf">function</span>(k) </span>
<span id="cb33-3"><a href="#cb33-3"></a>{</span>
<span id="cb33-4"><a href="#cb33-4"></a>  <span class="co">#S_{k}(a)</span></span>
<span id="cb33-5"><a href="#cb33-5"></a>  S_k =<span class="st"> </span><span class="cf">function</span>(a) </span>
<span id="cb33-6"><a href="#cb33-6"></a>    <span class="dv">1</span><span class="op">-</span><span class="kw">pt</span>(<span class="kw">sqrt</span>(k<span class="op">*</span>a<span class="op">^</span><span class="dv">2</span> <span class="op">/</span>(k <span class="op">+</span><span class="st"> </span><span class="dv">1</span> <span class="op">-</span><span class="st"> </span>a<span class="op">^</span><span class="dv">2</span>)), <span class="dt">df=</span>k)</span>
<span id="cb33-7"><a href="#cb33-7"></a>  <span class="co">#S_{k-1}(a)</span></span>
<span id="cb33-8"><a href="#cb33-8"></a>  S_k1 &lt;-<span class="st"> </span><span class="cf">function</span>(a) </span>
<span id="cb33-9"><a href="#cb33-9"></a>    <span class="dv">1</span><span class="op">-</span><span class="kw">pt</span>(<span class="kw">sqrt</span>(  (k <span class="op">-</span><span class="st"> </span><span class="dv">1</span>)<span class="op">*</span>a<span class="op">^</span><span class="dv">2</span> <span class="op">/</span><span class="st"> </span>(k <span class="op">-</span><span class="st"> </span>a<span class="op">^</span><span class="dv">2</span>)), <span class="dt">df=</span>k<span class="dv">-1</span>)</span>
<span id="cb33-10"><a href="#cb33-10"></a>  <span class="co">#S_{k}(a)-S_{k-1}(a)</span></span>
<span id="cb33-11"><a href="#cb33-11"></a>  f =<span class="st"> </span><span class="cf">function</span>(a) </span>
<span id="cb33-12"><a href="#cb33-12"></a>    <span class="kw">S_k</span>(a) <span class="op">-</span><span class="st"> </span><span class="kw">S_k1</span>(a)</span>
<span id="cb33-13"><a href="#cb33-13"></a>  <span class="co">#open interval</span></span>
<span id="cb33-14"><a href="#cb33-14"></a>  eps &lt;-<span class="st"> </span>.Machine<span class="op">$</span>double.eps<span class="op">^</span><span class="fl">0.5</span></span>
<span id="cb33-15"><a href="#cb33-15"></a>  out &lt;-<span class="st"> </span><span class="kw">uniroot</span>(f, <span class="dt">interval =</span> <span class="kw">c</span>(<span class="dv">0</span><span class="op">+</span>eps, <span class="kw">sqrt</span>(k)<span class="op">-</span>eps),<span class="dt">tol =</span> .Machine<span class="op">$</span>double.eps<span class="op">^</span><span class="fl">0.25</span>)</span>
<span id="cb33-16"><a href="#cb33-16"></a>  <span class="kw">return</span>(<span class="kw">unlist</span>(out)[<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>])</span>
<span id="cb33-17"><a href="#cb33-17"></a>}</span>
<span id="cb33-18"><a href="#cb33-18"></a>res &lt;-<span class="st"> </span><span class="kw">sapply</span>(k, <span class="cf">function</span> (k) {<span class="kw">f.intersection_find</span>(k)})</span>
<span id="cb33-19"><a href="#cb33-19"></a>intersection_find&lt;-<span class="kw">data.frame</span>(<span class="dt">k=</span>k,<span class="dt">intersection=</span>res[<span class="dv">1</span>,],<span class="dt">f.root=</span>res[<span class="dv">2</span>,],<span class="dt">iter=</span>res[<span class="dv">3</span>,])</span>
<span id="cb33-20"><a href="#cb33-20"></a>knitr<span class="op">::</span><span class="kw">kable</span>(intersection_find)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">k</th>
<th align="right">intersection</th>
<th align="right">f.root</th>
<th align="right">iter</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">4</td>
<td align="right">1.492103</td>
<td align="right">0e+00</td>
<td align="right">7</td>
</tr>
<tr class="even">
<td align="right">5</td>
<td align="right">1.533548</td>
<td align="right">-1e-07</td>
<td align="right">7</td>
</tr>
<tr class="odd">
<td align="right">6</td>
<td align="right">1.562768</td>
<td align="right">2e-07</td>
<td align="right">8</td>
</tr>
<tr class="even">
<td align="right">7</td>
<td align="right">1.584421</td>
<td align="right">0e+00</td>
<td align="right">8</td>
</tr>
<tr class="odd">
<td align="right">8</td>
<td align="right">1.601182</td>
<td align="right">0e+00</td>
<td align="right">8</td>
</tr>
<tr class="even">
<td align="right">9</td>
<td align="right">1.614517</td>
<td align="right">0e+00</td>
<td align="right">8</td>
</tr>
<tr class="odd">
<td align="right">10</td>
<td align="right">1.625356</td>
<td align="right">-1e-07</td>
<td align="right">8</td>
</tr>
<tr class="even">
<td align="right">11</td>
<td align="right">1.634387</td>
<td align="right">0e+00</td>
<td align="right">7</td>
</tr>
<tr class="odd">
<td align="right">12</td>
<td align="right">1.642006</td>
<td align="right">0e+00</td>
<td align="right">7</td>
</tr>
<tr class="even">
<td align="right">13</td>
<td align="right">1.648569</td>
<td align="right">0e+00</td>
<td align="right">9</td>
</tr>
<tr class="odd">
<td align="right">14</td>
<td align="right">1.654176</td>
<td align="right">0e+00</td>
<td align="right">9</td>
</tr>
<tr class="even">
<td align="right">15</td>
<td align="right">1.659106</td>
<td align="right">0e+00</td>
<td align="right">9</td>
</tr>
<tr class="odd">
<td align="right">16</td>
<td align="right">1.663448</td>
<td align="right">0e+00</td>
<td align="right">9</td>
</tr>
<tr class="even">
<td align="right">17</td>
<td align="right">1.667294</td>
<td align="right">0e+00</td>
<td align="right">9</td>
</tr>
<tr class="odd">
<td align="right">18</td>
<td align="right">1.670731</td>
<td align="right">0e+00</td>
<td align="right">10</td>
</tr>
<tr class="even">
<td align="right">19</td>
<td align="right">1.673839</td>
<td align="right">0e+00</td>
<td align="right">10</td>
</tr>
<tr class="odd">
<td align="right">20</td>
<td align="right">1.676588</td>
<td align="right">0e+00</td>
<td align="right">10</td>
</tr>
<tr class="even">
<td align="right">21</td>
<td align="right">1.679139</td>
<td align="right">0e+00</td>
<td align="right">10</td>
</tr>
<tr class="odd">
<td align="right">22</td>
<td align="right">1.681461</td>
<td align="right">0e+00</td>
<td align="right">10</td>
</tr>
<tr class="even">
<td align="right">23</td>
<td align="right">4.795832</td>
<td align="right">0e+00</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="right">24</td>
<td align="right">4.898980</td>
<td align="right">0e+00</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="right">25</td>
<td align="right">5.000000</td>
<td align="right">0e+00</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="right">100</td>
<td align="right">10.000000</td>
<td align="right">0e+00</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="right">500</td>
<td align="right">22.360680</td>
<td align="right">0e+00</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="right">1000</td>
<td align="right">31.622777</td>
<td align="right">0e+00</td>
<td align="right">0</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="hw9" class="section level2">
<h2>HW9</h2>
<div id="question9" class="section level3">
<h3>Question9：</h3>
<ul>
<li><p><strong>Q1</strong></p>
<p><strong>A-B-O blood type problem</strong></p>
<p>Let the three alleles be A, B, and O.</p>
<table>
<thead>
<tr class="header">
<th>Genotype</th>
<th>AA</th>
<th>BB</th>
<th>OO</th>
<th>AO</th>
<th>BO</th>
<th>AB</th>
<th>Sum</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Frequency</td>
<td><span class="math inline">\(p^2\)</span></td>
<td><span class="math inline">\(q^2\)</span></td>
<td><span class="math inline">\(r^2\)</span></td>
<td><span class="math inline">\(2pr\)</span></td>
<td><span class="math inline">\(2qr\)</span></td>
<td><span class="math inline">\(2pq\)</span></td>
<td><span class="math inline">\(1\)</span></td>
</tr>
<tr class="even">
<td>Count</td>
<td>nAA</td>
<td>nBB</td>
<td>nOO</td>
<td>nAO</td>
<td>nBO</td>
<td>nAB</td>
<td>n</td>
</tr>
</tbody>
</table>
<p>Observed data: <span class="math inline">\(n_{A\cdot} = n_{AA} + n_{AO} = 444 (A-type)\)</span>,<span class="math inline">\(n_{B\cdot} = n_{BB} + n_{BO} = 132 (B-type)\)</span>, <span class="math inline">\(n_{OO} = 361 (O-type)\)</span>, <span class="math inline">\(n_{AB} = 63 (AB-type)\)</span>.</p>
<p>Use EM algorithm to solve MLE of <span class="math inline">\(p\)</span> and <span class="math inline">\(q\)</span> (consider missing data <span class="math inline">\(n_{AA}\)</span> and <span class="math inline">\(n_{BB}\)</span>).</p>
<p>Record the values of <span class="math inline">\(p\)</span> and <span class="math inline">\(q\)</span> that maximize the conditional likelihood in each EM steps, calculate the corresponding log-maximum likelihood values (for observed data), are they increasing?</p></li>
<li><p><strong>Exercise11.1.2.3</strong></p>
<p>Use both for loops and lapply() to fit linear models to the mtcars using the formulas stored in this list:</p>
<p>formulas &lt;- list(</p>
<p>mpg ~ disp,</p>
<p>mpg ~ I(1 / disp),</p>
<p>mpg ~ disp + wt,</p>
<p>mpg ~ I(1 / disp) + wt</p>
<p>)</p></li>
<li><p><strong>Exercise11.2.5.3</strong></p>
<p>The following code simulates the performance of a t-test for non-normal data. Use sapply() and an anonymous function to extract the p-value from every trial.</p>
<p>trials &lt;- replicate(</p>
<p>100,</p>
<p>t.test(rpois(10, 10), rpois(7, 10)),</p>
<p>simplify = FALSE</p>
<p>) Extra challenge: get rid of the anonymous function by using [[ directly.</p></li>
<li><p><strong>Exercise11.2.5.6</strong></p>
<p>Implement a combination of Map() and vapply() to create an lapply() variant that iterates in parallel over all of its inputs and stores its outputs in a vector (or a matrix). What arguments should the function take?</p></li>
</ul>
</div>
<div id="answer9" class="section level3">
<h3>Answer9：</h3>
<ul>
<li><p><strong>Q1</strong></p>
<p><strong>A-B-O blood type problem</strong></p>
<p>Obsered data: <span class="math inline">\(n_{A\cdot}\)</span>,<span class="math inline">\(n_{B\cdot}\)</span>,<span class="math inline">\(n_{OO}\)</span></p>
<p>Complete data: <span class="math inline">\(n_{AA}\)</span>,<span class="math inline">\(n_{BB}\)</span>,<span class="math inline">\(n_{OO}\)</span>,<span class="math inline">\(n_{AO}\)</span>,<span class="math inline">\(n_{BO}\)</span>,<span class="math inline">\(n_{AB}\)</span></p>
<p>According to the question, <span class="math display">\[p+q+r=1\]</span></p>
<p><strong>Rcode and results:</strong></p></li>
</ul>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1"></a><span class="kw">library</span>(nloptr)</span>
<span id="cb34-2"><a href="#cb34-2"></a><span class="co">#Maximum likelihood estimation</span></span>
<span id="cb34-3"><a href="#cb34-3"></a><span class="co">#objective function</span></span>
<span id="cb34-4"><a href="#cb34-4"></a>f.ob =<span class="st"> </span><span class="cf">function</span>(x_mstep,x_estep,n_A,n_B,nOO,nAB)</span>
<span id="cb34-5"><a href="#cb34-5"></a>{</span>
<span id="cb34-6"><a href="#cb34-6"></a>  </span>
<span id="cb34-7"><a href="#cb34-7"></a>  <span class="co">#E-step</span></span>
<span id="cb34-8"><a href="#cb34-8"></a>  r_estep =<span class="st"> </span><span class="dv">1</span><span class="op">-</span><span class="kw">sum</span>(x_estep)</span>
<span id="cb34-9"><a href="#cb34-9"></a>  nAA =<span class="st"> </span>n_A<span class="op">*</span>x_estep[<span class="dv">1</span>]<span class="op">^</span><span class="dv">2</span><span class="op">/</span>(x_estep[<span class="dv">1</span>]<span class="op">^</span><span class="dv">2</span><span class="op">+</span><span class="dv">2</span><span class="op">*</span>x_estep[<span class="dv">1</span>]<span class="op">*</span>r_estep)</span>
<span id="cb34-10"><a href="#cb34-10"></a>  nBB =<span class="st"> </span>n_B<span class="op">*</span>x_estep[<span class="dv">2</span>]<span class="op">^</span><span class="dv">2</span><span class="op">/</span>(x_estep[<span class="dv">2</span>]<span class="op">^</span><span class="dv">2</span><span class="op">+</span><span class="dv">2</span><span class="op">*</span>x_estep[<span class="dv">2</span>]<span class="op">*</span>r_estep)</span>
<span id="cb34-11"><a href="#cb34-11"></a>  <span class="co">#M-step</span></span>
<span id="cb34-12"><a href="#cb34-12"></a>  r_mstep =<span class="st"> </span><span class="dv">1</span><span class="op">-</span><span class="kw">sum</span>(x_mstep)</span>
<span id="cb34-13"><a href="#cb34-13"></a>  l1 &lt;-<span class="st"> </span><span class="dv">2</span><span class="op">*</span>nAA<span class="op">*</span><span class="kw">log</span>(x_mstep[<span class="dv">1</span>])<span class="op">+</span><span class="dv">2</span><span class="op">*</span>nBB<span class="op">*</span><span class="kw">log</span>(x_mstep[<span class="dv">2</span>])<span class="op">+</span><span class="dv">2</span><span class="op">*</span>nOO<span class="op">*</span><span class="kw">log</span>(r_mstep)</span>
<span id="cb34-14"><a href="#cb34-14"></a>  l2 &lt;-<span class="st"> </span>(n_A<span class="op">-</span>nAA)<span class="op">*</span><span class="kw">log</span>(<span class="dv">2</span><span class="op">*</span>x_mstep[<span class="dv">1</span>]<span class="op">*</span>r_mstep)<span class="op">+</span>(n_B<span class="op">-</span>nBB)<span class="op">*</span><span class="kw">log</span>(<span class="dv">2</span><span class="op">*</span>x_mstep[<span class="dv">2</span>]<span class="op">*</span>r_mstep)<span class="op">+</span>nAB<span class="op">*</span><span class="kw">log</span>(<span class="dv">2</span><span class="op">*</span>x_mstep[<span class="dv">1</span>]<span class="op">*</span>x_mstep[<span class="dv">2</span>])</span>
<span id="cb34-15"><a href="#cb34-15"></a>  <span class="co">#log-likelihood function</span></span>
<span id="cb34-16"><a href="#cb34-16"></a>  ll &lt;-<span class="st"> </span>l1<span class="op">+</span>l2</span>
<span id="cb34-17"><a href="#cb34-17"></a>  <span class="kw">return</span>(<span class="op">-</span>ll)</span>
<span id="cb34-18"><a href="#cb34-18"></a>}</span>
<span id="cb34-19"><a href="#cb34-19"></a><span class="co">#Constraint condition</span></span>
<span id="cb34-20"><a href="#cb34-20"></a>f.cc &lt;-<span class="st"> </span><span class="cf">function</span>(x_mstep,x_estep,n_A,n_B,nOO,nAB) </span>
<span id="cb34-21"><a href="#cb34-21"></a>{</span>
<span id="cb34-22"><a href="#cb34-22"></a>  <span class="kw">return</span>(<span class="kw">sum</span>(x_mstep)<span class="op">-</span><span class="fl">0.9999999</span>)</span>
<span id="cb34-23"><a href="#cb34-23"></a>}</span>
<span id="cb34-24"><a href="#cb34-24"></a>para &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>)</span>
<span id="cb34-25"><a href="#cb34-25"></a><span class="co">#p0 and q0</span></span>
<span id="cb34-26"><a href="#cb34-26"></a>para &lt;-<span class="st"> </span><span class="kw">rbind</span>(para,<span class="kw">c</span>(<span class="fl">0.25</span>,<span class="fl">0.15</span>))</span>
<span id="cb34-27"><a href="#cb34-27"></a>EM &lt;-<span class="st"> </span><span class="ot">NULL</span></span>
<span id="cb34-28"><a href="#cb34-28"></a>i &lt;-<span class="st"> </span><span class="dv">2</span></span>
<span id="cb34-29"><a href="#cb34-29"></a><span class="cf">while</span> (<span class="kw">mean</span>(<span class="kw">abs</span>(para[i,]<span class="op">-</span>para[i<span class="dv">-1</span>,]))<span class="op">&gt;</span><span class="fl">1e-8</span>) </span>
<span id="cb34-30"><a href="#cb34-30"></a>{</span>
<span id="cb34-31"><a href="#cb34-31"></a>  res &lt;-<span class="st"> </span><span class="kw">nloptr</span>( <span class="dt">x0=</span><span class="kw">c</span>(<span class="fl">0.32</span>,<span class="fl">0.12</span>),<span class="dt">eval_f =</span> f.ob,</span>
<span id="cb34-32"><a href="#cb34-32"></a>                 <span class="dt">lb =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>), <span class="dt">ub =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>), </span>
<span id="cb34-33"><a href="#cb34-33"></a>                 <span class="dt">eval_g_ineq =</span> f.cc, </span>
<span id="cb34-34"><a href="#cb34-34"></a>                 <span class="co">##a fractional tolerance xtol_rel</span></span>
<span id="cb34-35"><a href="#cb34-35"></a>                 <span class="dt">opts =</span> <span class="kw">list</span>(<span class="st">&quot;algorithm&quot;</span>=<span class="st">&quot;NLOPT_LN_COBYLA&quot;</span>,<span class="st">&quot;xtol_rel&quot;</span>=<span class="fl">1.0e-8</span>),</span>
<span id="cb34-36"><a href="#cb34-36"></a>                 <span class="dt">x_estep=</span>para[i,],<span class="dt">n_A=</span><span class="dv">444</span>,<span class="dt">n_B=</span><span class="dv">132</span>,<span class="dt">nOO=</span><span class="dv">361</span>,<span class="dt">nAB=</span><span class="dv">63</span>)</span>
<span id="cb34-37"><a href="#cb34-37"></a>  para &lt;-<span class="st"> </span><span class="kw">rbind</span>(para,res<span class="op">$</span>solution)</span>
<span id="cb34-38"><a href="#cb34-38"></a>  EM &lt;-<span class="st"> </span><span class="kw">c</span>(EM,res<span class="op">$</span>objective)</span>
<span id="cb34-39"><a href="#cb34-39"></a>  i &lt;-<span class="st"> </span>i<span class="op">+</span><span class="dv">1</span></span>
<span id="cb34-40"><a href="#cb34-40"></a>}</span>
<span id="cb34-41"><a href="#cb34-41"></a><span class="co">#EM algorithm estimate</span></span>
<span id="cb34-42"><a href="#cb34-42"></a><span class="kw">print</span>(para[<span class="op">-</span><span class="dv">1</span>,])</span>
<span id="cb34-43"><a href="#cb34-43"></a><span class="co">#&gt;            [,1]      [,2]</span></span>
<span id="cb34-44"><a href="#cb34-44"></a><span class="co">#&gt;  [1,] 0.2500000 0.1500000</span></span>
<span id="cb34-45"><a href="#cb34-45"></a><span class="co">#&gt;  [2,] 0.2917759 0.1048333</span></span>
<span id="cb34-46"><a href="#cb34-46"></a><span class="co">#&gt;  [3,] 0.2967244 0.1027752</span></span>
<span id="cb34-47"><a href="#cb34-47"></a><span class="co">#&gt;  [4,] 0.2974819 0.1027027</span></span>
<span id="cb34-48"><a href="#cb34-48"></a><span class="co">#&gt;  [5,] 0.2976122 0.1027048</span></span>
<span id="cb34-49"><a href="#cb34-49"></a><span class="co">#&gt;  [6,] 0.2976355 0.1027060</span></span>
<span id="cb34-50"><a href="#cb34-50"></a><span class="co">#&gt;  [7,] 0.2976397 0.1027062</span></span>
<span id="cb34-51"><a href="#cb34-51"></a><span class="co">#&gt;  [8,] 0.2976405 0.1027062</span></span>
<span id="cb34-52"><a href="#cb34-52"></a><span class="co">#&gt;  [9,] 0.2976406 0.1027063</span></span>
<span id="cb34-53"><a href="#cb34-53"></a><span class="co">#&gt; [10,] 0.2976407 0.1027063</span></span>
<span id="cb34-54"><a href="#cb34-54"></a><span class="co">#&gt; [11,] 0.2976407 0.1027063</span></span>
<span id="cb34-55"><a href="#cb34-55"></a><span class="co">#Objective function value</span></span>
<span id="cb34-56"><a href="#cb34-56"></a><span class="kw">plot</span>(EM,<span class="dt">type =</span> <span class="st">&#39;l&#39;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<ul>
<li><strong>Exercise11.1.2.3</strong></li>
</ul>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1"></a><span class="kw">library</span>(base)</span>
<span id="cb35-2"><a href="#cb35-2"></a>formulas &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="co">#four models</span></span>
<span id="cb35-3"><a href="#cb35-3"></a>  mpg <span class="op">~</span><span class="st"> </span>disp,</span>
<span id="cb35-4"><a href="#cb35-4"></a>  mpg <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span>disp),</span>
<span id="cb35-5"><a href="#cb35-5"></a>  mpg <span class="op">~</span><span class="st"> </span>disp <span class="op">+</span><span class="st"> </span>wt,</span>
<span id="cb35-6"><a href="#cb35-6"></a>  mpg <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span>disp) <span class="op">+</span><span class="st"> </span>wt</span>
<span id="cb35-7"><a href="#cb35-7"></a>)</span>
<span id="cb35-8"><a href="#cb35-8"></a><span class="kw">data</span>(<span class="st">&quot;mtcars&quot;</span>)</span>
<span id="cb35-9"><a href="#cb35-9"></a><span class="kw">attach</span>(mtcars)</span>
<span id="cb35-10"><a href="#cb35-10"></a><span class="co">#using loop</span></span>
<span id="cb35-11"><a href="#cb35-11"></a>Models1 &lt;-<span class="st">  </span><span class="kw">vector</span>(<span class="st">&quot;list&quot;</span>, <span class="kw">length</span>(formulas))</span>
<span id="cb35-12"><a href="#cb35-12"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(formulas)) </span>
<span id="cb35-13"><a href="#cb35-13"></a>  Models1[[i]] &lt;-<span class="st"> </span><span class="kw">lm</span>(formulas[[i]], <span class="dt">data =</span> mtcars)</span>
<span id="cb35-14"><a href="#cb35-14"></a><span class="kw">print</span>(Models1)</span>
<span id="cb35-15"><a href="#cb35-15"></a><span class="co">#&gt; [[1]]</span></span>
<span id="cb35-16"><a href="#cb35-16"></a><span class="co">#&gt; </span></span>
<span id="cb35-17"><a href="#cb35-17"></a><span class="co">#&gt; Call:</span></span>
<span id="cb35-18"><a href="#cb35-18"></a><span class="co">#&gt; lm(formula = formulas[[i]], data = mtcars)</span></span>
<span id="cb35-19"><a href="#cb35-19"></a><span class="co">#&gt; </span></span>
<span id="cb35-20"><a href="#cb35-20"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb35-21"><a href="#cb35-21"></a><span class="co">#&gt; (Intercept)         disp  </span></span>
<span id="cb35-22"><a href="#cb35-22"></a><span class="co">#&gt;    29.59985     -0.04122  </span></span>
<span id="cb35-23"><a href="#cb35-23"></a><span class="co">#&gt; </span></span>
<span id="cb35-24"><a href="#cb35-24"></a><span class="co">#&gt; </span></span>
<span id="cb35-25"><a href="#cb35-25"></a><span class="co">#&gt; [[2]]</span></span>
<span id="cb35-26"><a href="#cb35-26"></a><span class="co">#&gt; </span></span>
<span id="cb35-27"><a href="#cb35-27"></a><span class="co">#&gt; Call:</span></span>
<span id="cb35-28"><a href="#cb35-28"></a><span class="co">#&gt; lm(formula = formulas[[i]], data = mtcars)</span></span>
<span id="cb35-29"><a href="#cb35-29"></a><span class="co">#&gt; </span></span>
<span id="cb35-30"><a href="#cb35-30"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb35-31"><a href="#cb35-31"></a><span class="co">#&gt; (Intercept)    I(1/disp)  </span></span>
<span id="cb35-32"><a href="#cb35-32"></a><span class="co">#&gt;       10.75      1557.67  </span></span>
<span id="cb35-33"><a href="#cb35-33"></a><span class="co">#&gt; </span></span>
<span id="cb35-34"><a href="#cb35-34"></a><span class="co">#&gt; </span></span>
<span id="cb35-35"><a href="#cb35-35"></a><span class="co">#&gt; [[3]]</span></span>
<span id="cb35-36"><a href="#cb35-36"></a><span class="co">#&gt; </span></span>
<span id="cb35-37"><a href="#cb35-37"></a><span class="co">#&gt; Call:</span></span>
<span id="cb35-38"><a href="#cb35-38"></a><span class="co">#&gt; lm(formula = formulas[[i]], data = mtcars)</span></span>
<span id="cb35-39"><a href="#cb35-39"></a><span class="co">#&gt; </span></span>
<span id="cb35-40"><a href="#cb35-40"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb35-41"><a href="#cb35-41"></a><span class="co">#&gt; (Intercept)         disp           wt  </span></span>
<span id="cb35-42"><a href="#cb35-42"></a><span class="co">#&gt;    34.96055     -0.01772     -3.35083  </span></span>
<span id="cb35-43"><a href="#cb35-43"></a><span class="co">#&gt; </span></span>
<span id="cb35-44"><a href="#cb35-44"></a><span class="co">#&gt; </span></span>
<span id="cb35-45"><a href="#cb35-45"></a><span class="co">#&gt; [[4]]</span></span>
<span id="cb35-46"><a href="#cb35-46"></a><span class="co">#&gt; </span></span>
<span id="cb35-47"><a href="#cb35-47"></a><span class="co">#&gt; Call:</span></span>
<span id="cb35-48"><a href="#cb35-48"></a><span class="co">#&gt; lm(formula = formulas[[i]], data = mtcars)</span></span>
<span id="cb35-49"><a href="#cb35-49"></a><span class="co">#&gt; </span></span>
<span id="cb35-50"><a href="#cb35-50"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb35-51"><a href="#cb35-51"></a><span class="co">#&gt; (Intercept)    I(1/disp)           wt  </span></span>
<span id="cb35-52"><a href="#cb35-52"></a><span class="co">#&gt;      19.024     1142.560       -1.798</span></span>
<span id="cb35-53"><a href="#cb35-53"></a><span class="co"># using lapply</span></span>
<span id="cb35-54"><a href="#cb35-54"></a>Models2 &lt;-<span class="st"> </span><span class="kw">lapply</span>(<span class="dt">X =</span> formulas, <span class="dt">FUN =</span> <span class="cf">function</span>(model){ y &lt;-<span class="st"> </span><span class="kw">lm</span>(model, <span class="dt">data =</span> mtcars)})</span>
<span id="cb35-55"><a href="#cb35-55"></a><span class="co"># print the models in list</span></span>
<span id="cb35-56"><a href="#cb35-56"></a><span class="kw">print</span>(Models2)</span>
<span id="cb35-57"><a href="#cb35-57"></a><span class="co">#&gt; [[1]]</span></span>
<span id="cb35-58"><a href="#cb35-58"></a><span class="co">#&gt; </span></span>
<span id="cb35-59"><a href="#cb35-59"></a><span class="co">#&gt; Call:</span></span>
<span id="cb35-60"><a href="#cb35-60"></a><span class="co">#&gt; lm(formula = model, data = mtcars)</span></span>
<span id="cb35-61"><a href="#cb35-61"></a><span class="co">#&gt; </span></span>
<span id="cb35-62"><a href="#cb35-62"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb35-63"><a href="#cb35-63"></a><span class="co">#&gt; (Intercept)         disp  </span></span>
<span id="cb35-64"><a href="#cb35-64"></a><span class="co">#&gt;    29.59985     -0.04122  </span></span>
<span id="cb35-65"><a href="#cb35-65"></a><span class="co">#&gt; </span></span>
<span id="cb35-66"><a href="#cb35-66"></a><span class="co">#&gt; </span></span>
<span id="cb35-67"><a href="#cb35-67"></a><span class="co">#&gt; [[2]]</span></span>
<span id="cb35-68"><a href="#cb35-68"></a><span class="co">#&gt; </span></span>
<span id="cb35-69"><a href="#cb35-69"></a><span class="co">#&gt; Call:</span></span>
<span id="cb35-70"><a href="#cb35-70"></a><span class="co">#&gt; lm(formula = model, data = mtcars)</span></span>
<span id="cb35-71"><a href="#cb35-71"></a><span class="co">#&gt; </span></span>
<span id="cb35-72"><a href="#cb35-72"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb35-73"><a href="#cb35-73"></a><span class="co">#&gt; (Intercept)    I(1/disp)  </span></span>
<span id="cb35-74"><a href="#cb35-74"></a><span class="co">#&gt;       10.75      1557.67  </span></span>
<span id="cb35-75"><a href="#cb35-75"></a><span class="co">#&gt; </span></span>
<span id="cb35-76"><a href="#cb35-76"></a><span class="co">#&gt; </span></span>
<span id="cb35-77"><a href="#cb35-77"></a><span class="co">#&gt; [[3]]</span></span>
<span id="cb35-78"><a href="#cb35-78"></a><span class="co">#&gt; </span></span>
<span id="cb35-79"><a href="#cb35-79"></a><span class="co">#&gt; Call:</span></span>
<span id="cb35-80"><a href="#cb35-80"></a><span class="co">#&gt; lm(formula = model, data = mtcars)</span></span>
<span id="cb35-81"><a href="#cb35-81"></a><span class="co">#&gt; </span></span>
<span id="cb35-82"><a href="#cb35-82"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb35-83"><a href="#cb35-83"></a><span class="co">#&gt; (Intercept)         disp           wt  </span></span>
<span id="cb35-84"><a href="#cb35-84"></a><span class="co">#&gt;    34.96055     -0.01772     -3.35083  </span></span>
<span id="cb35-85"><a href="#cb35-85"></a><span class="co">#&gt; </span></span>
<span id="cb35-86"><a href="#cb35-86"></a><span class="co">#&gt; </span></span>
<span id="cb35-87"><a href="#cb35-87"></a><span class="co">#&gt; [[4]]</span></span>
<span id="cb35-88"><a href="#cb35-88"></a><span class="co">#&gt; </span></span>
<span id="cb35-89"><a href="#cb35-89"></a><span class="co">#&gt; Call:</span></span>
<span id="cb35-90"><a href="#cb35-90"></a><span class="co">#&gt; lm(formula = model, data = mtcars)</span></span>
<span id="cb35-91"><a href="#cb35-91"></a><span class="co">#&gt; </span></span>
<span id="cb35-92"><a href="#cb35-92"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb35-93"><a href="#cb35-93"></a><span class="co">#&gt; (Intercept)    I(1/disp)           wt  </span></span>
<span id="cb35-94"><a href="#cb35-94"></a><span class="co">#&gt;      19.024     1142.560       -1.798</span></span></code></pre></div>
<ul>
<li><strong>Exercise11.2.5.3</strong></li>
</ul>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1"></a><span class="co">###12.3</span></span>
<span id="cb36-2"><a href="#cb36-2"></a><span class="kw">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb36-3"><a href="#cb36-3"></a>trials &lt;-<span class="st"> </span><span class="kw">replicate</span>(</span>
<span id="cb36-4"><a href="#cb36-4"></a>  <span class="co">#generate 100 p values</span></span>
<span id="cb36-5"><a href="#cb36-5"></a>  <span class="dv">100</span>,</span>
<span id="cb36-6"><a href="#cb36-6"></a>  <span class="co">#use 10+7 Poisson random values to generate one p value</span></span>
<span id="cb36-7"><a href="#cb36-7"></a>  <span class="kw">t.test</span>(<span class="kw">rpois</span>(<span class="dv">10</span>, <span class="dv">10</span>), <span class="kw">rpois</span>(<span class="dv">7</span>, <span class="dv">10</span>)),</span>
<span id="cb36-8"><a href="#cb36-8"></a>  <span class="dt">simplify =</span> <span class="ot">FALSE</span></span>
<span id="cb36-9"><a href="#cb36-9"></a>)</span>
<span id="cb36-10"><a href="#cb36-10"></a>p.value1 &lt;-<span class="st"> </span><span class="kw">sapply</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(trials), <span class="cf">function</span>(index) trials[[index]]<span class="op">$</span>p.value)</span>
<span id="cb36-11"><a href="#cb36-11"></a>p.value2 &lt;-<span class="st"> </span><span class="kw">sapply</span>(trials, <span class="cf">function</span>(X) X[[<span class="st">&#39;p.value&#39;</span>]])</span>
<span id="cb36-12"><a href="#cb36-12"></a><span class="co"># [[ is a function return trials[[]]</span></span>
<span id="cb36-13"><a href="#cb36-13"></a>p.value3 &lt;-<span class="st"> </span><span class="kw">sapply</span>(trials, <span class="st">&#39;[[&#39;</span>, <span class="st">&#39;p.value&#39;</span>)</span>
<span id="cb36-14"><a href="#cb36-14"></a><span class="co">#Returns the first parts (10)</span></span>
<span id="cb36-15"><a href="#cb36-15"></a><span class="kw">print</span>(p.value1)</span>
<span id="cb36-16"><a href="#cb36-16"></a><span class="co">#&gt;   [1] 9.813226e-01 1.619096e-05 6.242135e-01 6.693526e-01 5.677105e-01</span></span>
<span id="cb36-17"><a href="#cb36-17"></a><span class="co">#&gt;   [6] 6.610740e-01 5.951636e-01 5.005347e-01 4.763110e-01 3.429965e-01</span></span>
<span id="cb36-18"><a href="#cb36-18"></a><span class="co">#&gt;  [11] 8.155394e-01 7.197238e-01 1.244336e-01 2.229164e-01 1.113099e-02</span></span>
<span id="cb36-19"><a href="#cb36-19"></a><span class="co">#&gt;  [16] 4.625765e-01 6.515865e-01 1.658793e-01 9.342672e-01 8.011934e-01</span></span>
<span id="cb36-20"><a href="#cb36-20"></a><span class="co">#&gt;  [21] 4.627657e-01 5.927934e-01 2.929669e-01 5.737967e-01 3.451537e-02</span></span>
<span id="cb36-21"><a href="#cb36-21"></a><span class="co">#&gt;  [26] 2.739138e-01 2.656151e-01 8.196695e-01 6.647355e-01 8.056529e-01</span></span>
<span id="cb36-22"><a href="#cb36-22"></a><span class="co">#&gt;  [31] 5.060850e-01 7.106543e-01 2.321066e-01 1.106223e-01 5.459279e-01</span></span>
<span id="cb36-23"><a href="#cb36-23"></a><span class="co">#&gt;  [36] 1.865470e-02 2.433776e-01 2.688851e-01 9.819256e-01 4.940184e-01</span></span>
<span id="cb36-24"><a href="#cb36-24"></a><span class="co">#&gt;  [41] 3.268275e-01 8.000439e-01 9.822499e-01 1.936454e-01 7.390101e-01</span></span>
<span id="cb36-25"><a href="#cb36-25"></a><span class="co">#&gt;  [46] 3.888930e-02 4.350424e-01 7.434339e-02 5.787441e-01 4.864951e-01</span></span>
<span id="cb36-26"><a href="#cb36-26"></a><span class="co">#&gt;  [51] 1.476288e-01 5.524909e-01 7.129280e-01 8.683479e-03 9.053256e-02</span></span>
<span id="cb36-27"><a href="#cb36-27"></a><span class="co">#&gt;  [56] 4.415463e-01 4.955063e-01 1.745328e-01 6.615399e-01 4.479199e-01</span></span>
<span id="cb36-28"><a href="#cb36-28"></a><span class="co">#&gt;  [61] 2.885849e-01 3.028567e-02 1.018907e-01 1.811861e-02 6.376441e-01</span></span>
<span id="cb36-29"><a href="#cb36-29"></a><span class="co">#&gt;  [66] 1.408742e-02 9.008128e-02 4.515933e-01 8.703291e-01 7.250768e-01</span></span>
<span id="cb36-30"><a href="#cb36-30"></a><span class="co">#&gt;  [71] 8.183571e-01 8.465036e-01 8.786838e-01 1.651543e-01 3.951569e-01</span></span>
<span id="cb36-31"><a href="#cb36-31"></a><span class="co">#&gt;  [76] 1.754280e-01 3.649865e-01 7.224226e-02 6.565152e-01 9.946559e-01</span></span>
<span id="cb36-32"><a href="#cb36-32"></a><span class="co">#&gt;  [81] 3.715952e-01 8.424336e-02 4.549887e-01 8.530113e-01 1.970777e-01</span></span>
<span id="cb36-33"><a href="#cb36-33"></a><span class="co">#&gt;  [86] 2.298117e-01 1.148832e-01 7.769502e-01 4.934348e-01 3.526049e-01</span></span>
<span id="cb36-34"><a href="#cb36-34"></a><span class="co">#&gt;  [91] 2.036013e-01 8.838914e-01 6.474880e-02 4.089082e-01 5.780132e-01</span></span>
<span id="cb36-35"><a href="#cb36-35"></a><span class="co">#&gt;  [96] 8.011408e-01 5.956061e-01 9.266689e-01 9.923205e-02 1.763972e-01</span></span>
<span id="cb36-36"><a href="#cb36-36"></a><span class="kw">print</span>(p.value2)</span>
<span id="cb36-37"><a href="#cb36-37"></a><span class="co">#&gt;   [1] 9.813226e-01 1.619096e-05 6.242135e-01 6.693526e-01 5.677105e-01</span></span>
<span id="cb36-38"><a href="#cb36-38"></a><span class="co">#&gt;   [6] 6.610740e-01 5.951636e-01 5.005347e-01 4.763110e-01 3.429965e-01</span></span>
<span id="cb36-39"><a href="#cb36-39"></a><span class="co">#&gt;  [11] 8.155394e-01 7.197238e-01 1.244336e-01 2.229164e-01 1.113099e-02</span></span>
<span id="cb36-40"><a href="#cb36-40"></a><span class="co">#&gt;  [16] 4.625765e-01 6.515865e-01 1.658793e-01 9.342672e-01 8.011934e-01</span></span>
<span id="cb36-41"><a href="#cb36-41"></a><span class="co">#&gt;  [21] 4.627657e-01 5.927934e-01 2.929669e-01 5.737967e-01 3.451537e-02</span></span>
<span id="cb36-42"><a href="#cb36-42"></a><span class="co">#&gt;  [26] 2.739138e-01 2.656151e-01 8.196695e-01 6.647355e-01 8.056529e-01</span></span>
<span id="cb36-43"><a href="#cb36-43"></a><span class="co">#&gt;  [31] 5.060850e-01 7.106543e-01 2.321066e-01 1.106223e-01 5.459279e-01</span></span>
<span id="cb36-44"><a href="#cb36-44"></a><span class="co">#&gt;  [36] 1.865470e-02 2.433776e-01 2.688851e-01 9.819256e-01 4.940184e-01</span></span>
<span id="cb36-45"><a href="#cb36-45"></a><span class="co">#&gt;  [41] 3.268275e-01 8.000439e-01 9.822499e-01 1.936454e-01 7.390101e-01</span></span>
<span id="cb36-46"><a href="#cb36-46"></a><span class="co">#&gt;  [46] 3.888930e-02 4.350424e-01 7.434339e-02 5.787441e-01 4.864951e-01</span></span>
<span id="cb36-47"><a href="#cb36-47"></a><span class="co">#&gt;  [51] 1.476288e-01 5.524909e-01 7.129280e-01 8.683479e-03 9.053256e-02</span></span>
<span id="cb36-48"><a href="#cb36-48"></a><span class="co">#&gt;  [56] 4.415463e-01 4.955063e-01 1.745328e-01 6.615399e-01 4.479199e-01</span></span>
<span id="cb36-49"><a href="#cb36-49"></a><span class="co">#&gt;  [61] 2.885849e-01 3.028567e-02 1.018907e-01 1.811861e-02 6.376441e-01</span></span>
<span id="cb36-50"><a href="#cb36-50"></a><span class="co">#&gt;  [66] 1.408742e-02 9.008128e-02 4.515933e-01 8.703291e-01 7.250768e-01</span></span>
<span id="cb36-51"><a href="#cb36-51"></a><span class="co">#&gt;  [71] 8.183571e-01 8.465036e-01 8.786838e-01 1.651543e-01 3.951569e-01</span></span>
<span id="cb36-52"><a href="#cb36-52"></a><span class="co">#&gt;  [76] 1.754280e-01 3.649865e-01 7.224226e-02 6.565152e-01 9.946559e-01</span></span>
<span id="cb36-53"><a href="#cb36-53"></a><span class="co">#&gt;  [81] 3.715952e-01 8.424336e-02 4.549887e-01 8.530113e-01 1.970777e-01</span></span>
<span id="cb36-54"><a href="#cb36-54"></a><span class="co">#&gt;  [86] 2.298117e-01 1.148832e-01 7.769502e-01 4.934348e-01 3.526049e-01</span></span>
<span id="cb36-55"><a href="#cb36-55"></a><span class="co">#&gt;  [91] 2.036013e-01 8.838914e-01 6.474880e-02 4.089082e-01 5.780132e-01</span></span>
<span id="cb36-56"><a href="#cb36-56"></a><span class="co">#&gt;  [96] 8.011408e-01 5.956061e-01 9.266689e-01 9.923205e-02 1.763972e-01</span></span>
<span id="cb36-57"><a href="#cb36-57"></a><span class="kw">print</span>(p.value3)</span>
<span id="cb36-58"><a href="#cb36-58"></a><span class="co">#&gt;   [1] 9.813226e-01 1.619096e-05 6.242135e-01 6.693526e-01 5.677105e-01</span></span>
<span id="cb36-59"><a href="#cb36-59"></a><span class="co">#&gt;   [6] 6.610740e-01 5.951636e-01 5.005347e-01 4.763110e-01 3.429965e-01</span></span>
<span id="cb36-60"><a href="#cb36-60"></a><span class="co">#&gt;  [11] 8.155394e-01 7.197238e-01 1.244336e-01 2.229164e-01 1.113099e-02</span></span>
<span id="cb36-61"><a href="#cb36-61"></a><span class="co">#&gt;  [16] 4.625765e-01 6.515865e-01 1.658793e-01 9.342672e-01 8.011934e-01</span></span>
<span id="cb36-62"><a href="#cb36-62"></a><span class="co">#&gt;  [21] 4.627657e-01 5.927934e-01 2.929669e-01 5.737967e-01 3.451537e-02</span></span>
<span id="cb36-63"><a href="#cb36-63"></a><span class="co">#&gt;  [26] 2.739138e-01 2.656151e-01 8.196695e-01 6.647355e-01 8.056529e-01</span></span>
<span id="cb36-64"><a href="#cb36-64"></a><span class="co">#&gt;  [31] 5.060850e-01 7.106543e-01 2.321066e-01 1.106223e-01 5.459279e-01</span></span>
<span id="cb36-65"><a href="#cb36-65"></a><span class="co">#&gt;  [36] 1.865470e-02 2.433776e-01 2.688851e-01 9.819256e-01 4.940184e-01</span></span>
<span id="cb36-66"><a href="#cb36-66"></a><span class="co">#&gt;  [41] 3.268275e-01 8.000439e-01 9.822499e-01 1.936454e-01 7.390101e-01</span></span>
<span id="cb36-67"><a href="#cb36-67"></a><span class="co">#&gt;  [46] 3.888930e-02 4.350424e-01 7.434339e-02 5.787441e-01 4.864951e-01</span></span>
<span id="cb36-68"><a href="#cb36-68"></a><span class="co">#&gt;  [51] 1.476288e-01 5.524909e-01 7.129280e-01 8.683479e-03 9.053256e-02</span></span>
<span id="cb36-69"><a href="#cb36-69"></a><span class="co">#&gt;  [56] 4.415463e-01 4.955063e-01 1.745328e-01 6.615399e-01 4.479199e-01</span></span>
<span id="cb36-70"><a href="#cb36-70"></a><span class="co">#&gt;  [61] 2.885849e-01 3.028567e-02 1.018907e-01 1.811861e-02 6.376441e-01</span></span>
<span id="cb36-71"><a href="#cb36-71"></a><span class="co">#&gt;  [66] 1.408742e-02 9.008128e-02 4.515933e-01 8.703291e-01 7.250768e-01</span></span>
<span id="cb36-72"><a href="#cb36-72"></a><span class="co">#&gt;  [71] 8.183571e-01 8.465036e-01 8.786838e-01 1.651543e-01 3.951569e-01</span></span>
<span id="cb36-73"><a href="#cb36-73"></a><span class="co">#&gt;  [76] 1.754280e-01 3.649865e-01 7.224226e-02 6.565152e-01 9.946559e-01</span></span>
<span id="cb36-74"><a href="#cb36-74"></a><span class="co">#&gt;  [81] 3.715952e-01 8.424336e-02 4.549887e-01 8.530113e-01 1.970777e-01</span></span>
<span id="cb36-75"><a href="#cb36-75"></a><span class="co">#&gt;  [86] 2.298117e-01 1.148832e-01 7.769502e-01 4.934348e-01 3.526049e-01</span></span>
<span id="cb36-76"><a href="#cb36-76"></a><span class="co">#&gt;  [91] 2.036013e-01 8.838914e-01 6.474880e-02 4.089082e-01 5.780132e-01</span></span>
<span id="cb36-77"><a href="#cb36-77"></a><span class="co">#&gt;  [96] 8.011408e-01 5.956061e-01 9.266689e-01 9.923205e-02 1.763972e-01</span></span></code></pre></div>
<ul>
<li><strong>Exercise11.2.5.6</strong></li>
</ul>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1"></a><span class="co">#a variant of lapply() </span></span>
<span id="cb37-2"><a href="#cb37-2"></a>vari.lapply&lt;-<span class="cf">function</span> (f,n,data_type, ...)</span>
<span id="cb37-3"><a href="#cb37-3"></a>{</span>
<span id="cb37-4"><a href="#cb37-4"></a><span class="co">#to match as function</span></span>
<span id="cb37-5"><a href="#cb37-5"></a>f&lt;-<span class="kw">match.fun</span>(<span class="dt">FUN =</span> f, <span class="dt">descend =</span> <span class="ot">TRUE</span>)</span>
<span id="cb37-6"><a href="#cb37-6"></a>f1 &lt;-<span class="st"> </span><span class="kw">Map</span>(f, ...)</span>
<span id="cb37-7"><a href="#cb37-7"></a><span class="co">#logical &lt; integer &lt; double &lt; complex &lt; character </span></span>
<span id="cb37-8"><a href="#cb37-8"></a><span class="cf">if</span>(data_type <span class="op">==</span><span class="st"> &quot;character&quot;</span>)     res &lt;-<span class="st"> </span><span class="kw">vapply</span>(f1,cbind,<span class="dt">FUN.VALUE =</span> <span class="kw">character</span>(n))</span>
<span id="cb37-9"><a href="#cb37-9"></a><span class="cf">else</span> <span class="cf">if</span>(data_type <span class="op">==</span><span class="st"> &quot;complex&quot;</span>)  res &lt;-<span class="st"> </span><span class="kw">vapply</span>(f1,cbind,<span class="dt">FUN.VALUE =</span> <span class="kw">complex</span>(n))</span>
<span id="cb37-10"><a href="#cb37-10"></a><span class="cf">else</span> <span class="cf">if</span>(data_type <span class="op">==</span><span class="st"> &quot;numeric&quot;</span>)  res &lt;-<span class="st"> </span><span class="kw">vapply</span>(f1,cbind,<span class="dt">FUN.VALUE =</span> <span class="kw">numeric</span>(n))</span>
<span id="cb37-11"><a href="#cb37-11"></a><span class="cf">else</span> <span class="cf">if</span>(data_type <span class="op">==</span><span class="st"> &quot;logical&quot;</span>)  res &lt;-<span class="st"> </span><span class="kw">vapply</span>(f1,cbind,<span class="dt">FUN.VALUE =</span> <span class="kw">logical</span>(n))</span>
<span id="cb37-12"><a href="#cb37-12"></a><span class="kw">return</span>(res)</span>
<span id="cb37-13"><a href="#cb37-13"></a>}</span>
<span id="cb37-14"><a href="#cb37-14"></a><span class="co">#Example(self-defining)</span></span>
<span id="cb37-15"><a href="#cb37-15"></a><span class="co">#matrix</span></span>
<span id="cb37-16"><a href="#cb37-16"></a><span class="kw">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb37-17"><a href="#cb37-17"></a>f.xy &lt;-<span class="st"> </span><span class="cf">function</span>(x,y) {x<span class="op">&gt;</span>y}</span>
<span id="cb37-18"><a href="#cb37-18"></a>x1&lt;-<span class="kw">list</span>(<span class="kw">runif</span>(<span class="dv">5</span>,<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>), <span class="kw">runif</span>(<span class="dv">5</span>,<span class="op">-</span><span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb37-19"><a href="#cb37-19"></a>x2&lt;-<span class="kw">list</span>(<span class="kw">rnorm</span>(<span class="dv">5</span>), <span class="kw">rnorm</span>(<span class="dv">5</span>,<span class="dv">0</span>,<span class="fl">1.5</span>))</span>
<span id="cb37-20"><a href="#cb37-20"></a>matrix1 &lt;-<span class="kw">vari.lapply</span>(f.xy,<span class="dt">n=</span><span class="dv">5</span>,<span class="dt">data_type=</span><span class="st">&quot;logical&quot;</span>,x1,x2)</span>
<span id="cb37-21"><a href="#cb37-21"></a><span class="kw">print</span>(matrix1)</span>
<span id="cb37-22"><a href="#cb37-22"></a><span class="co">#&gt;       [,1]  [,2]</span></span>
<span id="cb37-23"><a href="#cb37-23"></a><span class="co">#&gt; [1,] FALSE FALSE</span></span>
<span id="cb37-24"><a href="#cb37-24"></a><span class="co">#&gt; [2,]  TRUE FALSE</span></span>
<span id="cb37-25"><a href="#cb37-25"></a><span class="co">#&gt; [3,]  TRUE  TRUE</span></span>
<span id="cb37-26"><a href="#cb37-26"></a><span class="co">#&gt; [4,]  TRUE  TRUE</span></span>
<span id="cb37-27"><a href="#cb37-27"></a><span class="co">#&gt; [5,]  TRUE  TRUE</span></span>
<span id="cb37-28"><a href="#cb37-28"></a><span class="co">#vector</span></span>
<span id="cb37-29"><a href="#cb37-29"></a><span class="kw">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb37-30"><a href="#cb37-30"></a>y &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="kw">rnorm</span>(<span class="dv">5</span>), <span class="kw">rnorm</span>(<span class="dv">10</span>))</span>
<span id="cb37-31"><a href="#cb37-31"></a>vector1 &lt;-<span class="st"> </span><span class="kw">vari.lapply</span>(mean,<span class="dt">n=</span><span class="dv">1</span>,<span class="dt">data_type=</span><span class="st">&quot;numeric&quot;</span>,y)</span>
<span id="cb37-32"><a href="#cb37-32"></a><span class="kw">print</span>(vector1)</span>
<span id="cb37-33"><a href="#cb37-33"></a><span class="co">#&gt; [1] 0.1935703 0.1317914</span></span></code></pre></div>
</div>
</div>
<div id="hw10" class="section level2">
<h2>HW10</h2>
<div id="question10" class="section level3">
<h3>Question10：</h3>
<ul>
<li><p><strong>Exercise 9.4</strong></p>
<p>Implement a random walk Metropolis sampler for generating the standard Laplace distribution (see Exercise 3.2). For the increment, simulate from a normal distribution. Compare the chains generated when different variances are used for the proposal distribution. Also, compute the acceptance rates of each chain.</p></li>
<li><p>Write an Rcpp function for Exercise 9.4 (page 277, Statistical Computing with R).</p></li>
<li><p>Compare the corresponding generated random numbers with those by the R function you wrote before using the function “qqplot”.</p></li>
<li><p>Campare the computation time of the two functions with the function “microbenchmark”.</p></li>
<li><p>Comments your results.</p></li>
</ul>
</div>
<div id="answer10" class="section level3">
<h3>Answer10：</h3>
<ul>
<li><strong>Exercise 9.4</strong></li>
</ul>
<p>The standard Laplace distribution has density <span class="math display">\[f(x) = \frac{1}{2} e^{−|x|}, x ∈ R\]</span></p>
<p><strong>1.R function for random walk Metropolis sampler</strong></p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1"></a><span class="co">#the standard Laplace distribution*2 </span></span>
<span id="cb38-2"><a href="#cb38-2"></a>pdf.Laplace_R &lt;-<span class="st"> </span><span class="cf">function</span>(x){</span>
<span id="cb38-3"><a href="#cb38-3"></a>  <span class="kw">return</span>(<span class="kw">exp</span>(<span class="op">-</span><span class="dv">1</span><span class="op">*</span><span class="kw">abs</span>(x)))</span>
<span id="cb38-4"><a href="#cb38-4"></a>}</span>
<span id="cb38-5"><a href="#cb38-5"></a><span class="co">#</span></span>
<span id="cb38-6"><a href="#cb38-6"></a>rw.Metro_R &lt;-<span class="cf">function</span>(sigma,N,x_initial){</span>
<span id="cb38-7"><a href="#cb38-7"></a> u &lt;-<span class="st"> </span><span class="kw">runif</span>(N)</span>
<span id="cb38-8"><a href="#cb38-8"></a> x &lt;-<span class="st"> </span><span class="kw">numeric</span>(N) </span>
<span id="cb38-9"><a href="#cb38-9"></a> x[<span class="dv">1</span>] &lt;-<span class="st"> </span>x_initial</span>
<span id="cb38-10"><a href="#cb38-10"></a> k &lt;-<span class="st"> </span><span class="dv">0</span></span>
<span id="cb38-11"><a href="#cb38-11"></a> <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>N){</span>
<span id="cb38-12"><a href="#cb38-12"></a>    y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">1</span>,x[i<span class="dv">-1</span>],sigma) </span>
<span id="cb38-13"><a href="#cb38-13"></a>    <span class="cf">if</span>(u[i] <span class="op">&lt;=</span><span class="st"> </span>(<span class="kw">pdf.Laplace_R</span>(y)<span class="op">/</span><span class="kw">pdf.Laplace_R</span>(x[i<span class="dv">-1</span>]))){</span>
<span id="cb38-14"><a href="#cb38-14"></a>     x[i] &lt;-<span class="st"> </span>y</span>
<span id="cb38-15"><a href="#cb38-15"></a>    }</span>
<span id="cb38-16"><a href="#cb38-16"></a>    <span class="cf">else</span>{</span>
<span id="cb38-17"><a href="#cb38-17"></a>     x[i] &lt;-<span class="st"> </span>x[i<span class="dv">-1</span>]</span>
<span id="cb38-18"><a href="#cb38-18"></a>     k &lt;-<span class="st"> </span>k<span class="op">+</span><span class="dv">1</span></span>
<span id="cb38-19"><a href="#cb38-19"></a> }</span>
<span id="cb38-20"><a href="#cb38-20"></a> <span class="kw">return</span> (<span class="kw">list</span>(<span class="dt">x=</span>x,k))</span>
<span id="cb38-21"><a href="#cb38-21"></a>}</span></code></pre></div>
<p><strong>2.Rcpp function for random walk Metropolis sampler</strong></p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1"></a><span class="co">#include &lt;Rcpp.h&gt;</span></span>
<span id="cb39-2"><a href="#cb39-2"></a>using namespace Rcpp;</span>
<span id="cb39-3"><a href="#cb39-3"></a><span class="op">/</span><span class="er">/</span><span class="st"> </span>[[Rcpp<span class="op">::</span>export]]</span>
<span id="cb39-4"><a href="#cb39-4"></a>double <span class="kw">pdfLaplaceC</span>(double x) </span>
<span id="cb39-5"><a href="#cb39-5"></a>{</span>
<span id="cb39-6"><a href="#cb39-6"></a>  return <span class="kw">exp</span>(<span class="op">-</span><span class="dv">1</span><span class="op">*</span><span class="kw">abs</span>(x));</span>
<span id="cb39-7"><a href="#cb39-7"></a> }</span>
<span id="cb39-8"><a href="#cb39-8"></a><span class="op">/</span><span class="er">/</span><span class="st"> </span>[[Rcpp<span class="op">::</span>export]]</span>
<span id="cb39-9"><a href="#cb39-9"></a>List <span class="kw">rwMetroC</span>(double sigma, int N, double xinitial){</span>
<span id="cb39-10"><a href="#cb39-10"></a>  NumericVector u =<span class="st"> </span><span class="kw">runif</span>(N);</span>
<span id="cb39-11"><a href="#cb39-11"></a>  NumericVector <span class="kw">x</span>(N); </span>
<span id="cb39-12"><a href="#cb39-12"></a>  x[<span class="dv">0</span>] =<span class="st"> </span>xinitial;</span>
<span id="cb39-13"><a href="#cb39-13"></a>  int k =<span class="st"> </span><span class="dv">0</span>;</span>
<span id="cb39-14"><a href="#cb39-14"></a>  NumericVector y;</span>
<span id="cb39-15"><a href="#cb39-15"></a>  <span class="cf">for</span>(int <span class="dt">i =</span> <span class="dv">1</span>;i <span class="op">&lt;=</span><span class="st"> </span>(N<span class="dv">-1</span>);i<span class="op">++</span>){</span>
<span id="cb39-16"><a href="#cb39-16"></a>    y =<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">1</span>, x[i<span class="dv">-1</span>], sigma);</span>
<span id="cb39-17"><a href="#cb39-17"></a>    <span class="cf">if</span> (u[i] <span class="op">&lt;=</span><span class="st"> </span>(<span class="kw">pdfLaplaceC</span>(y[<span class="dv">0</span>])<span class="op">/</span><span class="kw">pdfLaplaceC</span>(x[i<span class="dv">-1</span>]))) {</span>
<span id="cb39-18"><a href="#cb39-18"></a>      x[i] =<span class="st"> </span>y[<span class="dv">0</span>];</span>
<span id="cb39-19"><a href="#cb39-19"></a>    }</span>
<span id="cb39-20"><a href="#cb39-20"></a>    <span class="cf">else</span> { </span>
<span id="cb39-21"><a href="#cb39-21"></a>      x[i] =<span class="st"> </span>x[i<span class="dv">-1</span>];</span>
<span id="cb39-22"><a href="#cb39-22"></a>      k<span class="op">++</span>;</span>
<span id="cb39-23"><a href="#cb39-23"></a>    }</span>
<span id="cb39-24"><a href="#cb39-24"></a>  }</span>
<span id="cb39-25"><a href="#cb39-25"></a>  List res =<span class="st"> </span>List<span class="op">::</span><span class="kw">create</span>(x,k);</span>
<span id="cb39-26"><a href="#cb39-26"></a>  <span class="kw">return</span> (res);</span>
<span id="cb39-27"><a href="#cb39-27"></a>} </span></code></pre></div>
<p><strong>Campare the computation time</strong></p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1"></a><span class="co">#the standard Laplace distribution*2 </span></span>
<span id="cb40-2"><a href="#cb40-2"></a>pdf.Laplace_R &lt;-<span class="st"> </span><span class="cf">function</span>(x){</span>
<span id="cb40-3"><a href="#cb40-3"></a>  <span class="kw">return</span>(<span class="kw">exp</span>(<span class="op">-</span><span class="dv">1</span><span class="op">*</span><span class="kw">abs</span>(x)))</span>
<span id="cb40-4"><a href="#cb40-4"></a>}</span>
<span id="cb40-5"><a href="#cb40-5"></a><span class="co">#</span></span>
<span id="cb40-6"><a href="#cb40-6"></a>rw.Metro_R &lt;-<span class="cf">function</span>(sigma,N,x_initial){</span>
<span id="cb40-7"><a href="#cb40-7"></a> u &lt;-<span class="st"> </span><span class="kw">runif</span>(N)</span>
<span id="cb40-8"><a href="#cb40-8"></a> x &lt;-<span class="st"> </span><span class="kw">numeric</span>(N) </span>
<span id="cb40-9"><a href="#cb40-9"></a> x[<span class="dv">1</span>] &lt;-<span class="st"> </span>x_initial</span>
<span id="cb40-10"><a href="#cb40-10"></a> k &lt;-<span class="st"> </span><span class="dv">0</span></span>
<span id="cb40-11"><a href="#cb40-11"></a> <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>N){</span>
<span id="cb40-12"><a href="#cb40-12"></a>    y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">1</span>,x[i<span class="dv">-1</span>],sigma) </span>
<span id="cb40-13"><a href="#cb40-13"></a>    <span class="cf">if</span>(u[i] <span class="op">&lt;=</span><span class="st"> </span>(<span class="kw">pdf.Laplace_R</span>(y)<span class="op">/</span><span class="kw">pdf.Laplace_R</span>(x[i<span class="dv">-1</span>]))){</span>
<span id="cb40-14"><a href="#cb40-14"></a>     x[i] &lt;-<span class="st"> </span>y</span>
<span id="cb40-15"><a href="#cb40-15"></a>    }</span>
<span id="cb40-16"><a href="#cb40-16"></a>    <span class="cf">else</span>{</span>
<span id="cb40-17"><a href="#cb40-17"></a>      x[i] &lt;-<span class="st"> </span>x[i<span class="dv">-1</span>]</span>
<span id="cb40-18"><a href="#cb40-18"></a>      k &lt;-<span class="st"> </span>k<span class="op">+</span><span class="dv">1</span></span>
<span id="cb40-19"><a href="#cb40-19"></a>    }</span>
<span id="cb40-20"><a href="#cb40-20"></a> }</span>
<span id="cb40-21"><a href="#cb40-21"></a> <span class="kw">return</span> (<span class="kw">list</span>(<span class="dt">x=</span>x,k))</span>
<span id="cb40-22"><a href="#cb40-22"></a>}</span>
<span id="cb40-23"><a href="#cb40-23"></a><span class="kw">library</span>(Rcpp)</span>
<span id="cb40-24"><a href="#cb40-24"></a><span class="kw">library</span>(microbenchmark)</span>
<span id="cb40-25"><a href="#cb40-25"></a><span class="kw">sourceCpp</span>(</span>
<span id="cb40-26"><a href="#cb40-26"></a>  <span class="dt">code=</span><span class="st">&#39;</span></span>
<span id="cb40-27"><a href="#cb40-27"></a><span class="st">  #include&lt;Rcpp.h&gt;</span></span>
<span id="cb40-28"><a href="#cb40-28"></a><span class="st">  using namespace Rcpp;</span></span>
<span id="cb40-29"><a href="#cb40-29"></a><span class="st">  // [[Rcpp::export]]</span></span>
<span id="cb40-30"><a href="#cb40-30"></a><span class="st">  double pdfLaplaceC(double x) </span></span>
<span id="cb40-31"><a href="#cb40-31"></a><span class="st">  {</span></span>
<span id="cb40-32"><a href="#cb40-32"></a><span class="st">    return exp(-1*abs(x));</span></span>
<span id="cb40-33"><a href="#cb40-33"></a><span class="st">  }</span></span>
<span id="cb40-34"><a href="#cb40-34"></a><span class="st">  // [[Rcpp::export]]</span></span>
<span id="cb40-35"><a href="#cb40-35"></a><span class="st">  List rwMetroC(double sigma, int N, double xinitial){</span></span>
<span id="cb40-36"><a href="#cb40-36"></a><span class="st">    NumericVector u = runif(N);</span></span>
<span id="cb40-37"><a href="#cb40-37"></a><span class="st">    NumericVector x(N); </span></span>
<span id="cb40-38"><a href="#cb40-38"></a><span class="st">    x[0] = xinitial;</span></span>
<span id="cb40-39"><a href="#cb40-39"></a><span class="st">    int k = 0;</span></span>
<span id="cb40-40"><a href="#cb40-40"></a><span class="st">    NumericVector y;</span></span>
<span id="cb40-41"><a href="#cb40-41"></a><span class="st">    for(int i = 1;i &lt;= (N-1);i++){</span></span>
<span id="cb40-42"><a href="#cb40-42"></a><span class="st">      y = rnorm(1, x[i-1], sigma);</span></span>
<span id="cb40-43"><a href="#cb40-43"></a><span class="st">      if (u[i] &lt;= (pdfLaplaceC(y[0])/pdfLaplaceC(x[i-1]))) {</span></span>
<span id="cb40-44"><a href="#cb40-44"></a><span class="st">        x[i] = y[0];</span></span>
<span id="cb40-45"><a href="#cb40-45"></a><span class="st">      }</span></span>
<span id="cb40-46"><a href="#cb40-46"></a><span class="st">      else {</span></span>
<span id="cb40-47"><a href="#cb40-47"></a><span class="st">        x[i] = x[i-1];</span></span>
<span id="cb40-48"><a href="#cb40-48"></a><span class="st">        k++;</span></span>
<span id="cb40-49"><a href="#cb40-49"></a><span class="st">    }</span></span>
<span id="cb40-50"><a href="#cb40-50"></a><span class="st">    }</span></span>
<span id="cb40-51"><a href="#cb40-51"></a><span class="st">    List res = List::create(x,k);</span></span>
<span id="cb40-52"><a href="#cb40-52"></a><span class="st">    return (res);</span></span>
<span id="cb40-53"><a href="#cb40-53"></a><span class="st">  } </span></span>
<span id="cb40-54"><a href="#cb40-54"></a><span class="st">  &#39;</span></span>
<span id="cb40-55"><a href="#cb40-55"></a>)</span>
<span id="cb40-56"><a href="#cb40-56"></a><span class="co"># Campare the computation time when sigma = 2</span></span>
<span id="cb40-57"><a href="#cb40-57"></a>runtime&lt;-<span class="kw">microbenchmark</span>(<span class="dt">list_R=</span><span class="kw">rw.Metro_R</span>(<span class="dv">2</span>,<span class="dv">200</span>,<span class="dv">25</span>),<span class="dt">list_C=</span><span class="kw">rwMetroC</span>(<span class="dv">2</span>,<span class="dv">200</span>,<span class="dv">25</span>))</span>
<span id="cb40-58"><a href="#cb40-58"></a><span class="kw">summary</span>(runtime)</span>
<span id="cb40-59"><a href="#cb40-59"></a><span class="co">#&gt;     expr   min     lq    mean median     uq     max neval</span></span>
<span id="cb40-60"><a href="#cb40-60"></a><span class="co">#&gt; 1 list_R 654.3 671.55 995.383 691.15 773.45 17929.4   100</span></span>
<span id="cb40-61"><a href="#cb40-61"></a><span class="co">#&gt; 2 list_C  38.1  41.65  59.516  44.25  46.70  1251.8   100</span></span></code></pre></div>
<p>RCpp function runs faster than R function.</p>
<p><strong>QQplot</strong></p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1"></a><span class="kw">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb41-2"><a href="#cb41-2"></a>n &lt;-<span class="st"> </span><span class="dv">4</span></span>
<span id="cb41-3"><a href="#cb41-3"></a>sigma&lt;-<span class="kw">c</span>(<span class="fl">0.05</span>,<span class="fl">0.5</span>,<span class="dv">2</span>,<span class="dv">16</span>)</span>
<span id="cb41-4"><a href="#cb41-4"></a>N &lt;-<span class="st"> </span><span class="dv">200</span></span>
<span id="cb41-5"><a href="#cb41-5"></a>x0 &lt;-<span class="st"> </span><span class="dv">25</span></span>
<span id="cb41-6"><a href="#cb41-6"></a>X_R &lt;-<span class="st"> </span>X_C&lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dt">nrow =</span> N ,<span class="dt">ncol =</span> n)</span>
<span id="cb41-7"><a href="#cb41-7"></a>rej.rateR &lt;-<span class="st"> </span>rej.rateC &lt;-<span class="st"> </span><span class="kw">numeric</span>(n)</span>
<span id="cb41-8"><a href="#cb41-8"></a><span class="co">#par(mfrow=c(2,2))</span></span>
<span id="cb41-9"><a href="#cb41-9"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n){</span>
<span id="cb41-10"><a href="#cb41-10"></a>  rw_R &lt;-<span class="st"> </span><span class="kw">rw.Metro_R</span>(sigma[i],N,x0)</span>
<span id="cb41-11"><a href="#cb41-11"></a>  rw_C &lt;-<span class="st"> </span><span class="kw">rwMetroC</span>(sigma[i],N,x0)</span>
<span id="cb41-12"><a href="#cb41-12"></a>  X_R[,i]&lt;-<span class="st"> </span>rw_R[[<span class="dv">1</span>]]</span>
<span id="cb41-13"><a href="#cb41-13"></a>  X_C[,i]&lt;-<span class="st"> </span>rw_C[[<span class="dv">1</span>]]</span>
<span id="cb41-14"><a href="#cb41-14"></a>  <span class="kw">qqplot</span>(rw_R[[<span class="dv">1</span>]],rw_R[[<span class="dv">1</span>]],<span class="dt">xlab =</span> <span class="st">&quot;rw_R&quot;</span>,<span class="dt">ylab =</span> <span class="st">&quot;rw_C&quot;</span>,<span class="dt">main =</span> <span class="kw">paste</span>(<span class="st">&quot;σ=&quot;</span>,sigma[i]))</span>
<span id="cb41-15"><a href="#cb41-15"></a>  <span class="kw">abline</span>(<span class="dt">a =</span> <span class="dv">0</span>,<span class="dt">b =</span> <span class="dv">1</span>,<span class="dt">col =</span> <span class="dv">2</span>, <span class="dt">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb41-16"><a href="#cb41-16"></a>  rej.rateR[i]&lt;-rw_R[[<span class="dv">2</span>]]<span class="op">/</span>N</span>
<span id="cb41-17"><a href="#cb41-17"></a>  rej.rateC[i]&lt;-rw_C[[<span class="dv">2</span>]]<span class="op">/</span>N</span>
<span id="cb41-18"><a href="#cb41-18"></a>}</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --></p>
<p>The points in the figure are all close to the line <span class="math inline">\(y=x\)</span>.</p>
<p><strong>The results</strong></p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1"></a><span class="kw">library</span>(knitr)</span>
<span id="cb42-2"><a href="#cb42-2"></a><span class="kw">kable</span>(<span class="kw">data.frame</span>(<span class="dt">sigma =</span> sigma,<span class="dt">reject.rate_R =</span> rej.rateR,<span class="dt">reject.rate_C =</span> rej.rateC))</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">sigma</th>
<th align="right">reject.rate_R</th>
<th align="right">reject.rate_C</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0.05</td>
<td align="right">0.035</td>
<td align="right">0.010</td>
</tr>
<tr class="even">
<td align="right">0.50</td>
<td align="right">0.165</td>
<td align="right">0.145</td>
</tr>
<tr class="odd">
<td align="right">2.00</td>
<td align="right">0.420</td>
<td align="right">0.370</td>
</tr>
<tr class="even">
<td align="right">16.00</td>
<td align="right">0.865</td>
<td align="right">0.830</td>
</tr>
</tbody>
</table>
<p>Thus,the random numbers generated are generally similar but not identical.</p>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
